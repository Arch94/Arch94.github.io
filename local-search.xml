<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>vue2æ‰‹å†™å®ç°</title>
    <link href="/2023/08/30/vue2%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0/"/>
    <url>/2023/08/30/vue2%E6%89%8B%E5%86%99%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p><img src="/img/iShot2021-01-22%2016.11.32_DbQLo_urMf.png"></p><h4 id="é—®ä»€ä¹ˆæ˜¯vueï¼Ÿ"><a href="#é—®ä»€ä¹ˆæ˜¯vueï¼Ÿ" class="headerlink" title="é—®ä»€ä¹ˆæ˜¯vueï¼Ÿ"></a>é—®ä»€ä¹ˆæ˜¯vueï¼Ÿ</h4><p>vueæ˜¯ä¸€å¥—å¼€æºçš„ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼MVVMæ¡†æ¶ï¼Œé€šè¿‡compileæ¥è§£ææ¨¡ç‰ˆæŒ‡ä»¤ï¼Œé€šè¿‡ObserveråŠ«æŒç›‘å¬æ•°æ®å˜åŒ–ï¼Œé€šè¿‡depæ”¶é›†ä¾èµ–ï¼Œé€šè¿‡watcheræ›´æ–°è§†å›¾ã€‚</p><p>mvue.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">mvue</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span> = options.<span class="hljs-property">el</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$data</span> = options.<span class="hljs-property">data</span>;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">$options</span> = options;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span>)&#123;<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Observer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$data</span>);<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Compile</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$el</span>,<span class="hljs-variable language_">this</span>);<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">proxyData</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$data</span>);<br>    &#125;<br>  &#125;<br>  <span class="hljs-title function_">proxyData</span>(<span class="hljs-params">data</span>)&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> data)&#123;<br>      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(<span class="hljs-variable language_">this</span>,key,&#123;<br>        <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>          <span class="hljs-keyword">return</span> data[key];<br>        &#125;,<br>        <span class="hljs-title function_">set</span>(<span class="hljs-params">newVal</span>)&#123;<br>          data[key] = newVal;<br>        &#125;<br>      &#125;)<br>    &#125;<br>    <br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Compile</span>&#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">el,vm</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">el</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isElementNode</span>(el) ? el : <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(el)<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm;<br>    <span class="hljs-keyword">const</span> fragment = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">node2Fragment</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">el</span>);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compile</span>(fragment);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">el</span>.<span class="hljs-title function_">appendChild</span>(fragment);<br>  &#125;<br>  <span class="hljs-title function_">isElementNode</span>(<span class="hljs-params">node</span>)&#123;<br>    <span class="hljs-keyword">return</span> node.<span class="hljs-property">nodeType</span> === <span class="hljs-number">1</span>;<br>  &#125;<br>  <span class="hljs-title function_">node2Fragment</span>(<span class="hljs-params">el</span>)&#123;<br>    <span class="hljs-keyword">let</span> fragment = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createDocumentFragment</span>();<br>    <span class="hljs-keyword">let</span> firstChild;<br>    <span class="hljs-keyword">while</span>(firstChild = el.<span class="hljs-property">firstChild</span>)&#123;<br>      fragment.<span class="hljs-title function_">appendChild</span>(firstChild);<br>    &#125;<br>    <span class="hljs-keyword">return</span> fragment;<br>  &#125;<br>  <span class="hljs-title function_">compile</span>(<span class="hljs-params">fragment</span>)&#123;<br>    <span class="hljs-keyword">let</span> childNodes = fragment.<span class="hljs-property">childNodes</span>;<br>    <span class="hljs-comment">//è½¬æ•°ç»„</span><br>    [...childNodes].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">childNode</span> =&gt;</span> &#123;<br>       <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isElementNode</span>(childNode))&#123;<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compileElement</span>(childNode);<br>       &#125; <span class="hljs-keyword">else</span> &#123;<br>         <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compileText</span>(childNode);<br>       &#125;<br>       <span class="hljs-comment">//é€’å½’å­å…ƒç´ çš„å­å…ƒç´ </span><br>       <span class="hljs-keyword">if</span>(childNode.<span class="hljs-property">childNodes</span> &amp;&amp; childNode.<span class="hljs-property">childNodes</span>.<span class="hljs-property">length</span>)&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">compile</span>(childNode);<br>       &#125;<br>    &#125;)<br>  &#125;<br>  <span class="hljs-title function_">compileElement</span>(<span class="hljs-params">node</span>)&#123;<br>    <span class="hljs-keyword">const</span> attributes = node.<span class="hljs-property">attributes</span>;<br>    [...attributes].<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">attr</span>=&gt;</span>&#123;<br>      <span class="hljs-keyword">const</span> &#123;name,value&#125; = attr;<br>      <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isDirective</span>(name))&#123;<span class="hljs-comment">//æ˜¯ä¸€ä¸ªæŒ‡ä»¤ v-text v-html v-on:click </span><br>        <span class="hljs-keyword">const</span> [,directive] =  name.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;-&#x27;</span>); <br>        <span class="hljs-keyword">const</span> [dirName,eventName] = directive.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;:&#x27;</span>) <span class="hljs-comment">//v-on:click  v-bind:href</span><br>        <span class="hljs-comment">//æ›´æ–°æ•°æ®ï¼Œæ•°æ®é©±åŠ¨è§†å›¾</span><br>        compileUtil[dirName](node,value,<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>,eventName)<br>        <span class="hljs-comment">//åˆ é™¤æ ‡ç­¾ä¸ŠåŸæœ‰çš„æŒ‡ä»¤</span><br>        node.<span class="hljs-title function_">removeAttribute</span>(<span class="hljs-string">&#x27;v-&#x27;</span>+directive);<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isEventName</span>(name))&#123;<span class="hljs-comment">//@click=&quot;xxxs&quot;</span><br>        <span class="hljs-keyword">const</span> eventName = name.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;@&#x27;</span>)[<span class="hljs-number">1</span>];<br>        <span class="hljs-comment">//æ›´æ–°æ•°æ®ï¼Œæ•°æ®é©±åŠ¨è§†å›¾</span><br>        compileUtil[<span class="hljs-string">&#x27;on&#x27;</span>](node,value,<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>,eventName);<br>      &#125;<br>    &#125;)<br>  &#125;<br><br>  <span class="hljs-title function_">isEventName</span>(<span class="hljs-params">attrName</span>)&#123;<br>    <span class="hljs-keyword">return</span> attrName.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;@&#x27;</span>) == <span class="hljs-number">0</span>;<br>  &#125;<br><br>  <span class="hljs-title function_">compileText</span>(<span class="hljs-params">node</span>)&#123;<br>    <span class="hljs-keyword">const</span> content = node.<span class="hljs-property">textContent</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/</span>.<span class="hljs-title function_">test</span>(content))&#123;<br>      compileUtil[<span class="hljs-string">&#x27;text&#x27;</span>](node,content,<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>)<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-title function_">isDirective</span>(<span class="hljs-params">name</span>)&#123;<br>    <span class="hljs-keyword">return</span> name.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">&#x27;v-&#x27;</span>)?<span class="hljs-attr">true</span>:<span class="hljs-literal">false</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">const</span> compileUtil = &#123;<br>  <span class="hljs-title function_">getVal</span>(<span class="hljs-params">expr,vm</span>)&#123;<br>    <span class="hljs-keyword">return</span> expr.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">data,currentVal</span>)=&gt;</span>&#123;<br>      <span class="hljs-keyword">return</span> data[currentVal]<br>    &#125;,vm.<span class="hljs-property">$data</span>)<br>  &#125;,<br>  <span class="hljs-title function_">setVal</span>(<span class="hljs-params">expr,vm,inputVal</span>)&#123;<br>    expr.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">data,currentVal</span>)=&gt;</span>&#123;<br>      data[currentVal] = inputVal<br>    &#125;,vm.<span class="hljs-property">$data</span>)<br>  &#125;,<br>  <span class="hljs-title function_">getContentVal</span>(<span class="hljs-params">expr,vm</span>)&#123;<br>    <span class="hljs-keyword">return</span> expr.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/gi</span>,<span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getVal</span>(args[<span class="hljs-number">1</span>],vm);<br>    &#125;)<br>  &#125;,<br>  <span class="hljs-title function_">text</span>(<span class="hljs-params">node,expr,vm</span>)&#123;<br>    <span class="hljs-keyword">let</span> value;<br>    <span class="hljs-keyword">if</span>(expr.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;&#123;&#123;&#x27;</span>)!==-<span class="hljs-number">1</span>)&#123;<br>      value = expr.<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/gi</span>,<span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(vm,args[<span class="hljs-number">1</span>],<span class="hljs-function">()=&gt;</span>&#123;<br>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">textUpdater</span>(node,<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getContentVal</span>(expr,vm));<br>        &#125;)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getVal</span>(args[<span class="hljs-number">1</span>],vm);<br>      &#125;)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      value = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getVal</span>(expr,vm);<br>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(vm,expr,<span class="hljs-function"><span class="hljs-params">newVal</span>=&gt;</span>&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">textUpdater</span>(node,newVal);<br>      &#125;)<br>    &#125;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">textUpdater</span>(node,value);<br>  &#125;,<br>  <span class="hljs-title function_">html</span>(<span class="hljs-params">node,expr,vm</span>)&#123;<br>    <span class="hljs-comment">//1. getVal è§¦å‘ observeræ•°æ®ç›‘å¬å™¨çš„ getæ–¹æ³•ï¼Œæ²¡æœ‰ Dep.target</span><br>    <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getVal</span>(expr,vm);<br>    <span class="hljs-comment">// 2. åˆå§‹åŒ–è§†å›¾</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">htmlUpdater</span>(node,value);<br>    <span class="hljs-comment">//3.æ–°å»º è§‚å¯Ÿè€…ï¼Œåˆå§‹åŒ–å†…éƒ¨è°ƒç”¨compileUtil.getValè·å–æ—§å€¼ï¼Œå¹¶å°†Dep.targetè®¾ç½®ä¸ºæ­¤watcher</span><br>    <span class="hljs-comment">//4.å†æ¬¡è§¦å‘ observeræ•°æ®ç›‘å¬å™¨çš„ getæ–¹æ³•ï¼Œå°†è¯¥è§‚å¯Ÿè€…åŠ å…¥åˆ° è¿™ä¸ªexprå€¼çš„è®¢é˜…å™¨Depä¸­</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(vm,expr,<span class="hljs-function"><span class="hljs-params">newVal</span>=&gt;</span>&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">htmlUpdater</span>(node,newVal);<br>    &#125;)<br>    <span class="hljs-comment">//5.åœ¨ æ§åˆ¶å° vm.$data.msg2 = &#x27;xdddd&#x27; è§¦å‘æ•°æ®ç›‘å¬å™¨ dep.notify =&gt; dep.update =&gt; æ›´æ–°è§†å›¾</span><br>  &#125;,<br>  <span class="hljs-title function_">model</span>(<span class="hljs-params">node,expr,vm</span>)&#123;<br>    <span class="hljs-keyword">const</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getVal</span>(expr,vm);<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">modelUpdater</span>(node,value);<br>    <span class="hljs-comment">//æ•°æ®=ã€‹è§†å›¾</span><br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Watcher</span>(vm,expr,<span class="hljs-function"><span class="hljs-params">newVal</span>=&gt;</span>&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">updater</span>.<span class="hljs-title function_">modelUpdater</span>(node,newVal);<br>    &#125;)<br>    <span class="hljs-comment">//è§†å›¾=ã€‹æ•°æ®=ã€‹è§†å›¾</span><br>    node.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;input&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">e</span>)=&gt;</span>&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setVal</span>(expr,vm,e.<span class="hljs-property">target</span>.<span class="hljs-property">value</span>)<br>    &#125;)<br>  &#125;,<br>  <span class="hljs-title function_">on</span>(<span class="hljs-params">node,expr,vm,eventName</span>)&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(node,expr,vm,eventName)<br>    <span class="hljs-keyword">let</span> fn = vm.<span class="hljs-property">$options</span>.<span class="hljs-property">methods</span> &amp;&amp; vm.<span class="hljs-property">$options</span>.<span class="hljs-property">methods</span>[expr];<br>    node.<span class="hljs-title function_">addEventListener</span>(eventName,fn.<span class="hljs-title function_">bind</span>(vm),<span class="hljs-literal">false</span>);<br>  &#125;,<br>  <span class="hljs-title function_">bind</span>(<span class="hljs-params">node,expr,vm,attrName</span>)&#123;<br>    <span class="hljs-comment">//do self</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(node,expr,vm,attrName)<br>    <span class="hljs-keyword">let</span> value = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getVal</span>(expr,vm);<br>    <span class="hljs-keyword">if</span>(attrName === <span class="hljs-string">&#x27;class&#x27;</span>)&#123;<span class="hljs-comment">//å®é™…cssè®¾ç½®æ›´åŠ å¤æ‚ï¼Œexpr ä¸ä»…ä¼šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿä¼šæ˜¯[] &#123;&#125; çš„å¯¹è±¡</span><br>      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(node.<span class="hljs-property">style</span>,value)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      node.<span class="hljs-title function_">setAttribute</span>(attrName,value)<br>    &#125;<br>  &#125;,<br>  <span class="hljs-attr">updater</span>:&#123;<br>    <span class="hljs-title function_">textUpdater</span>(<span class="hljs-params">node,value</span>)&#123;<br>      node.<span class="hljs-property">textContent</span> = value;<br>    &#125;,<br>    <span class="hljs-title function_">htmlUpdater</span>(<span class="hljs-params">node,value</span>)&#123;<br>      node.<span class="hljs-property">innerHTML</span> = value;<br>    &#125;,<br>    <span class="hljs-title function_">modelUpdater</span>(<span class="hljs-params">node,value</span>)&#123;<br>      node.<span class="hljs-property">value</span> = value;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>observer.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Watcher</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">vm,expr,cb</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span> = vm;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">expr</span> = expr;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cb</span> = cb;<br>    <span class="hljs-comment">//æ—§å€¼ä¿å­˜</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">oldVal</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getOldVal</span>();<br>  &#125;<br>  <span class="hljs-title function_">getOldVal</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-comment">//æŒ‡å®štarget</span><br>    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-variable language_">this</span>;<br>    <span class="hljs-keyword">const</span> oldVal = compileUtil.<span class="hljs-title function_">getVal</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">expr</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>);<br>    <span class="hljs-comment">//æ¸…é™¤target</span><br>    <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">return</span> oldVal;<br>  &#125;<br>  <span class="hljs-title function_">update</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">const</span> newVal = compileUtil.<span class="hljs-title function_">getVal</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">expr</span>,<span class="hljs-variable language_">this</span>.<span class="hljs-property">vm</span>);<br>    <span class="hljs-keyword">if</span>(newVal !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">oldVal</span>)&#123;<br>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cb</span>(newVal);<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Dep</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span> = [];<br>  &#125;<br>  <span class="hljs-comment">//æ·»åŠ è§‚å¯Ÿè€…</span><br>  <span class="hljs-title function_">addSub</span>(<span class="hljs-params">watcher</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">push</span>(watcher);<br>  &#125;<br>  <span class="hljs-comment">//é€šçŸ¥è§‚å¯Ÿè€…å»æ›´æ–°</span><br>  <span class="hljs-title function_">notify</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subs</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">w</span>=&gt;</span>w.<span class="hljs-title function_">update</span>())<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Observer</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">data</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observe</span>(data)<br>  &#125;<br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * person:&#123;</span><br><span class="hljs-comment">      name:&#x27;111&#x27;,</span><br><span class="hljs-comment">      age:&#x27;26&#x27;</span><br><span class="hljs-comment">    &#125;,</span><br><span class="hljs-comment">    msg:&#x27;model dire&#x27;,</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-title function_">observe</span>(<span class="hljs-params">data</span>)&#123;<br>    <span class="hljs-keyword">if</span>(data &amp;&amp; <span class="hljs-keyword">typeof</span> data === <span class="hljs-string">&#x27;object&#x27;</span>)&#123;<br>      <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span>=&gt;</span>&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">defineReactive</span>(data,key,data[key])<br>      &#125;)<br>    &#125;<br>  &#125;<br>  <br>  <span class="hljs-title function_">defineReactive</span>(<span class="hljs-params">data,key,value</span>)&#123;<br>    <span class="hljs-comment">//é€’å½’éå†</span><br>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observe</span>(value);<br>    <span class="hljs-keyword">const</span> dep = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Dep</span>();<br>    <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">defineProperty</span>(data,key,&#123;<br>      <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,<br>      <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>,<br>      <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>)&#123;<br>        <span class="hljs-comment">//æ¯æ¬¡å–å€¼æ—¶è°ƒç”¨</span><br>        <span class="hljs-comment">//è®¢é˜…æ•°æ®å˜åŒ–æ—¶ï¼Œå¾€depæ·»åŠ è§‚å¯Ÿè€…</span><br>        <span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span> &amp;&amp; dep.<span class="hljs-title function_">addSub</span>(<span class="hljs-title class_">Dep</span>.<span class="hljs-property">target</span>)<br>        <span class="hljs-keyword">return</span> value<br>      &#125;,<br>      <span class="hljs-attr">set</span>:<span class="hljs-function">(<span class="hljs-params">newVal</span>)=&gt;</span>&#123;<br>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">observe</span>(newVal)<br>        <span class="hljs-keyword">if</span>(newVal !== value )&#123;<br>          value = newVal;<br>          <span class="hljs-comment">//å‘Šè¯‰ dep é€šçŸ¥å˜åŒ–</span><br>          dep.<span class="hljs-title function_">notify</span>();<br>        &#125;<br>      &#125;<br>    &#125;)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>index.html</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;Content-Type&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>write vue<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;app&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> <span class="hljs-attr">v-on:click</span>=<span class="hljs-string">&#x27;xxxs&#x27;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;button-on&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;button&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&#x27;xxxs&#x27;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;button-@&quot;</span>/&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">v-bind:href</span>=<span class="hljs-string">&quot;url&quot;</span>&gt;</span>bind url ç™¾åº¦<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">v-bind:class</span>=<span class="hljs-string">&quot;bindClass&quot;</span>&gt;</span>bind class red<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-html</span>=<span class="hljs-string">&#x27;msg&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">&#x27;person.name&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&#x27;msg&#x27;</span>/&gt;</span><br>    &#123;&#123;person.name&#125;&#125;-&#123;&#123;person.age&#125;&#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./mvue.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./observer.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">let</span> vm = <span class="hljs-keyword">new</span> <span class="hljs-title function_">mvue</span>(&#123;</span><br><span class="language-javascript">      <span class="hljs-attr">el</span>:<span class="hljs-string">&#x27;#app&#x27;</span>,</span><br><span class="language-javascript">      <span class="hljs-attr">data</span>:&#123;</span><br><span class="language-javascript">        <span class="hljs-attr">person</span>:&#123;</span><br><span class="language-javascript">          <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;111&#x27;</span>,</span><br><span class="language-javascript">          <span class="hljs-attr">age</span>:<span class="hljs-string">&#x27;26&#x27;</span></span><br><span class="language-javascript">        &#125;,</span><br><span class="language-javascript">        <span class="hljs-attr">msg</span>:<span class="hljs-string">&#x27;model dire&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">msg2</span>:<span class="hljs-string">&#x27;&lt;a href=&quot;javascript:void(0);&quot;&gt;htmlæŒ‡ä»¤&lt;/a&gt;&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">msg3</span>:<span class="hljs-string">&#x27;sba&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">url</span>:<span class="hljs-string">&#x27;http://www.baidu.com&#x27;</span>,</span><br><span class="language-javascript">        <span class="hljs-attr">bindClass</span>:&#123;</span><br><span class="language-javascript">          <span class="hljs-attr">color</span>:<span class="hljs-string">&#x27;red&#x27;</span>,</span><br><span class="language-javascript">          <span class="hljs-attr">display</span>:<span class="hljs-string">&#x27;block&#x27;</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">      &#125;,</span><br><span class="language-javascript">      <span class="hljs-attr">methods</span>: &#123;</span><br><span class="language-javascript">        <span class="hljs-title function_">xxxs</span>(<span class="hljs-params"></span>)&#123;</span><br><span class="language-javascript">          <span class="hljs-variable language_">this</span>.<span class="hljs-property">person</span>.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;222&#x27;</span></span><br><span class="language-javascript">          <span class="hljs-variable language_">this</span>.<span class="hljs-property">msg2</span> = <span class="hljs-string">&#x27;&lt;a href=&quot;javascript:void(0);&quot;&gt;htmlæŒ‡ä»¤2&lt;/a&gt;&#x27;</span></span><br><span class="language-javascript">          <span class="hljs-variable language_">this</span>.<span class="hljs-property">msg</span> = <span class="hljs-string">&#x27;model dire222&#x27;</span></span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">      &#125;</span><br><span class="language-javascript">    &#125;)</span><br><span class="language-javascript">  </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>vue</category>
      
    </categories>
    
    
    <tags>
      
      <tag>vue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TaroæŠ€æœ¯åˆ†æ</title>
    <link href="/2023/08/29/Taro/"/>
    <url>/2023/08/29/Taro/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#Taro-%E6%98%AF%E4%BB%80%E4%B9%88">Taro æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href="#Taro2">Taro2</a><ul><li><a href="#Taro2%E7%BC%96%E8%AF%91%E9%97%AE%E9%A2%98">Taro2ç¼–è¯‘é—®é¢˜</a></li><li><a href="#Taro2%E7%9A%84%E6%9E%B6%E6%9E%84%E7%89%B9%E7%82%B9">Taro2çš„æ¶æ„ç‰¹ç‚¹</a></li><li><a href="#Taro2%E7%9A%84%E6%9E%B6%E6%9E%84%E9%97%AE%E9%A2%98">Taro2çš„æ¶æ„é—®é¢˜</a></li></ul></li><li><a href="#Taro3">Taro3</a><ul><li><a href="#Taro3%E7%9A%84taro-runtime%E8%87%AA%E8%A1%8C%E5%AE%9E%E7%8E%B0%E4%BA%86%E4%B8%80%E5%A5%97-DOMBOM%E7%9A%84api">Taro3çš„taro-runtimeï¼Œè‡ªè¡Œå®ç°äº†ä¸€å¥— DOM&#x2F;BOMçš„api</a></li><li><a href="#Taro3%E7%9A%84react%E9%80%82%E9%85%8D">Taro3çš„reacté€‚é…</a></li><li><a href="#Taro%E7%9A%84react%E9%80%82%E9%85%8D%E5%85%B7%E4%BD%93%E5%AE%9E%E7%8E%B0">Taroçš„reacté€‚é…å…·ä½“å®ç°</a></li><li><a href="#%E5%A6%82%E4%BD%95%E5%B0%86Taro%E7%9A%84DOM-tree%E6%B8%B2%E6%9F%93%E5%88%B0%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%A7%86%E5%9B%BE%E5%B1%82">å¦‚ä½•å°†Taroçš„DOM treeæ¸²æŸ“åˆ°å°ç¨‹åºçš„è§†å›¾å±‚ï¼Ÿ</a></li><li><a href="#Taro3-%E5%B0%8F%E7%A8%8B%E5%BA%8FVue-%E5%AE%9E%E7%8E%B0">Taro3 å°ç¨‹åºVue å®ç°</a></li><li><a href="#Taro3-%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6">Taro3 äº‹ä»¶æœºåˆ¶</a></li><li><a href="#Taro3%E7%9A%84%E6%9E%B6%E6%9E%84%E7%89%B9%E7%82%B9">Taro3çš„æ¶æ„ç‰¹ç‚¹</a></li><li><a href="#Taro3%E7%9A%84%E6%9E%B6%E6%9E%84%E4%BC%98%E7%BC%BA%E7%82%B9%E8%87%AA%E6%88%91%E5%88%86%E6%9E%90">Taro3çš„æ¶æ„ä¼˜ç¼ºç‚¹è‡ªæˆ‘åˆ†æ</a></li><li><a href="#Taro3%E7%9A%84%E8%BF%90%E8%A1%8C%E6%97%B6%E4%BC%98%E5%8C%96">Taro3çš„è¿è¡Œæ—¶ä¼˜åŒ–</a><ul><li><a href="#%E7%B2%BE%E7%AE%80%E7%9A%84-DOMBOM-API">ç²¾ç®€çš„ DOM&#x2F;BOM API</a></li><li><a href="#Taro3%E6%9B%B4%E6%96%B0%E4%BC%98%E5%8C%96">Taro3æ›´æ–°ä¼˜åŒ–</a></li><li><a href="#%E5%8C%85%E4%BD%93%E7%A7%AF%E4%BC%98%E5%8C%96">åŒ…ä½“ç§¯ä¼˜åŒ–</a></li></ul></li></ul></li></ul><h3 id="Taro-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Taro-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Taro æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Taro æ˜¯ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>ğŸ“Œå¤šç«¯ç»Ÿä¸€å¼€å‘è§£å†³æ–¹æ¡ˆ</p></blockquote><blockquote><p>ä½¿ç”¨Taroï¼Œåªä¹¦å†™ä¸€å¥—ä»£ç ï¼Œå†é€šè¿‡Taroçš„ç¼–è¯‘å·¥å…·ï¼Œå°†æºä»£ç åˆ†åˆ«ç¼–è¯‘å‡ºå¯ä»¥åœ¨ä¸åŒç«¯ï¼ˆå¾®ä¿¡å°ç¨‹åºã€H5ã€RNç­‰ï¼‰è¿è¡Œçš„ä»£ç ã€‚</p></blockquote><h3 id="Taro2"><a href="#Taro2" class="headerlink" title="Taro2"></a>Taro2</h3><blockquote><p>ğŸ“ŒTaro2 æ˜¯ä¸€ä¸ªé‡ç¼–è¯‘æ—¶è½»è¿è¡Œæ—¶çš„æ¡†æ¶</p></blockquote><p>Taro2 æ¶æ„ä¸»è¦åˆ†ä¸ºï¼š<strong>ç¼–è¯‘æ—¶</strong> å’Œ <strong>è¿è¡Œæ—¶</strong>ã€‚å…¶ä¸­ç¼–è¯‘æ—¶ä¸»è¦æ˜¯å°† Taro ä»£ç é€šè¿‡ <a href="https://babeljs.io/" title="Babel">Babel</a> è½¬æ¢æˆ å°ç¨‹åºçš„ä»£ç ï¼Œå¦‚ï¼š<code>JS</code>ã€<code>WXML</code>ã€<code>WXSS</code>ã€<code>JSON</code>ã€‚è¿è¡Œæ—¶ä¸»è¦æ˜¯è¿›è¡Œä¸€äº›ï¼šç”Ÿå‘½å‘¨æœŸã€äº‹ä»¶ã€data ç­‰éƒ¨åˆ†çš„å¤„ç†å’Œå¯¹æ¥ï¼ˆè¿è¡Œæ—¶å’ŒReactæ²¡æœ‰å…³ç³»çš„ï¼‰</p><p><img src="/img/image_LbpYX-WYMf.png"></p><h4 id="Taro2ç¼–è¯‘é—®é¢˜"><a href="#Taro2ç¼–è¯‘é—®é¢˜" class="headerlink" title="Taro2ç¼–è¯‘é—®é¢˜"></a>Taro2ç¼–è¯‘é—®é¢˜</h4><p><img src="/img/image_ecTM4qsics.png"></p><p>é™æ€templateè½¬åŠ¨æ€JSXç›¸å¯¹ç®€å•ï¼Œä½†æ˜¯åè¿‡æ¥å´ç›¸å½“å›°éš¾ï¼Œè¿™æ˜¯å› ä¸ºJSXè¿‡äºçµæ´»ï¼ŒTaro2é‡‡ç”¨ç©·ä¸¾çš„æ–¹å¼å¯¹JSXå†™æ³•è¿›è¡Œä¸€ä¸€é€‚é…ï¼Œå·¥ä½œé‡å¤§ã€‚</p><h4 id="Taro2çš„æ¶æ„ç‰¹ç‚¹"><a href="#Taro2çš„æ¶æ„ç‰¹ç‚¹" class="headerlink" title="Taro2çš„æ¶æ„ç‰¹ç‚¹"></a>Taro2çš„æ¶æ„ç‰¹ç‚¹</h4><ul><li><strong>é‡ç¼–è¯‘æ—¶ï¼Œè½»è¿è¡Œæ—¶</strong>ï¼šè¿™ä»ä¸¤è¾¹ä»£ç è¡Œæ•°çš„å¯¹æ¯”å°±å¯è§ä¸€æ–‘ã€‚</li><li>ç¼–è¯‘åä»£ç ä¸ React æ— å…³ï¼šTaro åªæ˜¯åœ¨å¼€å‘æ—¶éµå¾ªäº† React çš„è¯­æ³•ï¼Œä½†ä¸React DSL å¼ºç»‘å®š</li><li>ç›´æ¥ä½¿ç”¨ Babel è¿›è¡Œç¼–è¯‘ï¼šè¿™ä¹Ÿå¯¼è‡´å½“å‰ Taro åœ¨å·¥ç¨‹åŒ–å’Œæ’ä»¶æ–¹é¢çš„ç¾¸å¼±ã€‚</li></ul><h4 id="Taro2çš„æ¶æ„é—®é¢˜"><a href="#Taro2çš„æ¶æ„é—®é¢˜" class="headerlink" title="Taro2çš„æ¶æ„é—®é¢˜"></a>Taro2çš„æ¶æ„é—®é¢˜</h4><ul><li>React DSL å¼ºç»‘å®š</li><li>Reactæ–°ç‰¹æ€§éœ€è¦æ‰‹åŠ¨å¯¹æ¥</li><li>JSXé€‚é…å·¥ä½œé‡å¤§ï¼Œé™åˆ¶å¤š</li><li>é”™è¯¯æ ˆå¤æ‚ï¼Œæ²¡æœ‰sourceMapï¼ˆå’ŒReactæ²¡å…³ç³»ï¼Œé”™è¯¯æ˜¯ä»å†…éƒ¨æŠ›å‡ºçš„ï¼‰</li></ul><h2 id="Taro3"><a href="#Taro3" class="headerlink" title="Taro3"></a>Taro3</h2><blockquote><p>ğŸ“ŒTaro3é‡è¿è¡Œæ—¶è·¨ç«¯æ¡†æ¶</p></blockquote><h4 id="Taro3çš„taro-runtimeï¼Œè‡ªè¡Œå®ç°äº†ä¸€å¥—-DOM-BOMçš„api"><a href="#Taro3çš„taro-runtimeï¼Œè‡ªè¡Œå®ç°äº†ä¸€å¥—-DOM-BOMçš„api" class="headerlink" title="Taro3çš„taro-runtimeï¼Œè‡ªè¡Œå®ç°äº†ä¸€å¥— DOM&#x2F;BOMçš„api"></a><strong>Taro3çš„taro-runtimeï¼Œè‡ªè¡Œå®ç°äº†ä¸€å¥— DOM&#x2F;BOMçš„api</strong></h4><p>æ— è®ºå¼€å‘è¿™æ˜¯ç”¨çš„æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼ŒReact ä¹Ÿå¥½ï¼ŒVue ä¹Ÿç½¢ï¼Œæœ€ç»ˆä»£ç ç»è¿‡è¿è¡Œä¹‹åéƒ½æ˜¯è°ƒç”¨äº†æµè§ˆå™¨çš„é‚£å‡ ä¸ª BOM&#x2F;DOM çš„ API ï¼Œå¦‚ï¼š<code>createElement</code>ã€<code>appendChild</code>ã€<code>removeChild</code> ç­‰ã€‚</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/91591/19/8966/30891/5e09f712E6e7f1df8/c3cbbead85810461.jpg"></p><p>å› æ­¤ï¼Œæˆ‘ä»¬åˆ›å»ºäº† <a href="https://github.com/NervJS/taro/tree/next/packages/taro-runtime" title="taro-runtime">taro-runtime</a> çš„åŒ…ï¼Œç„¶ååœ¨è¿™ä¸ªåŒ…ä¸­å®ç°äº† <strong>ä¸€å¥— é«˜æ•ˆã€ç²¾ç®€ç‰ˆçš„ DOM&#x2F;BOM API</strong>ï¼ˆä¸‹é¢çš„ UML å›¾åªæ˜¯åæ˜ äº†å‡ ä¸ªä¸»è¦çš„ç±»çš„ç»“æ„å’Œå…³ç³»ï¼‰ï¼š</p><p><img src="https://img12.360buyimg.com/ling/jfs/t1/107806/8/2825/294525/5e09f810E8d32975f/ec84acddae669131.png"></p><p>ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡ Webpack çš„ <a href="https://webpack.js.org/plugins/provide-plugin/" title="ProvidePlugin">ProvidePlugin</a> æ’ä»¶ï¼Œæ³¨å…¥åˆ°å°ç¨‹åºçš„é€»è¾‘å±‚ã€‚</p><h4 id="Taro3çš„reacté€‚é…"><a href="#Taro3çš„reacté€‚é…" class="headerlink" title="Taro3çš„reacté€‚é…"></a>Taro3çš„reacté€‚é…</h4><p><img src="https://img10.360buyimg.com/ling/jfs/t1/93547/36/9145/40000/5e09f948Edd646b65/ce37c0d099b7f702.jpg"></p><p>æœ€ä¸Šå±‚æ˜¯ React çš„æ ¸å¿ƒéƒ¨åˆ† <code>react-core</code> ï¼Œä¸­é—´æ˜¯ <code>react-reconciler</code>ï¼Œå…¶çš„èŒè´£æ˜¯ç»´æŠ¤ <code>VirtualDOM</code> æ ‘ï¼Œå†…éƒ¨å®ç°äº† <code>Diff/Fiber</code> ç®—æ³•ï¼Œå†³å®šä»€ä¹ˆæ—¶å€™æ›´æ–°ã€ä»¥åŠè¦æ›´æ–°ä»€ä¹ˆã€‚</p><p>è€Œ <code>Renderer</code> è´Ÿè´£å…·ä½“å¹³å°çš„æ¸²æŸ“å·¥ä½œï¼Œå®ƒä¼šæä¾›å®¿ä¸»ç»„ä»¶ã€å¤„ç†äº‹ä»¶ç­‰ç­‰ã€‚ä¾‹å¦‚ <code>React-DOM</code> å°±æ˜¯ä¸€ä¸ªæ¸²æŸ“å™¨ï¼Œè´Ÿè´£ DOM èŠ‚ç‚¹çš„æ¸²æŸ“å’Œ DOM äº‹ä»¶å¤„ç†ã€‚</p><p><strong>Taroçš„Reactçš„é€‚é…ï¼Œæœ¬è´¨ä¸Šæ˜¯å®ç°äº†ä¸€ä¸ªReactçš„è‡ªå®šä¹‰çš„Rendererï¼Œé€šè¿‡ taro-reactåŒ…æ¥è¿æ¥ react-reconciler å’Œ taro-runtime</strong></p><p><img src="https://img13.360buyimg.com/ling/jfs/t1/90851/28/9324/88846/5e0d9374Ec9b1a530/6a494163f77c6dd7.jpg"></p><h4 id="Taroçš„reacté€‚é…å…·ä½“å®ç°"><a href="#Taroçš„reacté€‚é…å…·ä½“å®ç°" class="headerlink" title="Taroçš„reacté€‚é…å…·ä½“å®ç°"></a>Taroçš„reacté€‚é…å…·ä½“å®ç°</h4><p>å…·ä½“çš„å®ç°ä¸»è¦åˆ†ä¸ºä¸¤æ­¥ï¼š</p><ol><li>å®ç° <code>react-reconciler</code> çš„ <code>hostConfig</code> é…ç½®ï¼Œå³åœ¨ <code>hostConfig</code> çš„æ–¹æ³•ä¸­è°ƒç”¨å¯¹åº”çš„ Taro BOM&#x2F;DOM çš„ APIã€‚</li><li>å®ç° render å‡½æ•°ï¼ˆç±»ä¼¼äº <code>ReactDOM.render</code>ï¼‰æ–¹æ³•ï¼Œå¯ä»¥çœ‹æˆæ˜¯åˆ›å»º <code>Taro DOM Tree</code> çš„å®¹å™¨ã€‚</li></ol><p><img src="https://img14.360buyimg.com/ling/jfs/t1/93510/31/8909/48959/5e09fa87E1d831f7e/5d6f1f945c23e529.jpg"></p><h4 id="å¦‚ä½•å°†Taroçš„DOM-treeæ¸²æŸ“åˆ°å°ç¨‹åºçš„è§†å›¾å±‚ï¼Ÿ"><a href="#å¦‚ä½•å°†Taroçš„DOM-treeæ¸²æŸ“åˆ°å°ç¨‹åºçš„è§†å›¾å±‚ï¼Ÿ" class="headerlink" title="å¦‚ä½•å°†Taroçš„DOM treeæ¸²æŸ“åˆ°å°ç¨‹åºçš„è§†å›¾å±‚ï¼Ÿ"></a>å¦‚ä½•å°†Taroçš„DOM treeæ¸²æŸ“åˆ°å°ç¨‹åºçš„è§†å›¾å±‚ï¼Ÿ</h4><blockquote><p>ğŸ“Œå°ç¨‹åºç»„ä»¶æ¨¡ç‰ˆåŒ–ï¼ŒTaro Dom Tree é€’å½’æ¸²æŸ“æ¨¡ç‰ˆ</p></blockquote><p>æˆ‘ä»¬å°†å°ç¨‹åºçš„æ‰€æœ‰ç»„ä»¶æŒ¨ä¸ªè¿›è¡Œ<strong>æ¨¡ç‰ˆåŒ–å¤„ç†</strong>ï¼Œä»è€Œå¾—åˆ°å°ç¨‹åºç»„ä»¶å¯¹åº”çš„templateæ¨¡ç‰ˆï¼Œç„¶ååŸºäºtemplateå°†Taro Dom Tree è¿›è¡Œé€’å½’æ¸²æŸ“</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/91642/11/9016/45574/5e09fc9dE03db038c/f87d7fc69e04b26e.jpg"></p><p>æ•´ä¸ª Taro Next çš„ React å®ç°æµç¨‹å›¾å¦‚ä¸‹ï¼š</p><p><img src="https://img11.360buyimg.com/ling/jfs/t1/106748/9/9067/61495/5e09fd1eE47733747/a11b3ef8b1a7f791.jpg"></p><h4 id="Taro3-å°ç¨‹åºVue-å®ç°"><a href="#Taro3-å°ç¨‹åºVue-å®ç°" class="headerlink" title="Taro3 å°ç¨‹åºVue å®ç°"></a>Taro3 å°ç¨‹åºVue å®ç°</h4><p>åˆ«çœ‹ React å’Œ Vue åœ¨å¼€å‘æ—¶åŒºåˆ«é‚£ä¹ˆå¤§ï¼Œå…¶å®åœ¨å®ç°äº† BOM&#x2F;DOM API ä¹‹åï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å°±å¾ˆå°äº†ã€‚</p><p>Vue å’Œ React æœ€å¤§çš„åŒºåˆ«å°±åœ¨äºè¿è¡Œæ—¶çš„ <code>CreateVuePage</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œè¿›è¡Œäº†ä¸€äº›è¿è¡Œæ—¶çš„å¤„ç†ï¼Œæ¯”å¦‚ï¼šç”Ÿå‘½å‘¨æœŸçš„å¯¹é½ã€‚</p><p><img src="https://img30.360buyimg.com/ling/jfs/t1/96356/5/8961/15030/5e0aae8aE452804bd/f4c7df38129d99c5.jpg"></p><p>å…¶ä»–çš„éƒ¨åˆ†ï¼Œå¦‚é€šè¿‡ BOM&#x2F;DOM æ–¹æ³•æ„å»ºã€ä¿®æ”¹ DOM Tree åŠæ¸²æŸ“åŸç†ï¼Œéƒ½æ˜¯å’Œ React ä¸€è‡´çš„ã€‚</p><h4 id="Taro3-äº‹ä»¶æœºåˆ¶"><a href="#Taro3-äº‹ä»¶æœºåˆ¶" class="headerlink" title="Taro3 äº‹ä»¶æœºåˆ¶"></a>Taro3 äº‹ä»¶æœºåˆ¶</h4><p>é¦–å…ˆçš„ Taro Next äº‹ä»¶ï¼Œå…·ä½“çš„å®ç°æ–¹å¼å¦‚ä¸‹ï¼š</p><ol><li>åœ¨ å°ç¨‹åºç»„ä»¶çš„æ¨¡ç‰ˆåŒ–è¿‡ç¨‹ä¸­ï¼Œå°†æ‰€æœ‰äº‹ä»¶æ–¹æ³•å…¨éƒ¨æŒ‡å®šä¸º è°ƒç”¨ ev å‡½æ•°ï¼Œå¦‚ï¼š<code>bindtap</code>ã€<code>bindchange</code>ã€<code>bindsubmit</code>ç­‰ã€‚</li><li>åœ¨ è¿è¡Œæ—¶å®ç° <code>eventHandler</code> å‡½æ•°ï¼Œå’Œ eh æ–¹æ³•ç»‘å®šï¼Œæ”¶é›†æ‰€æœ‰çš„å°ç¨‹åºäº‹ä»¶</li><li>é€šè¿‡ <code>document.getElementById()</code> æ–¹æ³•è·å–è§¦å‘äº‹ä»¶å¯¹åº”çš„ <code>TaroNode</code></li><li>é€šè¿‡ <code>createEvent()</code> åˆ›å»ºç¬¦åˆè§„èŒƒçš„ <code>TaroEvent</code></li><li>è°ƒç”¨ <code>TaroNode.dispatchEvent</code> é‡æ–°è§¦å‘äº‹ä»¶</li></ol><p><img src="https://img10.360buyimg.com/ling/jfs/t1/103912/33/8987/52864/5e0ab09fEcdcb31c2/d29510c9bc5dd255.jpg"></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒTaro Next äº‹ä»¶æœ¬è´¨ä¸Šæ˜¯<strong>åŸºäº Taro DOM å®ç°äº†ä¸€å¥—è‡ªå·±çš„äº‹ä»¶æœºåˆ¶</strong>ï¼Œè¿™æ ·åšçš„å¥½å¤„ä¹‹ä¸€æ˜¯ï¼Œæ— è®ºå°ç¨‹åºæ˜¯å¦æ”¯æŒäº‹ä»¶çš„å†’æ³¡ä¸æ•è·ï¼ŒTaro éƒ½èƒ½æ”¯æŒã€‚</p><h4 id="Taro3çš„æ¶æ„ç‰¹ç‚¹"><a href="#Taro3çš„æ¶æ„ç‰¹ç‚¹" class="headerlink" title="Taro3çš„æ¶æ„ç‰¹ç‚¹"></a>Taro3çš„æ¶æ„ç‰¹ç‚¹</h4><ul><li><strong>æ—  DSL é™åˆ¶</strong>ï¼šæ— è®ºæ˜¯ä½ ä»¬å›¢é˜Ÿæ˜¯ React è¿˜æ˜¯ Vue æŠ€æœ¯æ ˆï¼Œéƒ½èƒ½å¤Ÿä½¿ç”¨ Taro å¼€å‘</li><li><strong>æ¨¡ç‰ˆåŠ¨æ€æ„å»º</strong>ï¼šå’Œä¹‹å‰æ¨¡ç‰ˆé€šè¿‡ç¼–è¯‘ç”Ÿæˆçš„ä¸åŒï¼ŒTaro Next çš„æ¨¡ç‰ˆæ˜¯å›ºå®šçš„ï¼Œç„¶ååŸºäºç»„ä»¶çš„ templateï¼ŒåŠ¨æ€ â€œé€’å½’â€ æ¸²æŸ“æ•´æ£µ Taro DOM æ ‘ã€‚</li><li><strong>æ–°ç‰¹æ€§æ— ç¼æ”¯æŒ</strong>ï¼šç”±äº Taro Next æœ¬è´¨ä¸Šæ˜¯å°† React&#x2F;Vue è¿è¡Œåœ¨å°ç¨‹åºä¸Šï¼Œå› æ­¤ï¼Œå„ç§æ–°ç‰¹æ€§ä¹Ÿå°±æ— ç¼æ”¯æŒäº†ã€‚</li><li><strong>ç¤¾åŒºè´¡çŒ®æ›´ç®€å•</strong>ï¼šé”™è¯¯æ ˆå°†å’Œ React&#x2F;Vue ä¸€è‡´ï¼Œå›¢é˜Ÿåªéœ€è¦ç»´æŠ¤æ ¸å¿ƒçš„ taro-runtimeã€‚</li><li><strong>åŸºäº Webpack</strong>ï¼šTaro Next åŸºäº Webpack å®ç°äº†å¤šç«¯çš„å·¥ç¨‹åŒ–ï¼Œæä¾›äº†æ’ä»¶åŠŸèƒ½ã€‚</li></ul><h4 id="Taro3çš„æ¶æ„ä¼˜ç¼ºç‚¹è‡ªæˆ‘åˆ†æ"><a href="#Taro3çš„æ¶æ„ä¼˜ç¼ºç‚¹è‡ªæˆ‘åˆ†æ" class="headerlink" title="Taro3çš„æ¶æ„ä¼˜ç¼ºç‚¹è‡ªæˆ‘åˆ†æ"></a>Taro3çš„æ¶æ„ä¼˜ç¼ºç‚¹è‡ªæˆ‘åˆ†æ</h4><ul><li>ä¼˜ç‚¹<ul><li>æ— DSLé™åˆ¶</li><li>æ–°ç‰¹æ€§æ— ç¼æ”¯æŒï¼Œå› ä¸ºTaro3æœ¬è´¨æ˜¯å°†Vue&#x2F;Reactè¿è¡Œåœ¨å°ç¨‹åºä¸Šï¼Œå› æ­¤ï¼Œå„ç§æ–°ç‰¹æ€§ä¹Ÿå¯ä»¥æ— ç¼æ”¯æŒï¼ˆTaroåªæ˜¯å®šä¹‰äº†ä¸€å¥—DOM&#x2F;BOM apiï¼Œvue&#x2F;react æ ¸å¿ƒä»£ç ä¾ç„¶æ­£å¸¸è¿è¡Œï¼‰</li></ul></li><li>ç¼ºç‚¹<ul><li>ç”±äºtaro3çš„ç¼–è¯‘æ–¹æ¡ˆï¼ˆå¤šä¸€å±‚Taro Dom&#x2F;Bomä½œä¸­è½¬ï¼Œè€Œä¸”æœ¬è´¨æ˜¯å°†react&#x2F;vueè¿è¡Œåœ¨å°ç¨‹åºï¼‰ï¼Œæ€§èƒ½ä¸Šè‚¯å®šä¸åŠTaro2&#x2F;uniappç­‰é™æ€æ¨¡ç‰ˆç¼–è¯‘æ–¹æ¡ˆ</li><li>Taro3çš„templateé€’å½’æ¸²æŸ“æ–¹å¼å­˜åœ¨ä¸€å®šç¼ºé™·<ul><li>åˆå§‹åŒ–å…¨é‡setDataæ¨¡ç‰ˆæ¸²æŸ“ï¼Œå› æ­¤åˆå§‹åŒ–æ€§èƒ½æ¯”è¾ƒä½</li><li>è§†å›¾æ›´æ–°é€Ÿåº¦å–å†³äºæ›´æ–°å¹…åº¦ï¼Œä¸€æ—¦å‡ºç°å¤§é¢ç§¯çš„æ¸²æŸ“æ›´æ–°ï¼ŒsetDataæ•°æ®é‡ä¼šæ¯”é™æ€æ¨¡ç‰ˆæ¸²æŸ“æ–¹å¼é«˜ï¼Œæ€§èƒ½ä¹Ÿä¼šéšä¹‹é™ä½</li></ul></li></ul></li></ul><h3 id="Taro3çš„è¿è¡Œæ—¶ä¼˜åŒ–"><a href="#Taro3çš„è¿è¡Œæ—¶ä¼˜åŒ–" class="headerlink" title="Taro3çš„è¿è¡Œæ—¶ä¼˜åŒ–"></a>Taro3çš„è¿è¡Œæ—¶ä¼˜åŒ–</h3><p>å‰é¢æåˆ°ï¼ŒåŒç­‰æ¡ä»¶ä¸‹ï¼Œç¼–è¯‘æ—¶åšçš„å·¥ä½œè¶Šå¤šï¼Œä¹Ÿå°±æ„å‘³ç€è¿è¡Œæ—¶åšçš„å·¥ä½œè¶Šå°‘ï¼Œæ€§èƒ½ä¼šæ›´å¥½ã€‚</p><p><img src="https://img20.360buyimg.com/ling/jfs/t1/85061/33/9155/42050/5e0ae1afE263741c9/7a1664f1a6769d7a.jpg"></p><p>å¯ä»¥å‘ç°ï¼Œç›¸æ¯”åŸç”Ÿå°ç¨‹åºï¼ŒTaro Next å¤šäº†çº¢è‰²éƒ¨åˆ†çš„å¸¦æ¥çš„æ€§èƒ½éšæ‚£ï¼Œå¦‚ï¼šå¼•å…¥ React&#x2F;Vue å¸¦æ¥çš„ åŒ…çš„ Size å¢åŠ ï¼Œè¿è¡Œæ—¶çš„æŸè€—ã€Taro DOM Tree çš„æ„å»ºå’Œæ›´æ–°ã€DOM data åˆå§‹åŒ–å’Œæ›´æ–°ã€‚</p><p>è€Œæˆ‘ä»¬çœŸæ­£èƒ½åšçš„ï¼Œåªæœ‰ç»¿è‰²éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯ï¼š</p><ul><li><strong>Taro DOM Tree çš„æ„å»ºå’Œæ›´æ–°</strong></li><li><strong>DOM data åˆå§‹åŒ–å’Œæ›´æ–°</strong></li></ul><h4 id="ç²¾ç®€çš„-DOM-BOM-API"><a href="#ç²¾ç®€çš„-DOM-BOM-API" class="headerlink" title="ç²¾ç®€çš„ DOM&#x2F;BOM API"></a>ç²¾ç®€çš„ DOM&#x2F;BOM API</h4><p>åœ¨ Taro DOM Tree çš„æ„å»ºå’Œæ›´æ–°é˜¶æ®µï¼Œæˆ‘ä»¬å®ç°äº†ä¸€å¥—ä»…å®ç°äº†é«˜æ•ˆçš„ã€ç²¾ç®€ç‰ˆ DOM&#x2F;BOM APIï¼Œè€Œä¸”ä»…ä»…å®ç°äº†å¿…è¦çš„ã€‚</p><p>Github ä¸Šæœ‰ä¸€ä¸ªä»“åº“ <a href="https://github.com/jsdom/jsdom" title="jsdom">jsdom</a>ï¼ŒåŸºæœ¬ä¸Šæ˜¯åœ¨ Node.js ä¸Šå®ç°äº†ä¸€å¥— Web æ ‡å‡†çš„ DOM&#x2F;BOM ï¼Œè¿™ä¸ªä»“åº“çš„ä»£ç åœ¨å‹ç¼©å‰å¤§æ¦‚æœ‰ 2.1Mï¼Œè€Œ Taro Next çš„æ ¸å¿ƒçš„ DOM&#x2F;BOM API ä»£ç æ‰ 1000 è¡Œä¸åˆ°ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬æœ€å¤§é™åº¦çš„ä¿è¯äº† Taro DOM Tree æ„å»ºå’Œæ›´æ–°é˜¶æ®µçš„æ€§èƒ½ã€‚</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/93372/24/9137/11878/5e0ae512E79c720f9/ab326eef51d168a5.jpg"></p><h4 id="Taro3æ›´æ–°ä¼˜åŒ–"><a href="#Taro3æ›´æ–°ä¼˜åŒ–" class="headerlink" title="Taro3æ›´æ–°ä¼˜åŒ–"></a>Taro3æ›´æ–°ä¼˜åŒ–</h4><p>æ— è®ºæ˜¯ React è¿˜æ˜¯ Vue ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨ Taro DOM æ–¹æ³•ï¼Œå¦‚ï¼š<code>appendChild</code>ã€<code>insertChild</code> ç­‰ã€‚</p><p>è¿™äº›æ–¹æ³•åœ¨ä¿®æ”¹ Taro DOM Tree çš„åŒæ—¶ï¼Œè¿˜ä¼šè°ƒç”¨ <code>enqueueUpdate</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•èƒ½è·å–åˆ°æ¯ä¸€ä¸ª DOM æ–¹æ³•æœ€ç»ˆä¿®æ”¹çš„èŠ‚ç‚¹è·¯å¾„å’Œå€¼ï¼Œå¦‚ï¼š<code>&#123;root.cn.[0].cn.[4].value:Â &quot;1&quot;&#125;</code>ï¼Œå¹¶é€šè¿‡ <code>setData</code> æ–¹æ³•æ›´æ–°åˆ°è§†å›¾å±‚ã€‚</p><p><img src="https://img10.360buyimg.com/ling/jfs/t1/86893/14/9016/38824/5e0ac06aE21db32b1/c4bece64d139dd8e.jpg"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œ<strong>æ›´æ–°çš„ç²’åº¦æ˜¯ DOM çº§åˆ«</strong>ï¼Œåªæœ‰æœ€ç»ˆå‘ç”Ÿæ”¹å˜çš„ DOM æ‰ä¼šè¢«æ›´æ–°è¿‡å»ï¼Œç›¸å¯¹äºä¹‹å‰ data çº§åˆ«çš„æ›´æ–°ä¼šæ›´åŠ ç²¾å‡†ï¼Œæ€§èƒ½æ›´å¥½ã€‚</p><blockquote><p>dataæ›´æ–°æ˜¯ä¼šæœ‰å†—ä½™çš„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰dataæ›´æ–°ä¼šå¼•èµ·domæ›´æ–°</p></blockquote><h4 id="åŒ…ä½“ç§¯ä¼˜åŒ–"><a href="#åŒ…ä½“ç§¯ä¼˜åŒ–" class="headerlink" title="åŒ…ä½“ç§¯ä¼˜åŒ–"></a>åŒ…ä½“ç§¯ä¼˜åŒ–</h4><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹åŒ… Sizeï¼Œä¸‹é¢çš„è¡¨æ ¼æ˜¯ TodoMVC çš„ä¾‹å­ï¼Œåœ¨åŸç”Ÿã€Taro Oldã€Taro Next ç­‰æƒ…å†µä¸‹çš„åŒ…å¤§å°å¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå¼•å…¥ React&#x2F;Vue åï¼ŒåŒ…å¤§å°åœ¨ Gzip æƒ…å†µä¸‹å¤§æ¦‚å¢åŠ äº† 30k å·¦å³ã€‚</p><p><img src="https://img12.360buyimg.com/ling/jfs/t1/100878/15/9005/22516/5e0ae322E690a60fb/9b3a09bf64a51871.jpg"></p><p>ä¸è¿‡æˆ‘ä»¬åœ¨å‰é¢ä¸€å†å¼ºè°ƒï¼šå’Œä¹‹å‰æ¨¡ç‰ˆé€šè¿‡ç¼–è¯‘ç”Ÿæˆçš„ä¸åŒï¼ŒTaro Next çš„æ¨¡ç‰ˆæ˜¯å›ºå®šçš„ï¼Œç„¶ååŸºäºç»„ä»¶çš„ templateï¼ŒåŠ¨æ€ â€œé€’å½’â€ æ¸²æŸ“æ•´æ£µ Taro DOM æ ‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>Taro Next çš„ WXML å¤§å°æ˜¯æœ‰ä¸Šé™çš„</strong>ã€‚</p><p>éšç€é¡¹ç›®çš„å¢åŠ ï¼Œé¡µé¢è¶Šæ¥è¶Šå¤šï¼ŒåŸç”Ÿçš„é¡¹ç›® WXML ä½“ç§¯ä¼šä¸æ–­å¢åŠ ï¼Œè€Œ Taro Next ä¸ä¼šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“é¡µé¢çš„æ•°é‡è¶…è¿‡ä¸€ä¸ªä¸´ç•Œç‚¹æ—¶ï¼ŒTaro Next çš„åŒ…ä½“ç§¯å¯èƒ½ä¼šæ›´å°ã€‚å› æ­¤ï¼ŒåŒ… Size çš„é—®é¢˜ä¸è¶³ä¸ºè™‘ã€‚</p><p><img src="https://img30.360buyimg.com/ling/jfs/t1/88749/23/9077/15347/5e0ae41cE71f77070/3f24bf6459abf2e9.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>hybird</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wechat</tag>
      
      <tag>mini-program</tag>
      
      <tag>Taro</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MpvueåŸç†åˆ†æ</title>
    <link href="/2023/08/28/Mpvue%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/"/>
    <url>/2023/08/28/Mpvue%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h3 id="ä¸€ã€åŠç¼–è¯‘åŠè¿è¡Œæ—¶"><a href="#ä¸€ã€åŠç¼–è¯‘åŠè¿è¡Œæ—¶" class="headerlink" title="ä¸€ã€åŠç¼–è¯‘åŠè¿è¡Œæ—¶"></a>ä¸€ã€åŠç¼–è¯‘åŠè¿è¡Œæ—¶</h3><h4 id="1-1-ã€åŠç¼–è¯‘ã€‘vueçš„template-é€šè¿‡-mpvue-template-compiler-ç¼–è¯‘æˆ-wxml"><a href="#1-1-ã€åŠç¼–è¯‘ã€‘vueçš„template-é€šè¿‡-mpvue-template-compiler-ç¼–è¯‘æˆ-wxml" class="headerlink" title="1.1 ã€åŠç¼–è¯‘ã€‘vueçš„template é€šè¿‡ mpvue-template-compiler ç¼–è¯‘æˆ wxml"></a>1.1 ã€åŠç¼–è¯‘ã€‘vueçš„template é€šè¿‡ mpvue-template-compiler ç¼–è¯‘æˆ wxml</h4><p><img src="https://img14.360buyimg.com/ling/jfs/t1/107613/2/2742/42346/5e09f5c5E7424d037/b2d7a1d5327cdf4f.jpg"></p><h4 id="1-2-ã€åŠè¿è¡Œæ—¶ã€‘åœ¨å°ç¨‹åºä¸­å®ç°äº†ä¸€å¥—runtimeç”¨æ¥è·‘vueçš„scriptéƒ¨åˆ†çš„ä»£ç "><a href="#1-2-ã€åŠè¿è¡Œæ—¶ã€‘åœ¨å°ç¨‹åºä¸­å®ç°äº†ä¸€å¥—runtimeç”¨æ¥è·‘vueçš„scriptéƒ¨åˆ†çš„ä»£ç " class="headerlink" title="1.2 ã€åŠè¿è¡Œæ—¶ã€‘åœ¨å°ç¨‹åºä¸­å®ç°äº†ä¸€å¥—runtimeç”¨æ¥è·‘vueçš„scriptéƒ¨åˆ†çš„ä»£ç "></a>1.2 ã€åŠè¿è¡Œæ—¶ã€‘åœ¨å°ç¨‹åºä¸­å®ç°äº†ä¸€å¥—runtimeç”¨æ¥è·‘vueçš„scriptéƒ¨åˆ†çš„ä»£ç </h4><p>vueè¿è¡Œæ—¶</p><p><img src="https://img14.360buyimg.com/ling/jfs/t1/98880/36/8962/23682/5e09ee76Ee70d5703/898f0c8b2003eafe.jpg"></p><p>mpvueè¿è¡Œæ—¶</p><p><img src="https://img12.360buyimg.com/ling/jfs/t1/85977/36/9055/54025/5e09efc8Ea2a7e868/60360ca99a89c1a7.jpg"></p><p>&#x20;mpvue çš„è¿è¡Œæ—¶ï¼Œä¼šé¦–å…ˆå°† patch é˜¶æ®µçš„ DOM æ“ä½œç›¸å…³æ–¹æ³•ç½®ç©ºï¼Œä¹Ÿå°±æ˜¯ä»€ä¹ˆéƒ½ä¸åšã€‚å…¶æ¬¡ï¼Œåœ¨åˆ›å»º Vue å®ä¾‹çš„åŒæ—¶ï¼Œè¿˜ä¼šå·å·çš„è°ƒç”¨ <code>Page()</code> ç”¨äºç”Ÿæˆäº†å°ç¨‹åºçš„ page å®ä¾‹ã€‚ç„¶å è¿è¡Œæ—¶çš„ patch é˜¶æ®µä¼šç›´æ¥è°ƒç”¨ <code>$updateDataToMp()</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè·å–æŒ‚åœ¨åœ¨ page å®ä¾‹ä¸Šç»´æŠ¤çš„æ•°æ® ï¼Œç„¶åé€šè¿‡ <code>setData</code> æ–¹æ³•æ›´æ–°åˆ°è§†å›¾å±‚ã€‚</p><h3 id="äºŒã€æ•´ä½“æ¶æ„"><a href="#äºŒã€æ•´ä½“æ¶æ„" class="headerlink" title="äºŒã€æ•´ä½“æ¶æ„"></a>äºŒã€æ•´ä½“æ¶æ„</h3><p><img src="/img/image_kidDls1l_H.png"></p><ul><li>Vueå®ä¾‹ä¸å°ç¨‹åºPageå»ºç«‹å…³è”</li><li>å°ç¨‹åºå’ŒVueç”Ÿå‘½å‘¨æœŸå»ºç«‹æ˜ å°„å…³ç³»ï¼Œèƒ½åœ¨å°ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­è§¦å‘Vueç”Ÿå‘½å‘¨æœŸ</li><li>å»ºç«‹äº‹ä»¶ä»£ç†æœºåˆ¶ï¼Œåœ¨äº‹ä»¶ä»£ç†å‡½æ•°ä¸­è§¦å‘ä¸ä¹‹å¯¹åº”çš„Vueäº‹ä»¶å“åº”</li><li>å°ç¨‹åºä¸vueæ•°æ®åŒæ­¥</li></ul><h3 id="ä¸‰ã€æ•´ä½“æ€è€ƒ"><a href="#ä¸‰ã€æ•´ä½“æ€è€ƒ" class="headerlink" title="ä¸‰ã€æ•´ä½“æ€è€ƒ"></a>ä¸‰ã€æ•´ä½“æ€è€ƒ</h3><p>mpvueçš„å±€é™æ€§ï¼š</p><ol><li>ç”±äºå°ç¨‹åºæ¨¡ç‰ˆçš„é™åˆ¶ï¼Œæ— æ³•ä½¿ç”¨vueç‰¹æœ‰çš„apiï¼Œå¦‚ï¼šfilterã€v-html</li><li>å°†vueè¿è¡Œåœ¨å°ç¨‹åºä¸Šï¼Œå°ç¨‹åºå’Œvueçš„è¿è¡Œæ—¶æ€§èƒ½å†³å®šäº†mpvueçš„ä¸Šé™</li><li>forkäº†vue@2.4.1çš„ä»£ç ï¼Œä½¿å¾—mpvueæ— æ³•åŠæ—¶æ›´æ–°vueçš„æ–°ç‰¹æ€§</li></ol>]]></content>
    
    
    <categories>
      
      <category>hybird</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mpvue</tag>
      
      <tag>wechat</tag>
      
      <tag>mini-program</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>expressæ‰‹å†™</title>
    <link href="/2023/08/27/express%E6%89%8B%E5%86%99/"/>
    <url>/2023/08/27/express%E6%89%8B%E5%86%99/</url>
    
    <content type="html"><![CDATA[<h4 id="æ‰§è¡Œä»£ç "><a href="#æ‰§è¡Œä»£ç " class="headerlink" title="æ‰§è¡Œä»£ç "></a>æ‰§è¡Œä»£ç </h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./index.js&#x27;</span>)<br><span class="hljs-keyword">let</span> app = <span class="hljs-title function_">express</span>();<br><span class="hljs-comment">// å‚æ•°ä¸å†™å°±æ˜¯ /</span><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res,next</span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;middleware&#x27;</span>)<br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>,<span class="hljs-string">&#x27;text/html;charset=utf-8&#x27;</span>)<br>  <span class="hljs-title function_">next</span>(<span class="hljs-string">&#x27;name error&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/name&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>)&#123;<br>  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;name&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;*&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>)&#123;<br>  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;all&#x27;</span>)<br>&#125;)<br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">err,req,res,next</span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)<br>  <span class="hljs-title function_">next</span>(err)<br>&#125;)<br>app.<span class="hljs-title function_">use</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">err,req,res,next</span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err+<span class="hljs-string">&#x27; 2&#x27;</span>)<br>  <span class="hljs-title function_">next</span>()<br>&#125;)<br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/age&#x27;</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params">req,res</span>)&#123;<br>  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;age&#x27;</span>)<br>&#125;)<br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3001</span>,<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;server start 3001&#x27;</span>)<br>&#125;)<br><br></code></pre></td></tr></table></figure><h4 id="æ‰‹å†™ä»£ç "><a href="#æ‰‹å†™ä»£ç " class="headerlink" title="æ‰‹å†™ä»£ç "></a>æ‰‹å†™ä»£ç </h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>);<br><span class="hljs-keyword">let</span> url = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;url&#x27;</span>)<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">createApplication</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-comment">// app æ˜¯ä¸€ä¸ªç›‘å¬å‡½æ•°</span><br>  <span class="hljs-keyword">let</span> <span class="hljs-title function_">app</span> = (<span class="hljs-params">req,res</span>)=&gt;&#123;<br>    <span class="hljs-comment">// å–å‡ºæ¯ä¸€ä¸ªlayer</span><br>    <span class="hljs-comment">// 1.è·å–è¯·æ±‚çš„æ–¹æ³•</span><br>    <span class="hljs-keyword">let</span> m = req.<span class="hljs-property">method</span>.<span class="hljs-title function_">toLowerCase</span>();<br>    <span class="hljs-keyword">let</span> &#123; pathname &#125; = url.<span class="hljs-title function_">parse</span>(req.<span class="hljs-property">url</span>,<span class="hljs-literal">true</span>)<br>    <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// é€’å½’</span><br>    <span class="hljs-keyword">function</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">err</span>)&#123;<br>      <span class="hljs-comment">// æ•°ç»„å…¨éƒ¨è¿­ä»£å®Œæ¯•è¿˜æ²¡æœ‰æ‰¾åˆ°ï¼Œè¯´æ˜è·¯å¾„ä¸å­˜åœ¨</span><br>      <span class="hljs-keyword">if</span>(index === app.<span class="hljs-property">routes</span>.<span class="hljs-property">length</span>)&#123;<br>        <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">end</span>(<span class="hljs-string">`Cannot find <span class="hljs-subst">$&#123;m&#125;</span> <span class="hljs-subst">$&#123;pathname&#125;</span>`</span>)<br>      &#125;<br>      <span class="hljs-keyword">let</span> &#123;method, path, handler&#125; = app.<span class="hljs-property">routes</span>[index++]<br>      <span class="hljs-keyword">if</span>(err)&#123;<br>        <span class="hljs-comment">// å¦‚æœæœ‰é”™è¯¯ æˆ‘ä»¬åº”è¯¥å»æ‰¾é”™è¯¯ä¸­é—´ä»¶ï¼Œé”™è¯¯ä¸­é—´ä»¶æœ‰å››ä¸ªå‚æ•°</span><br>        <span class="hljs-keyword">if</span>(handler.<span class="hljs-property">length</span> === <span class="hljs-number">4</span>)&#123;<br>          <span class="hljs-title function_">handler</span>(err,req,res,next)<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-comment">// å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œè¦å°†errorç»§ç»­ä¼ é€’ä¸‹å»</span><br>          <span class="hljs-title function_">next</span>(err)<br>        &#125;<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">if</span>(method === <span class="hljs-string">&#x27;middle&#x27;</span>)&#123;<br>          <span class="hljs-keyword">if</span>(path === <span class="hljs-string">&#x27;/&#x27;</span> || path === pathname || pathname.<span class="hljs-title function_">startsWith</span>(path+<span class="hljs-string">&#x27;/&#x27;</span>))&#123;<br>            <span class="hljs-title function_">handler</span>(req,res,next);<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_">next</span>(); <span class="hljs-comment">// å¦‚æœè¿™ä¸ªä¸­é—´ä»¶æ²¡æœ‰åŒ¹é…åˆ°ï¼Œç»§ç»­èµ°ä¸‹ä¸€ä¸ª</span><br>          &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-keyword">if</span>(<br>            (method === m || method === <span class="hljs-string">&#x27;all&#x27;</span>) &amp;&amp; <br>            (path === pathname || path === <span class="hljs-string">&#x27;*&#x27;</span>)<br>          )&#123;<br>            <span class="hljs-title function_">handler</span>(req,res)<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_">next</span>();<br>          &#125;<br>        &#125;<br>      &#125;<br>      <br>    &#125;<br>    <span class="hljs-title function_">next</span>();<br>  &#125;<br>  <span class="hljs-comment">// è·¯å¾„æ˜¯ä¸€ä¸ªæ•°ç»„</span><br>  app.<span class="hljs-property">routes</span> = [];<br>  app.<span class="hljs-property">use</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">path,handler</span>)&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> handler !== <span class="hljs-string">&#x27;function&#x27;</span>)&#123;<br>      handler = path;<br>      path =<span class="hljs-string">&#x27;/&#x27;</span><br>    &#125;<br>    <span class="hljs-keyword">let</span> layer = &#123;<br>      <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;middle&#x27;</span>,<br>      path,<br>      handler<br>    &#125;<br>    app.<span class="hljs-property">routes</span>.<span class="hljs-title function_">push</span>(layer)<br>  &#125;<br>  app.<span class="hljs-property">all</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">path,handler</span>)&#123;<br>    <span class="hljs-keyword">let</span> layer = &#123;<br>      <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;all&#x27;</span>,<br>      path,<br>      handler<br>    &#125;<br>    app.<span class="hljs-property">routes</span>.<span class="hljs-title function_">push</span>(layer)<br>  &#125;<br>  http.<span class="hljs-property">METHODS</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">method</span>=&gt;</span>&#123;<br>    method = method.<span class="hljs-title function_">toLocaleLowerCase</span>();<br>    app[method] = <span class="hljs-keyword">function</span>(<span class="hljs-params">path,handler</span>)&#123;<br>      <span class="hljs-keyword">let</span> layer = &#123;<br>        method,<br>        path,<br>        handler<br>      &#125;<br>      app.<span class="hljs-property">routes</span>.<span class="hljs-title function_">push</span>(layer)<br>    &#125;<br>  &#125;)<br>  app.<span class="hljs-property">listen</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    <span class="hljs-keyword">let</span> server = http.<span class="hljs-title function_">createServer</span>(app)<br>    server.<span class="hljs-title function_">listen</span>(...<span class="hljs-variable language_">arguments</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span> app;<br>&#125;<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = createApplication<br><br></code></pre></td></tr></table></figure><h4 id="express-åŸºæœ¬è§„åˆ™"><a href="#express-åŸºæœ¬è§„åˆ™" class="headerlink" title="express åŸºæœ¬è§„åˆ™"></a>express åŸºæœ¬è§„åˆ™</h4><p>&#x20;1.  è·¯ç”±åŒ¹é…(<code>app.get</code>ã€<code>app.post</code> â€¦)ï¼Œ<code>app.all</code> å…¨è·¯ç”±åŒ¹é…<br>&#x20;2.  <code>app.use(path,handler)</code> ä¸­é—´ä»¶åŒ¹é…ï¼Œåªæœ‰<code>handler</code>è¯<code>path</code>é»˜è®¤ä¸º<code> /</code><br>&#x20;3.  ä¸­é—´ä»¶ç”¨nextæ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼Œnextä¸€æ—¦ä¼ å…¥ä¿¡æ¯åˆ™ä¼šå»å¯»æ‰¾é”™è¯¯ä¸­é—´ä»¶<br>&#x20;   é”™è¯¯ä¸­é—´ä»¶æœ‰4ä¸ªå‚æ•°</p><h4 id="express-æ€»ç»“"><a href="#express-æ€»ç»“" class="headerlink" title="express æ€»ç»“"></a>express æ€»ç»“</h4><ol><li>expressä¸­é—´ä»¶å’Œè·¯ç”±æŒ‰é¡ºåºæ”¾å…¥routesï¼Œ</li><li>å½“æ‰§è¡Œä¸­é—´ä»¶çš„æ—¶å€™ï¼Œä¼šä¼ é€’nextï¼Œä½¿å¾—ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è€…è·¯ç”±å¾—ä»¥æ‰§è¡Œ</li><li>å½“æ‰§è¡Œåˆ°è·¯ç”±çš„æ—¶å€™å°±ä¸ä¼šä¼ é€’nextï¼Œä¹Ÿä½¿å¾—routesçš„éå†æå‰ç»“æŸ</li><li>å½“æ‰§è¡Œå®Œé”™è¯¯ä¸­é—´ä»¶åï¼Œä¼šç»§ç»­æ‰§è¡Œåé¢çš„ä¸­é—´ä»¶å’Œè·¯ç”±</li></ol>]]></content>
    
    
    <categories>
      
      <category>Express</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Express</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>expresså…¥é—¨</title>
    <link href="/2023/08/26/express%E5%85%A5%E9%97%A8/"/>
    <url>/2023/08/26/express%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒNodejså·²ç»æˆäº†å¾ˆå¤šå…¬å¸å¯¹æˆ‘ä»¬è¿™ä¸€å²—ä½çš„ç¡¬æ€§è¦æ±‚ï¼Œè€Œ Express æ¡†æ¶åˆ™æ˜¯å…¶ä¸­çŸ¥ååº¦æœ€é«˜ã€ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„Nodejså¼€å‘æ¡†æ¶ï¼Œå®ƒå¸®åŠ©æˆ‘ä»¬å°è£…äº†Nodejsåº•å±‚çš„APIï¼Œå±è”½äº†å¤§é‡çš„ç¹ççš„ç»†èŠ‚ï¼Œè®©æˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸šåŠ¡å¼€å‘å°±è¡Œäº†ï¼Œæå¤§çš„é™ä½äº†å­¦ä¹ çš„æˆæœ¬ã€‚ä»Šå¤©è¿™ä¸ªè¯¾ç¨‹å°±æ˜¯æ•™å¤§å®¶å»æŒæ¡å¦‚ä½•ä½¿ç”¨expresså»æ­å»ºä¸€ä¸ªç®€æ˜“çš„åç«¯æœåŠ¡ï¼Œæˆ‘ä»¬ä¸»è¦å›´ç»•ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>è·¯ç”±</li><li>ä¸­é—´ä»¶</li><li>é™æ€æ–‡ä»¶æœåŠ¡</li><li>æ¨¡æ¿å¼•æ“</li></ul><h3 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h3><ul><li>ç”µè„‘ - mac</li><li>Node - 16.14.2</li><li>Npm - 8.5.0</li><li>Express - 4.x</li></ul><h3 id="ç¬¬ä¸€ä¸ªdemo"><a href="#ç¬¬ä¸€ä¸ªdemo" class="headerlink" title="ç¬¬ä¸€ä¸ªdemo"></a>ç¬¬ä¸€ä¸ªdemo</h3><h4 id="ä½¿ç”¨Nodejså†…ç½®çš„httpæ¨¡å—æ­å»ºæœåŠ¡"><a href="#ä½¿ç”¨Nodejså†…ç½®çš„httpæ¨¡å—æ­å»ºæœåŠ¡" class="headerlink" title="ä½¿ç”¨Nodejså†…ç½®çš„httpæ¨¡å—æ­å»ºæœåŠ¡"></a>ä½¿ç”¨Nodejså†…ç½®çš„httpæ¨¡å—æ­å»ºæœåŠ¡</h4><p>ä¸ºäº†ä¾¿äºå¤§å®¶å»ç†è§£expresså¯¹nodejsåšäº†å“ªäº›å°è£…ï¼Œåœ¨ä½¿ç”¨expressä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ä½¿ç”¨nodejså†…ç½®çš„httpæ¨¡å—æ˜¯æ€ä¹ˆæ­å»ºnodeæœåŠ¡çš„ã€‚</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>express-demo</code>çš„æ–‡ä»¶å¤¹å¹¶è¿›å…¥</p><p><code>mkdir express-demo &amp;&amp; cd express-demo</code></p><p>åˆ›å»º<code>server.js</code>ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> http = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;http&#x27;</span>)<br><br><span class="hljs-keyword">const</span> server = http.<span class="hljs-title function_">createServer</span>(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-property">statusCode</span> = <span class="hljs-number">200</span><br>  res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;text/html&#x27;</span>)<br>  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">&#x27;hello world&#x27;</span>)<br>&#125;)<br><br>server.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æœåŠ¡å·²å¯åŠ¨...&#x27;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨æ§åˆ¶å°ä¸­è¿è¡Œï¼š</p><p><code>node server.js</code></p><h4 id="ä½¿ç”¨expressæ­å»ºæœåŠ¡"><a href="#ä½¿ç”¨expressæ­å»ºæœåŠ¡" class="headerlink" title="ä½¿ç”¨expressæ­å»ºæœåŠ¡"></a>ä½¿ç”¨expressæ­å»ºæœåŠ¡</h4><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å†ç”¨expressæ­å»ºæœåŠ¡ã€‚</p><p>åœ¨ <code>express-demo</code> æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œ <code>npm init</code> å‘½ä»¤ï¼Œç„¶åä¸€è·¯å›è½¦ï¼Œå°±ä¼šå¸®æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>package.json</code> æ–‡ä»¶ï¼Œç„¶åå†æ‰§è¡Œ <code>npm install express</code>æ¥å®‰è£…expressæ¨¡å—ï¼Œç„¶åæ”¹å†™ <code>server.js</code> ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello world&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;æœåŠ¡å·²å¯åŠ¨...&#x27;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure><h4 id="Requestå’ŒResponseå¯¹è±¡"><a href="#Requestå’ŒResponseå¯¹è±¡" class="headerlink" title="Requestå’ŒResponseå¯¹è±¡"></a>Requestå’ŒResponseå¯¹è±¡</h4><ul><li>Requestå¯¹è±¡æ˜¯è¯·æ±‚å¯¹è±¡ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ä¸­çš„<code>req</code>å‚æ•°ï¼Œä¸»è¦æ˜¯ç½‘ç»œè¯·æ±‚ä¸­å¸¦çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚å‚æ•°, cookieç­‰ç­‰ã€‚ã€‚ã€‚</li><li>Responseå¯¹è±¡æ˜¯å“åº”å¯¹è±¡ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ä¸­çš„<code>res</code>å‚æ•°ï¼Œå¯ä»¥æ‰§è¡Œä¸€ç³»åˆ—çš„å“åº”æ“ä½œï¼Œæ¯”å¦‚ç»™å®¢æˆ·ç«¯å“åº”å†…å®¹å’ŒçŠ¶æ€ç­‰ç­‰ã€‚ã€‚ã€‚</li></ul><p>æŸ¥çœ‹Requestå’ŒResponseå¯¹è±¡çš„<a href="https://www.expressjs.com.cn/4x/api.html#req" title="æ‰€æœ‰API">æ‰€æœ‰API</a></p><h4 id="è·¯ç”±æœºåˆ¶"><a href="#è·¯ç”±æœºåˆ¶" class="headerlink" title="è·¯ç”±æœºåˆ¶"></a>è·¯ç”±æœºåˆ¶</h4><p>æ€è€ƒï¼šæˆ‘ä»¬åœ¨å‘åç«¯å‘è¯·æ±‚æ—¶é€šè¿‡ä»€ä¹ˆå»åŒºåˆ†æ¥å£çš„ï¼Ÿ</p><p>ç­”ï¼šè¯·æ±‚æ–¹å¼+æ¥å£url</p><p>æˆ‘ä»¬åœ¨expressä¸­ï¼Œå®šä¹‰è·¯ç”±çš„æ–¹å¼æ˜¯ï¼š</p><p><code>app.METHOD(URL, CALLBACK)</code></p><p>è¿™ç§æ–¹å¼å°±å¯ä»¥é€šè¿‡è¯·æ±‚æ–¹å¼å’ŒURLæ¥å¸®æˆ‘ä»¬åŒºåˆ†ä¸åŒçš„è¯·æ±‚ï¼Œä»è€Œå»æ‰§è¡Œä¸åŒçš„å“åº”ã€‚</p><h4 id="nodemon"><a href="#nodemon" class="headerlink" title="nodemon"></a>nodemon</h4><p>nodemonèƒ½å¤Ÿæ£€æµ‹å·¥ä½œåŒºä»£ç çš„å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨é‡å¯ã€‚</p><p>æ‰§è¡Œ <code>npm install nodemon --save-dev</code> å®‰è£…nodemonï¼Œç„¶åä¿®æ”¹package.jsonæ–‡ä»¶ä¸­çš„startå‘½ä»¤ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;express-demo&quot;</span>,<br>  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,<br>  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;server.js&quot;</span>,<br>  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,<br>    <span class="hljs-string">&quot;start&quot;</span>: <span class="hljs-string">&quot;nodemon server.js&quot;</span><br>  &#125;,<br>  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;license&quot;</span>: <span class="hljs-string">&quot;ISC&quot;</span>,<br>  <span class="hljs-string">&quot;dependencies&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;express&quot;</span>: <span class="hljs-string">&quot;^4.18.2&quot;</span><br>  &#125;,<br>  <span class="hljs-string">&quot;devDependencies&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;nodemon&quot;</span>: <span class="hljs-string">&quot;^2.0.20&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å†æ‰§è¡Œ<code>npm start</code>å¯åŠ¨æœåŠ¡ï¼Œä¹‹åæˆ‘ä»¬å†ä¿®æ”¹ä»£ç å°±ä¸éœ€è¦æ‰‹åŠ¨çš„é‡å¯æœåŠ¡äº†ã€‚</p><h3 id="æ ¸å¿ƒæ¦‚å¿µ"><a href="#æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="æ ¸å¿ƒæ¦‚å¿µ"></a>æ ¸å¿ƒæ¦‚å¿µ</h3><h4 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h4><p>åœ¨æµè§ˆå™¨ä¸­æˆ‘ä»¬æƒ³è¦è®¿é—®ç™¾åº¦ï¼Œåªéœ€è¦çŸ¥é“ç™¾åº¦çš„åœ°å€å°±è¡Œäº†ï¼Œè·¯ç”±ä¹Ÿæ˜¯ç±»ä¼¼çš„æ¦‚å¿µï¼Œæˆ‘ä»¬æƒ³è¦çŸ¥é“å®¢æˆ·ç«¯è°ƒç”¨çš„æ˜¯å“ªä¸ªæ¥å£ï¼Œå°±æ˜¯é€šè¿‡è·¯ç”±æ¥åˆ¤æ–­çš„ã€‚</p><h4 id="è·¯ç”±æ–¹æ³•"><a href="#è·¯ç”±æ–¹æ³•" class="headerlink" title="è·¯ç”±æ–¹æ³•"></a>è·¯ç”±æ–¹æ³•</h4><p>Express æ”¯æŒå¯¹åº”äº HTTP æ–¹æ³•çš„ä»¥ä¸‹è·¯ç”±æ–¹æ³•ï¼š<code>get</code>ã€<code>post</code>ã€<code>put</code>ã€<code>delete</code>ç­‰ç­‰ã€‚ä½¿ç”¨æ–¹æ³•ä¸ºï¼š</p><p>app.METHOD(URL, CALLBACK)</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;hello world&#x27;</span>)<br>&#125;)<br><br>app.<span class="hljs-title function_">post</span>(<span class="hljs-string">&#x27;/about&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(&#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;å°æ˜&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><p>æœ‰ä¸€ç§ç‰¹æ®Šè·¯ç”±æ–¹æ³•ï¼š<code>app.all()</code>ï¼Œè¯¥æ–¹æ³•ç”¨äºåœ¨æ‰€æœ‰è¯·æ±‚æ–¹æ³•çš„è·¯å¾„ä¸­è£…å…¥ä¸­é—´ä»¶å‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&#x27;/about&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(&#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;jackie&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">18</span><br>  &#125;)<br>&#125;)<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªç¤ºä¾‹ä¸­ä¸ç®¡æ˜¯<code>get</code>, <code>post</code>æ–¹å¼å»è¯·æ±‚<code>/about</code>è·¯å¾„çš„æ¥å£ï¼Œéƒ½ä¼šç»è¿‡è¿™ä¸ªå›è°ƒå‡½æ•°ç„¶åè¿”å›å¯¹åº”çš„æ•°æ®ã€‚</p><h4 id="è·¯ç”±è·¯å¾„"><a href="#è·¯ç”±è·¯å¾„" class="headerlink" title="è·¯ç”±è·¯å¾„"></a>è·¯ç”±è·¯å¾„</h4><p>è·¯ç”±è·¯å¾„å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€å­—ç¬¦ä¸²æ¨¡å¼æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚å­—ç¬¦ä¸²ç±»å‹çš„å°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä¸¾çš„é‚£äº›ä¾‹å­ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹å­—ç¬¦ä¸²æ¨¡å¼å’Œæ­£åˆ™è¡¨è¾¾å¼è¿™ä¸¤ç§ã€‚</p><p>ä»¥ä¸‹æ˜¯åŸºäºå­—ç¬¦ä¸²æ¨¡å¼çš„è·¯ç”±è·¯å¾„çš„ä¸€äº›ç¤ºä¾‹ã€‚</p><p>æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… <code>acd</code> å’Œ <code>abcd</code>ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/ab?cd&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ab?cd&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… <code>abcd</code>ã€<code>abbcd</code>ã€<code>abbbcd</code> ç­‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/ab+cd&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ab+cd&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… <code>abcd</code>ã€<code>abxcd</code>ã€<code>abRABDOMcd</code>ã€<code>ab123cd</code> ç­‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/ab*cd&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;ab*cd&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>åŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„è·¯ç”±è·¯å¾„çš„ç¤ºä¾‹ï¼š</p><p>æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é…åç§°ä¸­å…·æœ‰â€œaâ€çš„æ‰€æœ‰è·¯ç”±ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-regexp">/a/</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;/a/&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>æ­¤è·¯ç”±è·¯å¾„å°†åŒ¹é… <code>butterfly</code> å’Œ <code>dragonfly</code>ï¼Œä½†æ˜¯ä¸åŒ¹é… <code>butterflyman</code>ã€<code>dragonfly man</code> ç­‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-regexp">/.*fly$/</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;/.*fly$/&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="è·¯ç”±æ‹†åˆ†"><a href="#è·¯ç”±æ‹†åˆ†" class="headerlink" title="è·¯ç”±æ‹†åˆ†"></a>è·¯ç”±æ‹†åˆ†</h4><p>å½“æˆ‘ä»¬çš„è·¯ç”±è¶Šæ¥è¶Šå¤æ‚ï¼Œæ¯”å¦‚æœ‰ç”¨æˆ·ç›¸å…³çš„è·¯å¾„ï¼Œæœ‰ç³»ç»Ÿç›¸å…³çš„è·¯å¾„ï¼Œä¸ç»Ÿä¸€ç®¡ç†çš„è¯ä¼šæ˜¾å¾—ç‰¹åˆ«ä¹±ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯¹è·¯ç”±è¿›è¡Œæ‹†åˆ†æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚</p><ul><li>æ‹†åˆ†å‰<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/list&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>)&#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;/list&#x27;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/user/detail&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>)&#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;/detail&#x27;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);<br></code></pre></td></tr></table></figure></li><li>æ‹†åˆ†å,åˆ©ç”¨<code>express.Router()</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><span class="hljs-keyword">const</span> user = express.<span class="hljs-title class_">Router</span>();<br><br>user.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/list&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>)&#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;/list&#x27;</span>);<br>&#125;);<br><br>user.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/detail&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">req, res, next</span>)&#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;/detail&#x27;</span>);<br>&#125;);<br><br>app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;/user&#x27;</span>, user); <span class="hljs-comment">// æ³¨å†Œuserå­è·¯ç”±</span><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>);<br></code></pre></td></tr></table></figure></li></ul><h4 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h4><p>ä¸€èˆ¬å­¦ä¹ jsçš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šå¬åˆ°ä¸€å¥è¯ï¼šä¸€åˆ‡çš†å‡½æ•°ã€‚è€Œåœ¨å­¦ä¹ expressçš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆæ·±çš„ä¸€ä¸ªæ„Ÿå—å°±æ˜¯ï¼šä¸€åˆ‡çš†ä¸­é—´ä»¶ã€‚æ¯”å¦‚å¸¸è§çš„è¯·æ±‚å‚æ•°è§£æã€cookieè§£æã€æ—¥å¿—æ‰“å°ç­‰ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸­é—´ä»¶æ¥å®Œæˆã€‚</p><p>åœ¨ Express ä¸­ï¼Œä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">someMiddleware</span>(<span class="hljs-params">req, res, next</span>) &#123;<br>  <span class="hljs-comment">// è‡ªå®šä¹‰é€»è¾‘</span><br>  <span class="hljs-title function_">next</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸‰ä¸ªå‚æ•°ä¸­ï¼Œ<code>req</code> å’Œ <code>res</code> å°±æ˜¯å‰é¢æåˆ°çš„ Request è¯·æ±‚å¯¹è±¡å’Œ Response å“åº”å¯¹è±¡ï¼›è€Œ <code>next</code> å‡½æ•°åˆ™ç”¨æ¥è§¦å‘ä¸‹ä¸€ä¸ªä¸­é—´ä»¶çš„æ‰§è¡Œã€‚</p><p>åœ¨ Express ä½¿ç”¨ä¸­é—´ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼š<strong>å…¨å±€ä¸­é—´ä»¶</strong>å’Œ<strong>è·¯ç”±ä¸­é—´ä»¶</strong>ã€‚</p><h4 id="å…¨å±€ä¸­é—´ä»¶"><a href="#å…¨å±€ä¸­é—´ä»¶" class="headerlink" title="å…¨å±€ä¸­é—´ä»¶"></a>å…¨å±€ä¸­é—´ä»¶</h4><p>é€šè¿‡ <code>app.use</code> å‡½æ•°å°±å¯ä»¥æ³¨å†Œä¸­é—´ä»¶ï¼Œå¹¶ä¸”æ­¤ä¸­é—´ä»¶ä¼šåœ¨ç”¨æˆ·å‘èµ·<strong>ä»»ä½•è¯·æ±‚</strong>éƒ½å¯èƒ½ä¼šæ‰§è¡Œï¼Œä¾‹å¦‚ï¼š</p><p><code>app.use(someMiddleware)</code></p><h4 id="è·¯ç”±ä¸­é—´ä»¶"><a href="#è·¯ç”±ä¸­é—´ä»¶" class="headerlink" title="è·¯ç”±ä¸­é—´ä»¶"></a>è·¯ç”±ä¸­é—´ä»¶</h4><p>é€šè¿‡åœ¨è·¯ç”±å®šä¹‰æ—¶æ³¨å†Œä¸­é—´ä»¶ï¼Œæ­¤ä¸­é—´ä»¶åªä¼šåœ¨ç”¨æˆ·è®¿é—®è¯¥è·¯ç”±æ—¶æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/middleware&#x27;</span>, someMiddleware, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;Hello World&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><h4 id="ç¼–å†™ä¸€ä¸ªæ—¥å¿—ä¸­é—´ä»¶"><a href="#ç¼–å†™ä¸€ä¸ªæ—¥å¿—ä¸­é—´ä»¶" class="headerlink" title="ç¼–å†™ä¸€ä¸ªæ—¥å¿—ä¸­é—´ä»¶"></a>ç¼–å†™ä¸€ä¸ªæ—¥å¿—ä¸­é—´ä»¶</h4><ol><li>æ–°å»ºä¸€ä¸ªlogger.jsï¼Œå¹¶å†™å…¥ä»¥ä¸‹å‡½æ•°<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">logger</span>(<span class="hljs-params">req, res, next</span>) &#123;<br>  <span class="hljs-keyword">const</span> time = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`[<span class="hljs-subst">$&#123;time.toLocaleString()&#125;</span>] <span class="hljs-subst">$&#123;req.method&#125;</span> <span class="hljs-subst">$&#123;req.url&#125;</span>`</span>);<br>  <span class="hljs-title function_">next</span>();<br>&#125;<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = logger;<br></code></pre></td></tr></table></figure></li><li>åœ¨server.jså¼•å…¥loggerå‡½æ•°å¹¶ä¸”å…¨å±€æ³¨å†Œ<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> logger = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./logger&#x27;</span>)<br>...<br>...<br>app.<span class="hljs-title function_">use</span>(logger)<br>...<br>...<br></code></pre></td></tr></table></figure></li></ol><p>è¿™æ ·æˆ‘ä»¬åœ¨è®¿é—®è·¯ç”±åï¼Œæ¯æ¬¡éƒ½ä¼šåœ¨æ§åˆ¶å°æ‰“å°ä¸€è¡Œæ—¥å¿—ï¼Œå¦‚ä¸‹ï¼š</p><p>[2023&#x2F;2&#x2F;27 15:54:29] GET &#x2F;</p><p>[2023&#x2F;2&#x2F;27 15:54:47] POST &#x2F;about</p><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœå¿˜è®°åœ¨ä¸­é—´ä»¶ä¸­è°ƒç”¨ <code>next</code> å‡½æ•°ï¼Œå¹¶ä¸”åˆä¸ç›´æ¥è¿”å›å“åº”æ—¶ï¼ŒæœåŠ¡å™¨ä¼šç›´æ¥å¡åœ¨è¿™ä¸ªä¸­é—´ä»¶ä¸ä¼šç»§ç»­æ‰§è¡Œä¸‹å»å“¦ï¼</p></blockquote><h4 id="æ¨¡ç‰ˆå¼•æ“"><a href="#æ¨¡ç‰ˆå¼•æ“" class="headerlink" title="æ¨¡ç‰ˆå¼•æ“"></a>æ¨¡ç‰ˆå¼•æ“</h4><p>æ¨¡ç‰ˆå¼•æ“å¯ä»¥ç®€å•çš„ç†è§£ä¸ºå‡çº§ç‰ˆçš„<code>html</code>æ–‡æ¡£ï¼Œexpresså¯ä»¥ç”¨æ¨¡ç‰ˆå¼•æ“æ¥æ¸²æŸ“å‰ç«¯é¡µé¢ï¼Œæ¨¡ç‰ˆå¼•æ“æœ‰å¾ˆå¤šç§ï¼ŒåŒ…æ‹¬<code>jade</code>, <code>ejs</code>, <code>nunjunks</code>, <code>Handlebars</code>ç­‰ç­‰ï¼Œexpresså¯¹æ¯ä¸€ç§éƒ½æä¾›äº†å¾ˆå¥½çš„æ”¯æŒï¼Œåªéœ€è¦å‡ è¡Œä»£ç å°±å¯ä»¥ä½¿ç”¨ã€‚æˆ‘ä»¬ä»Šå¤©æ¥å­¦ä¹ ä¸‹<code>Handlebars</code>ã€‚</p><p>é¦–å…ˆï¼Œç¬¬ä¸€æ­¥æ˜¯å®‰è£…å¯¹åº”çš„æ¨¡ç‰ˆå¼•æ“ï¼š</p><p><code>npm install hbs</code></p><p>ç„¶ååˆ›å»ºviewsæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æ–°å»ºä¸€ä¸ªindex.hbsçš„æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;h1&gt;expresså…¥é—¨è¯¾ç¨‹&lt;/h1&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒNodejså·²ç»æˆäº†å¾ˆå¤šå…¬å¸å¯¹æˆ‘ä»¬è¿™ä¸€å²—ä½çš„ç¡¬æ€§è¦æ±‚ï¼Œè€Œ Express æ¡†æ¶åˆ™æ˜¯å…¶ä¸­çŸ¥ååº¦æœ€é«˜ã€ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„Nodejså¼€å‘æ¡†æ¶ã€‚ã€‚ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/about&quot;</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>ç„¶åå†æ·»åŠ ä¸€ä¸ªabout.hbsçš„æ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;h1&gt;é»‘é©¬å‰ç«¯&lt;/h1&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å­¦å‰ç«¯ï¼Œæ¥é»‘é©¬<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>æœ€åä¾¿æ˜¯åœ¨ server.js ä¸­é…ç½®å’Œä½¿ç”¨æ¨¡æ¿ã€‚é…ç½®æ¨¡æ¿çš„ä»£ç éå¸¸ç®€å•ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// æŒ‡å®šæ¨¡æ¿å­˜æ”¾ç›®å½•</span><br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;views&#x27;</span>, <span class="hljs-string">&#x27;views&#x27;</span>);<br><br><span class="hljs-comment">// æŒ‡å®šæ¨¡æ¿å¼•æ“ä¸º Handlebars</span><br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;hbs&#x27;</span>);<br></code></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨æ¨¡æ¿æ—¶ï¼Œåªéœ€åœ¨è·¯ç”±å›è°ƒå‡½æ•°ä¸­è°ƒç”¨ <code>res.render</code> æ–¹æ³•å³å¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// ...</span><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;views&#x27;</span>, <span class="hljs-string">&#x27;views&#x27;</span>);<br>app.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;hbs&#x27;</span>);<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// æ¸²æŸ“index.hbsæ¨¡ç‰ˆ</span><br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;index&#x27;</span>);<br>&#125;);<br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/about&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// æ¸²æŸ“about.hbsæ¨¡ç‰ˆ</span><br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;about&#x27;</span>);<br>&#125;)<br><br><span class="hljs-comment">// ...</span><br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬è®¿é—®<code>localhost:3000</code>æ—¶å°±ä¼šåŠ è½½å¯¹åº”çš„index.hbsè¿™ä¸ªæ¨¡ç‰ˆï¼Œå½“æˆ‘ä»¬è®¿é—®<code>localhost:3000/about</code>æ—¶å°±ä¼šåŠ è½½å¯¹åº”çš„about.hbsè¿™ä¸ªæ¨¡ç‰ˆ</p><p>æˆ‘ä»¬è¿˜å¯ä»¥ç»™æ¨¡ç‰ˆå¼•æ“ä¸­ä¼ ä¸€äº›åŠ¨æ€å‚æ•°ï¼Œè¿™æ ·å°±ä¼šæ¸²æŸ“å‡ºæ¥ä¸åŒçš„å†…å®¹ï¼Œå°†about.hbsæ”¹æˆå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;h1&gt;é»‘é©¬å‰ç«¯&lt;/h1&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å­¦å‰ç«¯ï¼Œæ¥é»‘é©¬<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è®²å¸ˆï¼š&#123;&#123; name &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>å¹´é¾„ï¼š&#123;&#123; age &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨æ¸²æŸ“è¯¥æ¨¡ç‰ˆæ—¶åŠ ä¸Šç¬¬äºŒä¸ªå‚æ•°:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/about&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-comment">// æ¸²æŸ“about.hbsæ¨¡ç‰ˆ</span><br>  res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;about&#x27;</span>, &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;jackie&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span> &#125;);<br>&#125;)<br></code></pre></td></tr></table></figure><p>è¿™æ ·å½“æ¸²æŸ“å‡ºæ¥çš„æ—¶å€™å°±ä¼šæ ¹æ®æˆ‘ä»¬ä¼ è¿›å»çš„å‚æ•°åŠ¨æ€æ¸²æŸ“å‰ç«¯é¡µé¢äº†</p><h4 id="é™æ€æ–‡ä»¶æœåŠ¡"><a href="#é™æ€æ–‡ä»¶æœåŠ¡" class="headerlink" title="é™æ€æ–‡ä»¶æœåŠ¡"></a>é™æ€æ–‡ä»¶æœåŠ¡</h4><p>å®¢æˆ·ç«¯ä¸€èˆ¬éœ€è¦è®¿é—®ä¸€äº›å›¾ç‰‡è§†é¢‘ç­‰é™æ€èµ„æºæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™äº›æ–‡ä»¶å¦‚ä½•å‘é€ç»™å®¢æˆ·ç«¯å‘¢ï¼Œå°±éœ€è¦ç”¨åˆ°é™æ€æ–‡ä»¶æœåŠ¡äº†ï¼Œè€Œ Express å·²ç»è‡ªå¸¦äº†é™æ€æ–‡ä»¶æœåŠ¡ä¸­é—´ä»¶ <code>express.static</code>ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚</p><p>å‡è®¾æˆ‘ä»¬çš„é™æ€èµ„æºåœ¨publicä¸‹é¢ï¼š</p><p>public</p><p>â”œâ”€â”€ css</p><p>â”‚   â””â”€â”€ style.css</p><p>â””â”€â”€ img</p><p>â””â”€â”€ logo.png</p><p>ç„¶åæˆ‘ä»¬åªéœ€è¦åœ¨server.jsä¸­æ·»åŠ ä¸€è¡Œä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">use</span>(express.<span class="hljs-title function_">static</span>(<span class="hljs-string">&#x27;public&#x27;</span>));<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸‹é¢çš„è·¯å¾„è®¿é—®åˆ°è¿™äº›èµ„æºäº†ï¼š</p><p><a href="http://localhost:3000/css/style.css" title="http://localhost:3000/css/style.css">http://localhost:3000/css/style.css</a></p><p><a href="http://localhost:3000/img/logo.png" title="http://localhost:3000/img/logo.png">http://localhost:3000/img/logo.png</a></p><p>åœ¨æ¨¡æ¿å¼•æ“ä¸­æ”¾å…¥è¿™äº›èµ„æºçš„å¼•å…¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¨¡æ¿ä¸­ä½¿ç”¨äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;link rel=<span class="hljs-string">&quot;stylesheet&quot;</span> href=<span class="hljs-string">&quot;/css/style.css&quot;</span> /&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>expresså…¥é—¨è¯¾ç¨‹<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä½œä¸ºå‰ç«¯å¼€å‘ï¼ŒNodejså·²ç»æˆäº†å¾ˆå¤šå…¬å¸å¯¹æˆ‘ä»¬è¿™ä¸€å²—ä½çš„ç¡¬æ€§è¦æ±‚ï¼Œè€Œ Express æ¡†æ¶åˆ™æ˜¯å…¶ä¸­çŸ¥ååº¦æœ€é«˜ã€ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„Nodejså¼€å‘æ¡†æ¶ã€‚ã€‚ã€‚<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/about&quot;</span>&gt;</span>å…³äºæˆ‘ä»¬<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡ŒæœåŠ¡å™¨ï¼Œå¹¶è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™æ—¶ï¼Œå°±å‘ç°æ ·å¼åŠ åˆ°äº†æˆ‘ä»¬çš„å‰ç«¯é¡µé¢ä¸Šäº†ã€‚</p><h4 id="å¤„ç†404å’ŒæœåŠ¡å™¨é”™è¯¯"><a href="#å¤„ç†404å’ŒæœåŠ¡å™¨é”™è¯¯" class="headerlink" title="å¤„ç†404å’ŒæœåŠ¡å™¨é”™è¯¯"></a>å¤„ç†404å’ŒæœåŠ¡å™¨é”™è¯¯</h4><p>æˆ‘ä»¬åœ¨è®¿é—®ä¸€äº›è·¯ç”±æ—¶æœ‰å¯èƒ½è¿™ä¸ªè·¯ç”±æ²¡æœ‰å®šä¹‰ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè¿”å›404çš„çŠ¶æ€ç ï¼Œæˆ–è€…æœ‰æ—¶å€™æœåŠ¡å™¨å†…éƒ¨ä»£ç å‡ºé”™äº†ï¼Œå°±ä¼šè¿”å›500çš„é”™è¯¯ç ï¼Œè¿™äº›æƒ…å†µæ˜¯åœ¨å¼€å‘ä¸­ç»å¸¸ç¢°åˆ°çš„ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯åº”è¯¥å¦‚ä½•å¤„ç†è¿™äº›å¼‚å¸¸çš„æƒ…å†µå‘¢ï¼Ÿ</p><ul><li>å¯¹äº 404ï¼Œåªéœ€åœ¨æ‰€æœ‰è·¯ç”±ä¹‹åå†åŠ ä¸€ä¸ªä¸­é—´ä»¶ï¼Œç”¨æ¥æ¥æ”¶æ‰€æœ‰è·¯ç”±å‡åŒ¹é…å¤±è´¥çš„è¯·æ±‚</li><li>å¯¹äºé”™è¯¯å¤„ç†ï¼Œå‰é¢æ‰€æœ‰ä¸­é—´ä»¶æŠ›å‡ºå¼‚å¸¸æ—¶éƒ½ä¼šè¿›å…¥é”™è¯¯å¤„ç†å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ Express è‡ªå¸¦çš„ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚</li></ul><h4 id="å¤„ç†404"><a href="#å¤„ç†404" class="headerlink" title="å¤„ç†404"></a>å¤„ç†404</h4><p>åªéœ€åœ¨server.jsä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">use</span>(<span class="hljs-string">&#x27;*&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">404</span>).<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;404&#x27;</span>, &#123; <span class="hljs-attr">url</span>: req.<span class="hljs-property">originalUrl</span> &#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨viewsä¸‹é¢æ–°å»ºä¸€ä¸ª404.hbsçš„æ¨¡ç‰ˆæ–‡ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;h1&gt;æ‰¾ä¸åˆ°ä½ è¦çš„é¡µé¢äº†ï¼&lt;/h1&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>ä½ æ‰€è®¿é—®çš„è·¯å¾„ &#123;&#123; url &#125;&#125; ä¸å­˜åœ¨<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><code>*</code> è¡¨ç¤ºåŒ¹é…ä»»ä½•è·¯å¾„ã€‚å°†æ­¤ä¸­é—´ä»¶æ”¾åœ¨æ‰€æœ‰è·¯ç”±åé¢ï¼Œå³å¯æ•è·æ‰€æœ‰è®¿é—®è·¯å¾„å‡åŒ¹é…å¤±è´¥çš„è¯·æ±‚ï¼Œç„¶åæ¸²æŸ“404çš„é‚£ä¸ªæ¨¡ç‰ˆå¼•æ“å°±å¯ä»¥äº†ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šä¸€å®šæ˜¯æ”¾åœ¨æ‰€æœ‰è·¯ç”±çš„åé¢ï¼Œåªæœ‰å‰é¢çš„è·¯ç”±éƒ½åŒ¹é…ä¸ä¸Šæ‰ä¼šåŒ¹é…åˆ°<code>*</code>çš„è¿™ä¸ªè·¯ç”±</p><h4 id="å¤„ç†å†…éƒ¨é”™è¯¯"><a href="#å¤„ç†å†…éƒ¨é”™è¯¯" class="headerlink" title="å¤„ç†å†…éƒ¨é”™è¯¯"></a>å¤„ç†å†…éƒ¨é”™è¯¯</h4><p>åœ¨server.jsä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">use</span>(<span class="hljs-function">(<span class="hljs-params">err, req, res, next</span>) =&gt;</span> &#123;<br>  res.<span class="hljs-title function_">status</span>(<span class="hljs-number">500</span>).<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;500&#x27;</span>);<br>&#125;);<br></code></pre></td></tr></table></figure><p>ç„¶ååœ¨viewsä¸‹é¢æ–°å»ºä¸€ä¸ª500.hbsçš„æ¨¡ç‰ˆæ–‡ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;h1&gt;æœåŠ¡å™¨å¥½åƒå¼€å°å·®äº†&lt;/h1&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>è¿‡ä¸€ä¼šå„¿å†è¯•è¯•çœ‹å§ï¼See your later~<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„</strong>ï¼šåœ¨server.jsä¸­æ·»åŠ çš„ä»£ç ä¹Ÿå¿…é¡»è¦æ·»åŠ åˆ°æ‰€æœ‰è·¯ç”±çš„åé¢ï¼Œä¸ç„¶ä¸èƒ½å¤„ç†å…¨éƒ¨çš„é”™è¯¯</p><p>æˆ‘ä»¬åœ¨æŸä¸ªè·¯ç”±ä¸­æ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ªé”™è¯¯åï¼Œå®¢æˆ·ç«¯å°±ä¼šæ¸²æŸ“500.hbsè¿™ä¸ªæ¨¡ç‰ˆæ–‡ä»¶ã€‚</p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è‡³æ­¤expressåŸºç¡€å†…å®¹å°±è®²è§£å®Œäº†ï¼Œè¿™äº›éƒ½æ˜¯expressçš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œåç»­è¿˜ä¼šæœ‰expressçš„è¿›é˜¶è¯¾ç¨‹ï¼Œåˆ°æ—¶å€™ä¼šæ¶‰åŠåˆ°ç”¨expressæ“ä½œæ•°æ®åº“å’Œå®æˆ˜çš„å†…å®¹ï¼Œæ„Ÿå…´è¶£çš„è¯å¯ä»¥å…³æ³¨æˆ‘ä»¬çš„bç«™åŠ¨æ€ï¼ŒåŠæ—¶è·Ÿè¿›è¯¾ç¨‹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Express</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Express</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSäº‹ä»¶å¾ªç¯æœºåˆ¶</title>
    <link href="/2023/08/25/JS%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6/"/>
    <url>/2023/08/25/JS%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#%E5%90%8C%E6%AD%A5%E4%BB%BB%E5%8A%A1%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1">åŒæ­¥ä»»åŠ¡ã€å¼‚æ­¥ä»»åŠ¡</a></li><li><a href="#%E4%BB%BB%E5%8A%A1%E7%B1%BB%E5%9E%8B%E5%AE%8F%E4%BB%BB%E5%8A%A1%E5%BE%AE%E4%BB%BB%E5%8A%A1">ä»»åŠ¡ç±»å‹ï¼šå®ä»»åŠ¡ã€å¾®ä»»åŠ¡</a></li></ul><h4 id="åŒæ­¥ä»»åŠ¡ã€å¼‚æ­¥ä»»åŠ¡"><a href="#åŒæ­¥ä»»åŠ¡ã€å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="åŒæ­¥ä»»åŠ¡ã€å¼‚æ­¥ä»»åŠ¡"></a>åŒæ­¥ä»»åŠ¡ã€å¼‚æ­¥ä»»åŠ¡</h4><p>JS é‡Œçš„ä¸€ç§ä»»åŠ¡åˆ†ç±»æ–¹å¼åˆ†ä¸º: åŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡</p><p>åŒæ­¥å’Œå¼‚æ­¥ä»»åŠ¡åˆ†åˆ«è¿›å…¥ä¸åŒçš„æ‰§è¡Œç¯å¢ƒï¼Œ<strong>åŒæ­¥çš„è¿›å…¥ä¸»çº¿ç¨‹</strong>ï¼Œå³ä¸»æ‰§è¡Œæ ˆï¼Œå¼‚æ­¥çš„è¿›å…¥ä»»åŠ¡é˜Ÿåˆ— Event Queue ã€‚</p><p><strong>å½“åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œä¼šå»ä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œç›¸åº”çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæ¨å…¥ä¸»çº¿ç¨‹æ‰§è¡Œ</strong>ã€‚ä¸Šè¿°è¿‡ç¨‹çš„ä¸æ–­é‡å¤å°±æ˜¯æˆ‘ä»¬è¯´çš„ Event Loop (äº‹ä»¶å¾ªç¯)ã€‚</p><p><img src="/img/image_lkYCeF8KVJ.png"></p><h4 id="ä»»åŠ¡ç±»å‹ï¼šå®ä»»åŠ¡ã€å¾®ä»»åŠ¡"><a href="#ä»»åŠ¡ç±»å‹ï¼šå®ä»»åŠ¡ã€å¾®ä»»åŠ¡" class="headerlink" title="ä»»åŠ¡ç±»å‹ï¼šå®ä»»åŠ¡ã€å¾®ä»»åŠ¡"></a>ä»»åŠ¡ç±»å‹ï¼šå®ä»»åŠ¡ã€å¾®ä»»åŠ¡</h4><p>å£è¯€ï¼šæœ‰å¾®åˆ™å¾®ï¼Œæ— å¾®åˆ™å®</p><p>æ¯ä¸€æ¬¡æ‰§è¡Œå®Œå®ä»»åŠ¡åï¼Œéƒ½ä¼šæ¸…ç©ºå¾®ä»»åŠ¡ï¼Œå†æ‰§è¡Œä¸‹ä¸€ä¸ªå®ä»»åŠ¡</p><p>å®ä»»åŠ¡ï¼šscript(æ•´ä½“ä»£ç )ã€setTimeoutã€setIntervalã€UI æ¸²æŸ“ã€ I&#x2F;Oã€postMessageã€ MessageChannelã€setImmediate(Node.js ç¯å¢ƒ)</p><p>å¾®ä»»åŠ¡ï¼šPromiseã€ MutaionObserverã€process.nextTick(Node.jsç¯å¢ƒï¼‰</p><p><img src="/img/image_gF4Ud4p1GT.png"></p>]]></content>
    
    
    <categories>
      
      <category>js</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Event Queue</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JSåƒåœ¾å›æ”¶æœºåˆ¶</title>
    <link href="/2023/08/24/JS%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/"/>
    <url>/2023/08/24/JS%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4mark-and-sweep">æ ‡è®°æ¸…é™¤ï¼ˆmark and sweepï¼‰</a><ul><li><a href="#%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4-mark-and-sweep%E6%B5%81%E7%A8%8B">æ ‡è®°æ¸…é™¤ (mark and sweep)æµç¨‹</a></li><li><a href="#%E6%A0%87%E8%AE%B0%E6%B8%85%E9%99%A4%E7%9A%84%E9%97%AE%E9%A2%98%E6%98%AF%E4%BB%80%E4%B9%88">æ ‡è®°æ¸…é™¤çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><li><a href="#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3-mark-and-sweep-%E7%9A%84%E9%97%AE%E9%A2%98-%E6%96%B0%E5%9B%9E%E6%94%B6%E7%AD%96%E7%95%A5mark-compact-%E6%8F%90%E5%87%BA%E6%9D%A5%E4%BA%86">å¦‚ä½•è§£å†³ mark and sweep çš„é—®é¢˜ï¼Ÿ æ–°å›æ”¶ç­–ç•¥mark-compact æå‡ºæ¥äº†</a></li></ul></li><li><a href="#%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0reference-counting">å¼•ç”¨è®¡æ•°(reference counting)</a><ul><li><a href="#%E5%BC%95%E7%94%A8%E8%AE%A1%E6%95%B0%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%E4%B8%BA%E4%BB%80%E4%B9%88%E5%90%8E%E9%9D%A2%E9%83%BD%E4%B8%8D%E7%94%A8%E4%BA%86">å¼•ç”¨è®¡æ•°æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåé¢éƒ½ä¸ç”¨äº†ï¼Ÿ</a></li></ul></li><li><a href="#%E4%B8%AA%E4%BA%BA%E7%90%86%E8%A7%A3">ä¸ªäººç†è§£</a></li></ul><h3 id="æ ‡è®°æ¸…é™¤ï¼ˆmark-and-sweepï¼‰"><a href="#æ ‡è®°æ¸…é™¤ï¼ˆmark-and-sweepï¼‰" class="headerlink" title="æ ‡è®°æ¸…é™¤ï¼ˆmark and sweepï¼‰"></a>æ ‡è®°æ¸…é™¤ï¼ˆmark and sweepï¼‰</h3><p>å¤§éƒ¨åˆ†æµè§ˆå™¨ä»¥æ­¤æ–¹å¼è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå½“å˜é‡<strong>è¿›å…¥æ‰§è¡Œç¯å¢ƒ</strong>ï¼ˆå‡½æ•°ä¸­å£°æ˜å˜é‡ï¼‰çš„æ—¶å€™ï¼Œåƒåœ¾å›æ”¶å™¨å°†å…¶æ ‡è®°ä¸ºâ€œè¿›å…¥ç¯å¢ƒâ€ï¼Œå½“å˜é‡ç¦»å¼€ç¯å¢ƒçš„æ—¶å€™ï¼ˆ<strong>å‡½æ•°æ‰§è¡Œç»“æŸ</strong>ï¼‰å°†å…¶æ ‡è®°ä¸ºâ€œç¦»å¼€ç¯å¢ƒâ€ï¼Œåœ¨ç¦»å¼€ç¯å¢ƒä¹‹åè¿˜æœ‰çš„å˜é‡åˆ™æ˜¯éœ€è¦è¢«åˆ é™¤çš„å˜é‡ã€‚æ ‡è®°æ–¹å¼ä¸å®šï¼Œå¯ä»¥æ˜¯æŸä¸ªç‰¹æ®Šä½çš„åè½¬æˆ–ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ç­‰ã€‚</p><p>åƒåœ¾æ”¶é›†å™¨ç»™å†…å­˜ä¸­çš„æ‰€æœ‰å˜é‡éƒ½åŠ ä¸Šæ ‡è®°ï¼Œç„¶å<strong>å»æ‰ç¯å¢ƒä¸­çš„å˜é‡ä»¥åŠè¢«ç¯å¢ƒä¸­çš„å˜é‡å¼•ç”¨çš„å˜é‡çš„æ ‡è®°</strong>ã€‚åœ¨æ­¤ä¹‹åå†è¢«åŠ ä¸Šçš„æ ‡è®°çš„å˜é‡å³ä¸ºéœ€è¦å›æ”¶çš„å˜é‡ï¼Œå› ä¸ºç¯å¢ƒä¸­çš„å˜é‡å·²ç»æ— æ³•è®¿é—®åˆ°è¿™äº›å˜é‡ã€‚</p><h4 id="æ ‡è®°æ¸…é™¤-mark-and-sweep-æµç¨‹"><a href="#æ ‡è®°æ¸…é™¤-mark-and-sweep-æµç¨‹" class="headerlink" title="æ ‡è®°æ¸…é™¤ (mark and sweep)æµç¨‹"></a>æ ‡è®°æ¸…é™¤ (mark and sweep)æµç¨‹</h4><blockquote><p>ğŸ“Œå¯è¾¾æ€§ï¼šé’ˆå¯¹ä¸å¯è¾¾çš„åƒåœ¾è¿›è¡Œå›æ”¶</p></blockquote><p>æ ‡è®°æ¸…é™¤å…·ä½“gcå›æ”¶æµç¨‹ï¼š</p><ol><li>éå†å†…å­˜ä¸­æ‰€æœ‰çš„å¯¹è±¡ï¼Œå¯¹å®ƒä»¬åŠ ä¸€ä¸ªtagï¼Œæ ‡è®°ä¸º0</li><li>å¯¹windowsè¿›è¡Œé€’å½’ï¼Œæ‰¾åˆ°å¯è¾¾çš„å¯¹è±¡ï¼Œæ ‡è®°æ”¹ä¸º1</li><li>é”€æ¯æ ‡è®°ä¸º0çš„åƒåœ¾</li><li>å°†å†…å­˜é‡Œçš„å¯¹è±¡é‡æ–°æ ‡è®°ä¸º0ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡çš„gcå›æ”¶</li></ol><h4 id="æ ‡è®°æ¸…é™¤çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#æ ‡è®°æ¸…é™¤çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="æ ‡è®°æ¸…é™¤çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ"></a>æ ‡è®°æ¸…é™¤çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>mark and sweep æœ€å¤§çš„é—®é¢˜åœ¨äºä¸€æ¬¡åƒåœ¾å›æ”¶åï¼Œå†…å­˜ç©ºé—´ä¸­å‡ºç°ä¸è¿ç»­çš„æƒ…å†µã€‚è¿™ç§å†…å­˜ç¢ç‰‡ä¼šå¯¹åé¢çš„å†…å­˜åˆ†é…é€ æˆé—®é¢˜ï¼Œå› ä¸ºå¦‚æœå‡ºç°ä¸€ä¸ªå¤§å¯¹è±¡ï¼Œæ­¤æ—¶æ‰€æœ‰å†…å­˜ç©ºé—´ç¢ç‰‡æ— æ³•å®Œæˆåˆ†é…ï¼Œå°±ä¼šå­˜åœ¨å†…å­˜é€‚é…çš„å›°æ‰°ã€‚</p><hr><p><img src="/img/image_FLaLGW4fqy.png"></p><h4 id="å¦‚ä½•è§£å†³-mark-and-sweep-çš„é—®é¢˜ï¼Ÿ-æ–°å›æ”¶ç­–ç•¥mark-compact-æå‡ºæ¥äº†"><a href="#å¦‚ä½•è§£å†³-mark-and-sweep-çš„é—®é¢˜ï¼Ÿ-æ–°å›æ”¶ç­–ç•¥mark-compact-æå‡ºæ¥äº†" class="headerlink" title="å¦‚ä½•è§£å†³ mark and sweep çš„é—®é¢˜ï¼Ÿ æ–°å›æ”¶ç­–ç•¥mark-compact æå‡ºæ¥äº†"></a>å¦‚ä½•è§£å†³ mark and sweep çš„é—®é¢˜ï¼Ÿ æ–°å›æ”¶ç­–ç•¥mark-compact æå‡ºæ¥äº†</h4><p>mark-compact æ ‡è®°æ•´ç†ï¼Œåœ¨mark sweepçš„åŸºç¡€ä¸Šï¼Œæ´»ç€çš„å¯¹è±¡å¾€ä¸€ç«¯ç§»åŠ¨ï¼Œç§»åŠ¨å®Œæˆåï¼Œå†ç»ç†æ‰è¾¹ç•Œå¤–çš„å†…å­˜</p><p><img src="/img/image_7hlcAZH9WK.png"></p><h3 id="å¼•ç”¨è®¡æ•°-reference-counting"><a href="#å¼•ç”¨è®¡æ•°-reference-counting" class="headerlink" title="å¼•ç”¨è®¡æ•°(reference counting)"></a>å¼•ç”¨è®¡æ•°(reference counting)</h3><p>è¿™ç§æ–¹å¼å¸¸å¸¸ä¼šå¼•èµ·å†…å­˜æ³„æ¼ï¼Œ<strong>ä½ç‰ˆæœ¬çš„IEä½¿ç”¨è¿™ç§æ–¹å¼</strong>ã€‚æœºåˆ¶å°±æ˜¯è·Ÿè¸ªä¸€ä¸ªå€¼çš„å¼•ç”¨æ¬¡æ•°ï¼Œå½“å£°æ˜ä¸€ä¸ªå˜é‡å¹¶å°†ä¸€ä¸ªå¼•ç”¨ç±»å‹èµ‹å€¼ç»™è¯¥å˜é‡æ—¶è¯¥å€¼å¼•ç”¨æ¬¡æ•°åŠ 1ï¼Œå½“è¿™ä¸ªå˜é‡æŒ‡å‘å…¶ä»–ä¸€ä¸ªæ—¶è¯¥å€¼çš„å¼•ç”¨æ¬¡æ•°ä¾¿å‡ä¸€ã€‚å½“è¯¥å€¼å¼•ç”¨æ¬¡æ•°ä¸º0æ—¶å°±ä¼šè¢«å›æ”¶ã€‚</p><h4 id="å¼•ç”¨è®¡æ•°æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåé¢éƒ½ä¸ç”¨äº†ï¼Ÿ"><a href="#å¼•ç”¨è®¡æ•°æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåé¢éƒ½ä¸ç”¨äº†ï¼Ÿ" class="headerlink" title="å¼•ç”¨è®¡æ•°æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåé¢éƒ½ä¸ç”¨äº†ï¼Ÿ"></a>å¼•ç”¨è®¡æ•°æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåé¢éƒ½ä¸ç”¨äº†ï¼Ÿ</h4><ol><li>å¾ªç¯å¼•ç”¨å†…å­˜å°±ä¼šå‡ºç°æ³„æ¼,æ— æ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜</li><li>è®¡æ•°å™¨ä¹Ÿæ˜¯è¦å ç”¨å†…å­˜çš„</li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">let</span> A = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>  <span class="hljs-keyword">let</span> B = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();<br>  A.<span class="hljs-property">b</span> = B<br>  B.<span class="hljs-property">a</span> = A<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä¸ªäººç†è§£"><a href="#ä¸ªäººç†è§£" class="headerlink" title="ä¸ªäººç†è§£"></a>ä¸ªäººç†è§£</h3><ol><li><p>ä¸ºä»€ä¹ˆé—­åŒ…ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼Ÿ</p><p>å¦‚æœæ‰§è¡Œç¯å¢ƒå†…çš„å˜é‡è¢«å…¨å±€å˜é‡å¼•ç”¨ï¼Œè¯¥å˜é‡åœ¨å†…å­˜ä¸­åˆ™æ— æ³•é‡Šæ”¾ï¼Œå› ä¸ºå’Œå…¨å±€å˜é‡æœ‰å…³è”ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>)&#123;<br>  <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>; <span class="hljs-comment">//åˆå§‹åŒ–æ·»åŠ æ ‡è®°</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>    a++<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(a)<br>  &#125;<br>&#125;<br><span class="hljs-keyword">var</span> b = <span class="hljs-title function_">test</span>();<br><span class="hljs-title function_">b</span>();<span class="hljs-comment">//2</span><br><span class="hljs-title function_">b</span>();<span class="hljs-comment">//3</span><br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>js</category>
      
    </categories>
    
    
    <tags>
      
      <tag>mark-and-sweep</tag>
      
      <tag>reference-counting</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webpackåº•å±‚åŸç†</title>
    <link href="/2023/08/23/webpack%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/"/>
    <url>/2023/08/23/webpack%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AALoader">å¦‚ä½•ç¼–å†™ä¸€ä¸ªLoader</a><ul><li><a href="#%E5%90%8C%E6%AD%A5loader%E5%AE%9E%E7%8E%B0">åŒæ­¥loaderå®ç°</a></li><li><a href="#%E5%BC%82%E6%AD%A5loader%E5%AE%9E%E7%8E%B0">å¼‚æ­¥loaderå®ç°</a></li><li><a href="#config%E9%85%8D%E7%BD%AE%E8%87%AA%E5%AE%9A%E4%B9%89loader">configé…ç½®è‡ªå®šä¹‰loader</a></li></ul></li><li><a href="#%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAPlugin">å¦‚ä½•ç¼–å†™ä¸€ä¸ªPlugin</a></li><li><a href="#webpack-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B">webpack æ‰§è¡Œæµç¨‹</a></li></ul><h3 id="å¦‚ä½•ç¼–å†™ä¸€ä¸ªLoader"><a href="#å¦‚ä½•ç¼–å†™ä¸€ä¸ªLoader" class="headerlink" title="å¦‚ä½•ç¼–å†™ä¸€ä¸ªLoader"></a>å¦‚ä½•ç¼–å†™ä¸€ä¸ªLoader</h3><h4 id="åŒæ­¥loaderå®ç°"><a href="#åŒæ­¥loaderå®ç°" class="headerlink" title="åŒæ­¥loaderå®ç°"></a>åŒæ­¥loaderå®ç°</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> loaderUtils = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;loader-utils&quot;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">source</span>)&#123; <span class="hljs-comment">//sourceæ˜¯åŸæ–‡æœ¬</span><br>  <span class="hljs-keyword">const</span> options = loaderUtils.<span class="hljs-title function_">getOptions</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">//æ‹¿åˆ°optionå‚æ•°ï¼Œå…¶å®å°±æ˜¯this.query</span><br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(source)<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(options)<br>  <span class="hljs-keyword">return</span> source.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;1234&#x27;</span>,<span class="hljs-string">&#x27;5678&#x27;</span>) <span class="hljs-comment">//æœ€ç®€å•çš„loaderï¼Œæ–‡æœ¬æ›¿æ¢å°±å®Œäº†</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœæœ‰é”™è¯¯ä¿¡æ¯ï¼Œè¦æŠ›å‡ºå»æ€ä¹ˆè§£å†³å‘¢,è°ƒç”¨ this.callbackå³å¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">callback</span>(<span class="hljs-string">&#x27;é”™è¯¯ä¿¡æ¯&#x27;</span>,source.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;1234&#x27;</span>,<span class="hljs-string">&#x27;5678&#x27;</span>))<br></code></pre></td></tr></table></figure><h4 id="å¼‚æ­¥loaderå®ç°"><a href="#å¼‚æ­¥loaderå®ç°" class="headerlink" title="å¼‚æ­¥loaderå®ç°"></a>å¼‚æ­¥loaderå®ç°</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> loaderUtils = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;loader-utils&#x27;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params">source</span>) &#123;<br>  <span class="hljs-keyword">const</span> options = loaderUtils.<span class="hljs-title function_">getOptions</span>(<span class="hljs-variable language_">this</span>);<br>  <span class="hljs-keyword">const</span> callback = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">async</span>();<br><br>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> result = source.<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;dell&#x27;</span>, options.<span class="hljs-property">name</span>);<br>    <span class="hljs-title function_">callback</span>(<span class="hljs-literal">null</span>, result);<br>  &#125;, <span class="hljs-number">1000</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="configé…ç½®è‡ªå®šä¹‰loader"><a href="#configé…ç½®è‡ªå®šä¹‰loader" class="headerlink" title="configé…ç½®è‡ªå®šä¹‰loader"></a>configé…ç½®è‡ªå®šä¹‰loader</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">resolveLoader</span>: &#123; <span class="hljs-comment">//ä¸€å®šè¦é…ç½®è‡ªå®šä¹‰loaderç›®å½•ï¼Œä¸ç„¶è‡ªå®šä¹‰loaderå°±å¾—pathå¼•å…¥</span><br>    <span class="hljs-attr">modules</span>: [<span class="hljs-string">&#x27;node_modules&#x27;</span>, <span class="hljs-string">&#x27;./loaders&#x27;</span>]<br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [&#123;<br>      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.js/</span>,<br>      <span class="hljs-attr">use</span>: [<br>        &#123;<br>          <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;customLoader&#x27;</span>, <span class="hljs-comment">//è‡ªå®šä¹‰loaderå¼•å…¥</span><br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;2234&#x27;</span><br>          &#125;<br>        &#125;<br>      ]<br>    &#125;]<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].js&#x27;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¦‚ä½•ç¼–å†™ä¸€ä¸ªPlugin"><a href="#å¦‚ä½•ç¼–å†™ä¸€ä¸ªPlugin" class="headerlink" title="å¦‚ä½•ç¼–å†™ä¸€ä¸ªPlugin"></a>å¦‚ä½•ç¼–å†™ä¸€ä¸ªPlugin</h3><p>plugin çš„å®ç°å¯ä»¥æ˜¯ä¸€ä¸ªç±»ï¼Œä½¿ç”¨æ—¶ä¼ å…¥ç›¸å…³é…ç½®æ¥åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œç„¶åæ”¾åˆ°é…ç½®çš„ <code>plugins</code> å­—æ®µä¸­ï¼Œè€Œ plugin å®ä¾‹ä¸­æœ€é‡è¦çš„æ–¹æ³•æ˜¯ <code>apply</code>ï¼Œè¯¥æ–¹æ³•åœ¨ webpack compiler å®‰è£…æ’ä»¶æ—¶ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œ<code>apply</code> æ¥æ”¶ webpack compiler å¯¹è±¡å®ä¾‹çš„å¼•ç”¨ï¼Œä½ å¯ä»¥åœ¨ compiler å¯¹è±¡å®ä¾‹ä¸Šæ³¨å†Œå„ç§äº‹ä»¶é’©å­å‡½æ•°ï¼Œæ¥å½±å“ webpack çš„æ‰€æœ‰æ„å»ºæµç¨‹ï¼Œä»¥ä¾¿å®Œæˆæ›´å¤šå…¶ä»–çš„æ„å»ºä»»åŠ¡ã€‚</p><blockquote><p>compiler å¯¹è±¡ä»£è¡¨äº†å®Œæ•´çš„ webpack ç¯å¢ƒé…ç½®ã€‚è¿™ä¸ªå¯¹è±¡åœ¨å¯åŠ¨ webpack æ—¶è¢«ä¸€æ¬¡æ€§å»ºç«‹ï¼Œå¹¶é…ç½®å¥½æ‰€æœ‰å¯æ“ä½œçš„è®¾ç½®ï¼ŒåŒ…æ‹¬ optionsï¼Œloader å’Œ pluginã€‚å½“åœ¨ webpack ç¯å¢ƒä¸­åº”ç”¨ä¸€ä¸ªæ’ä»¶æ—¶ï¼Œæ’ä»¶å°†æ”¶åˆ°æ­¤ compiler å¯¹è±¡çš„å¼•ç”¨ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¿é—® webpack çš„ä¸»ç¯å¢ƒã€‚</p></blockquote><blockquote><p>compilation å¯¹è±¡ä»£è¡¨äº†ä¸€æ¬¡èµ„æºç‰ˆæœ¬æ„å»ºã€‚å½“è¿è¡Œ webpack å¼€å‘ç¯å¢ƒä¸­é—´ä»¶æ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å˜åŒ–ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ compilationï¼Œä»è€Œç”Ÿæˆä¸€ç»„æ–°çš„ç¼–è¯‘èµ„æºã€‚ä¸€ä¸ª compilation å¯¹è±¡è¡¨ç°äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ã€ä»¥åŠè¢«è·Ÿè¸ªä¾èµ–çš„çŠ¶æ€ä¿¡æ¯ã€‚compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šå…³é”®æ—¶æœºçš„å›è°ƒï¼Œä»¥ä¾›æ’ä»¶åšè‡ªå®šä¹‰å¤„ç†æ—¶é€‰æ‹©ä½¿ç”¨</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CopyrightWebpackPlugin</span> &#123;<br>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">options</span>)&#123;<br>    <span class="hljs-comment">//optionsæ’ä»¶ä¼ å‚</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(options)<br>  &#125;<br>  <span class="hljs-comment">//æ ¸å¿ƒæ–¹æ³•</span><br>  <span class="hljs-title function_">apply</span>(<span class="hljs-params">compiler</span>) &#123; <span class="hljs-comment">// compiler webpackå®ä¾‹</span><br>    <span class="hljs-comment">//hooks åœ¨emit é˜¶æ®µè§¦å‘</span><br>    compiler.<span class="hljs-property">hooks</span>.<span class="hljs-property">emit</span>.<span class="hljs-title function_">tapAsync</span>(<span class="hljs-string">&#x27;CopyrightWebpackPlugin&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">compilation, cb</span>) =&gt;</span> &#123;<br>      <span class="hljs-comment">//æ‰“åŒ…ç”Ÿæˆæ–°æ–‡ä»¶</span><br>      compilation.<span class="hljs-property">assets</span>[<span class="hljs-string">&#x27;copyright223.txt&#x27;</span>]= &#123;<br>        <span class="hljs-attr">source</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>          <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;copyright by sunqixiong&#x27;</span><br>        &#125;,<br>        <span class="hljs-attr">size</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>          <span class="hljs-keyword">return</span> <span class="hljs-number">21</span>;<br>        &#125;<br>      &#125;;<br>      <span class="hljs-comment">//å¼‚æ­¥æ–¹æ³•è¦æ‰§è¡Œcbè¿›è¡Œå›è°ƒ</span><br>      <span class="hljs-title function_">cb</span>();<br>    &#125;)<br>  &#125;<br><br>&#125;<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-title class_">CopyrightWebpackPlugin</span>;<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CopyRightWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./plugins/copyright-webpack-plugin&#x27;</span>); <span class="hljs-comment">//æœ¬åœ°å¼•å…¥</span><br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyRightWebpackPlugin</span>(&#123;<span class="hljs-attr">name</span>:<span class="hljs-number">1</span>&#125;) <span class="hljs-comment">//ä¼ å‚</span><br>  ],<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].js&#x27;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="webpack-æ‰§è¡Œæµç¨‹"><a href="#webpack-æ‰§è¡Œæµç¨‹" class="headerlink" title="webpack æ‰§è¡Œæµç¨‹"></a>webpack æ‰§è¡Œæµç¨‹</h3><p><img src="/img/image_t4A6GJsauX.png" alt="webpack æ‰§è¡Œè¿‡ç¨‹" title="webpack æ‰§è¡Œè¿‡ç¨‹"></p><p><code>ebpack</code>åŒ…å«ä¸¤ä¸ªå¾ˆé‡è¦çš„åŸºç¡€æ¦‚å¿µ,åˆ†åˆ«æ˜¯<code>compiler</code>å’Œ<code>compilation</code>.</p><p><code>compiler</code>æ˜¯<code>webpack</code>çš„æ”¯æŸ±å¼•æ“,å®ƒç›¸å½“äºç³»ç»Ÿä¸­æ¢,æ§åˆ¶ç€ç¨‹åºçš„æ‰§è¡Œ.</p><p>ä»£ç å¤´éƒ¨é¦–å…ˆå¼•å…¥<code>webpack</code>å’Œé…ç½®æ–‡ä»¶å‚æ•°<code>options</code>,é€šè¿‡æ‰§è¡Œ<code>webpack(options)</code>å³å¯ç”Ÿæˆ<code>compiler</code>å¯¹è±¡,å†æ‰§è¡Œå¯¹è±¡çš„<code>run</code>æ–¹æ³•å°±èƒ½å¼€å§‹å¯åŠ¨ä»£ç ç¼–è¯‘.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);<br><span class="hljs-keyword">const</span> options = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;../webpack.config.js&quot;</span>);<br><br><span class="hljs-keyword">const</span> compiler = <span class="hljs-title function_">webpack</span>(options);<br>compiler.<span class="hljs-title function_">run</span>(); <span class="hljs-comment">// å¯åŠ¨ä»£ç ç¼–è¯‘</span><br></code></pre></td></tr></table></figure><p>ä¸Šå›¾ä¸­,å½“<code>compiler</code>æ‰§è¡Œ<code>make</code>é˜¶æ®µæ—¶,æ ‡å¿—ç€ä»£ç çš„ç¼–è¯‘å·¥ä½œæ­£å¼å¼€å§‹,è¿™æ—¶å€™ä¼šåˆ›å»º<code>compilation</code>å¯¹è±¡å®Œæˆç›¸å…³ä»»åŠ¡.</p><p><code>compilation</code>ä¼šä¾æ¬¡æ‰§è¡Œç¬¬äºŒè¡Œæ ‡è®°çš„<code>3</code>ä¸ªé’©å­,ç­‰åˆ°ä»£ç çš„ç¼–è¯‘å·¥ä½œç»“æŸå,ä¸»çº¿ç¨‹åˆå›åˆ°äº†<code>compiler</code>,ç»§ç»­å¾€ä¸‹æ‰§è¡Œ<code>emit</code>é’©å­.</p><p>ç®€è€Œè¨€ä¹‹,<code>compiler</code><strong>æ‰§è¡Œåˆ°</strong>**<code>make</code><strong><strong>å’Œ</strong></strong><code>emit</code>**<strong>ä¹‹é—´æ—¶</strong>,<code>compilation</code>å¯¹è±¡ä¾¿å‡ºåœºäº†,å®ƒä¼šä¾æ¬¡æ‰§è¡Œå®ƒå®šä¹‰çš„ä¸€ç³»åˆ—é’©å­å‡½æ•°,åƒä»£ç çš„ç¼–è¯‘ã€ä¾èµ–åˆ†æã€ä¼˜åŒ–ã€å°è£…æ­£æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µå®Œæˆçš„.</p><p><code>compilation</code>å®ä¾‹ä¸»è¦è´Ÿè´£ä»£ç çš„ç¼–è¯‘å’Œæ„å»º.æ¯è¿›è¡Œä¸€æ¬¡ä»£ç çš„ç¼–è¯‘(ä¾‹å¦‚æ—¥å¸¸å¼€å‘æ—¶æŒ‰<code>ctrl + s</code>ä¿å­˜ä¿®æ”¹åçš„ä»£ç ),éƒ½ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ª<code>compilation</code>å®ä¾‹è´Ÿè´£æœ¬æ¬¡çš„æ„å»ºä»»åŠ¡.</p><p>æ•´ä½“æ‰§è¡Œæµç¨‹å·²ç»æ¢³ç†äº†ä¸€é,æ¥ä¸‹æ¥æ·±å…¥åˆ°ä¸Šå›¾ä¸­æ ‡è®°çš„æ¯ä¸€ä¸ªé’©å­å‡½æ•°,ç†è§£å…¶å¯¹åº”çš„æ—¶é—´èŠ‚ç‚¹.</p><ul><li><code>entryOption:``webpack</code>å¼€å§‹è¯»å–é…ç½®æ–‡ä»¶çš„<code>Entries</code>,é€’å½’éå†æ‰€æœ‰çš„å…¥å£æ–‡ä»¶.</li><li><code>run:</code> ç¨‹åºå³å°†è¿›å…¥æ„å»ºç¯èŠ‚</li><li><code>compile:</code> ç¨‹åºå³å°†åˆ›å»º<code>compilation</code>å®ä¾‹å¯¹è±¡</li><li><code>make:``compilation</code>å®ä¾‹å¯åŠ¨å¯¹ä»£ç çš„ç¼–è¯‘å’Œæ„å»º</li><li><code>emit:</code> æ‰€æœ‰æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶å†…å®¹å·²ç»åœ¨å†…å­˜ä¸­æŒ‰ç…§ç›¸åº”çš„æ•°æ®ç»“æ„å¤„ç†å®Œæ¯•,ä¸‹ä¸€æ­¥ä¼šå°†æ–‡ä»¶å†…å®¹è¾“å‡ºåˆ°æ–‡ä»¶ç³»ç»Ÿ,<code>emit</code>é’©å­ä¼šåœ¨ç”Ÿæˆæ–‡ä»¶ä¹‹å‰æ‰§è¡Œ(é€šå¸¸æƒ³æ“ä½œæ‰“åŒ…åçš„æ–‡ä»¶å¯ä»¥åœ¨<code>emit</code>é˜¶æ®µç¼–å†™<code>plugin</code>å®ç°).</li><li><code>done:</code> ç¼–è¯‘åçš„æ–‡ä»¶å·²ç»è¾“å‡ºåˆ°ç›®æ ‡ç›®å½•,æ•´ä½“ä»£ç çš„æ„å»ºå·¥ä½œç»“æŸæ—¶è§¦å‘</li></ul><p><code>compilation</code>ä¸‹çš„é’©å­å«ä¹‰å¦‚ä¸‹.</p><ul><li><code>buildModule:</code> åœ¨æ¨¡å—æ„å»ºå¼€å§‹ä¹‹å‰è§¦å‘,è¿™ä¸ªé’©å­ä¸‹å¯ä»¥ç”¨æ¥ä¿®æ”¹æ¨¡å—çš„å‚æ•°</li><li><code>seal:</code> æ„å»ºå·¥ä½œå®Œæˆäº†,<code>compilation</code>å¯¹è±¡åœæ­¢æ¥æ”¶æ–°çš„æ¨¡å—æ—¶è§¦å‘</li><li><code>optimize:</code> ä¼˜åŒ–é˜¶æ®µå¼€å§‹æ—¶è§¦å‘</li></ul><p><code>compiler</code>è¿›å…¥<code>make</code>é˜¶æ®µå,<code>compilation</code>å®ä¾‹è¢«åˆ›å»ºå‡ºæ¥,å®ƒä¼šå…ˆè§¦å‘<code>buildModule</code>é˜¶æ®µå®šä¹‰çš„é’©å­,æ­¤æ—¶<code>compilation</code>å®ä¾‹ä¾æ¬¡è¿›å…¥æ¯ä¸€ä¸ªå…¥å£æ–‡ä»¶(<code>entry</code>),åŠ è½½ç›¸åº”çš„<code>loader</code>å¯¹ä»£ç ç¼–è¯‘.</p><p>ä»£ç ç¼–è¯‘å®Œæˆå,å†å°†ç¼–è¯‘å¥½çš„æ–‡ä»¶å†…å®¹è°ƒç”¨ <code>acorn</code> è§£æç”Ÿæˆ<code>AST</code>è¯­æ³•æ ‘,æŒ‰ç…§æ­¤æ–¹æ³•ç»§ç»­é€’å½’ã€é‡å¤æ‰§è¡Œè¯¥è¿‡ç¨‹.</p><p>æ‰€æœ‰æ¨¡å—å’Œå’Œä¾èµ–åˆ†æå®Œæˆå,<code>compilation</code>è¿›å…¥<code>seal</code> é˜¶æ®µ,å¯¹æ¯ä¸ª<code>chunk</code>è¿›è¡Œæ•´ç†,æ¥ä¸‹æ¥è¿›å…¥<code>optimize</code>é˜¶æ®µ,å¼€å¯ä»£ç çš„ä¼˜åŒ–å’Œå°è£….</p><p><a href="https://zhuanlan.zhihu.com/p/400015634">https://zhuanlan.zhihu.com/p/400015634</a></p>]]></content>
    
    
    <categories>
      
      <category>webpack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webpack é«˜çº§æ¦‚å¿µ</title>
    <link href="/2023/08/22/webpack%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5/"/>
    <url>/2023/08/22/webpack%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#Tree-shaking-">Tree shaking </a></li><li><a href="#%E6%B5%8B%E8%AF%95%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8C%85%E6%A8%A1%E5%BC%8F%E5%8C%BA%E5%88%86">æµ‹è¯•ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…æ¨¡å¼åŒºåˆ†</a></li><li><a href="#code-spliting">code spliting</a></li><li><a href="#%E6%87%92%E5%8A%A0%E8%BD%BD%E9%A2%84%E5%8A%A0%E8%BD%BD">æ‡’åŠ è½½ã€é¢„åŠ è½½</a></li><li><a href="#Caching%E7%BC%93%E5%AD%98">Cachingç¼“å­˜</a></li><li><a href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">ç¯å¢ƒå˜é‡</a></li></ul><h3 id="Tree-shaking-x20"><a href="#Tree-shaking-x20" class="headerlink" title="Tree shaking&#x20;"></a>Tree shaking&#x20;</h3><p>ä½œç”¨ï¼šæ¶ˆé™¤æ— ç”¨ä»£ç </p><p>åœ¨ webpack é¡¹ç›®ä¸­ï¼Œæœ‰ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œç›¸å½“äºä¸€æ£µæ ‘çš„ä¸»å¹²ï¼Œå…¥å£æ–‡ä»¶æœ‰å¾ˆå¤šä¾èµ–çš„æ¨¡å—ï¼Œç›¸å½“äºæ ‘æã€‚å®é™…æƒ…å†µä¸­ï¼Œè™½ç„¶ä¾èµ–äº†æŸä¸ªæ¨¡å—ï¼Œä½†å…¶å®åªä½¿ç”¨å…¶ä¸­çš„æŸäº›åŠŸèƒ½ã€‚é€šè¿‡ Tree-Shakingï¼Œå°†æ²¡æœ‰ä½¿ç”¨çš„æ¨¡å—æ‘‡æ‰ï¼Œè¿™æ ·æ¥è¾¾åˆ°åˆ é™¤æ— ç”¨ä»£ç çš„ç›®çš„ã€‚</p><p>é…ç½®æ–¹æ³•ï¼š</p><p>modeï¼šproduction æ‰“åŒ…æ¨¡å¼æ—¶é»˜è®¤ä½¿ç”¨ï¼Œmodeï¼šdevelopmentæ—¶é»˜è®¤ä¸é…ç½®</p><h3 id="æµ‹è¯•ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…æ¨¡å¼åŒºåˆ†"><a href="#æµ‹è¯•ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…æ¨¡å¼åŒºåˆ†" class="headerlink" title="æµ‹è¯•ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…æ¨¡å¼åŒºåˆ†"></a>æµ‹è¯•ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…æ¨¡å¼åŒºåˆ†</h3><p>è¿™ä¸ªå¾ˆå¸¸è§ï¼Œä¸»è¦é€šè¿‡æ‰“åŒ…å‘½ä»¤æ¥æŒ‡å®šä¸åŒçš„è¿è¡Œç¯å¢ƒæˆ–é…ç½®æ–‡ä»¶ï¼Œä¸¾ä¸€ä¸ªå¸¸è§çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">package.json<br><span class="hljs-string">&quot;dev&quot;</span>: <span class="hljs-string">&quot;webpack-dev-server --config ./build/webpack.common.js&quot;</span>,<br><span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack --env.production --config ./build/webpack.common.js&quot;</span><br><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">HtmlWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> <span class="hljs-title class_">CleanWebpackPlugin</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>);<br><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack&#x27;</span>);<br><span class="hljs-keyword">const</span> merge = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;webpack-merge&#x27;</span>);<br><span class="hljs-keyword">const</span> devConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.dev.js&#x27;</span>);<br><span class="hljs-keyword">const</span> prodConfig = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./webpack.prod.js&#x27;</span>);<br><span class="hljs-keyword">const</span> commonConfig = &#123;<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span>,<br>  &#125;,<br>  ....<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;../dist&#x27;</span>)<br>  &#125;<br>&#125;<br><span class="hljs-comment">//é€šè¿‡æ¨¡å¼åˆ¤æ–­åˆå¹¶ä¸åŒçš„é…ç½®ï¼Œå®Œæˆä¸åŒçš„æ‰“åŒ…æ•ˆæœ</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = <span class="hljs-function">(<span class="hljs-params">env</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">if</span>(env &amp;&amp; env.<span class="hljs-property">production</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(commonConfig, prodConfig);<br>  &#125;<span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">merge</span>(commonConfig, devConfig);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="code-spliting"><a href="#code-spliting" class="headerlink" title="code spliting"></a>code spliting</h3><p>ä»£ç åˆ†å‰²ï¼Œç›¸æ¯”äºå…¥å£æ–‡ä»¶é…ç½®çš„ä»£ç åˆ†å‰²ï¼ŒsplitChunksæ›´å…·ç­–ç•¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> commonConfig = &#123;<br>  ...<br>  <span class="hljs-attr">optimization</span>: &#123;<br>    <span class="hljs-attr">runtimeChunk</span>: &#123;<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;runtime&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">usedExports</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">splitChunks</span>: &#123;<br>      <span class="hljs-comment">// è‡ªåŠ¨æå–æ‰€æœ‰å…¬å…±æ¨¡å—åˆ°å•ç‹¬ bundle</span><br>      <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span>,<br>      <span class="hljs-attr">cacheGroups</span>: &#123;<br>        <span class="hljs-comment">// vendorsè¿™ä¸ªé”®åå³æ˜¯æ‰“å®ŒåŒ…çš„å‰ç¼€å</span><br>        <span class="hljs-comment">//å±æ€§åå¯ä»¥è‡ªå·±å–ï¼Œåªè¦ä¸è·Ÿç¼“å­˜ç»„ä¸‹å…¶ä»–å®šä¹‰è¿‡çš„å±æ€§åŒåå°±è¡Œï¼Œå¦åˆ™åé¢çš„æ‹†åˆ†è§„åˆ™ä¼šæŠŠå‰é¢çš„é…ç½®è¦†ç›–æ‰</span><br>        <span class="hljs-attr">vendors</span>: &#123;<br>          <span class="hljs-comment">//testå³ä¸ºæµ‹è¯•æ­£åˆ™ï¼Œå½“å¼•ç”¨çš„æ¨¡å—åæ»¡è¶³äº†è¿™ä¸ªæµ‹è¯•æ­£åˆ™åï¼Œæ‰ä¼šæŒ‰ç…§å½“å‰å¯¹è±¡çš„è§„åˆ™æ‰“åŒ…</span><br>          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,<br>          <span class="hljs-attr">priority</span>: -<span class="hljs-number">10</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;vendors&#x27;</span>,<br>        &#125;,<br>        <span class="hljs-attr">default</span>: &#123;<br>          <span class="hljs-attr">minChunks</span>:<span class="hljs-number">2</span>, <span class="hljs-comment">//æ¨¡å—æœ€å°‘å¼•ç”¨æ•°</span><br>          <span class="hljs-attr">priority</span>: -<span class="hljs-number">20</span>,<br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;,<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><p>**- chunks  **</p><p>initialã€asyncã€allåˆ†åˆ«è¡¨ç¤ºé™æ€å¼•å…¥ã€åŠ¨æ€å¼•å…¥å’Œä¸¤ç§æƒ…å†µä¸‹æ¥è¿›è¡Œä»£ç åˆ†å‰²ã€‚</p><p><strong>- priority</strong> &#x20;</p><p>priorityå±æ€§çš„å€¼ä¸ºæ•°å­—ï¼Œå¯ä»¥ä¸ºè´Ÿæ•°ã€‚ä½œç”¨æ˜¯å½“ç¼“å­˜ç»„ä¸­è®¾ç½®æœ‰å¤šä¸ªæ‹†åˆ†è§„åˆ™ï¼Œè€ŒæŸä¸ªæ¨¡å—åŒæ—¶ç¬¦åˆå¥½å‡ ä¸ªè§„åˆ™çš„æ—¶å€™ï¼Œåˆ™éœ€è¦é€šè¿‡ä¼˜å…ˆçº§å±æ€§priorityæ¥å†³å®šä½¿ç”¨å“ªä¸ªæ‹†åˆ†è§„åˆ™ã€‚ä¼˜å…ˆçº§é«˜è€…æ‰§è¡Œã€‚æˆ‘è¿™é‡Œç»™ä¸šåŠ¡ä»£ç ç»„è®¾ç½®çš„ä¼˜å…ˆçº§ä¸º-20ï¼Œç»™ç¬¬ä¸‰æ–¹åº“ç»„è®¾ç½®çš„ä¼˜å…ˆçº§ä¸º-10ï¼Œè¿™æ ·å½“ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“è¢«å¼•ç”¨è¶…è¿‡2æ¬¡çš„æ—¶å€™ï¼Œå°±ä¸ä¼šæ‰“åŒ…åˆ°ä¸šåŠ¡æ¨¡å—é‡Œäº†ã€‚</p><p><strong>- minChunks</strong> &#x20;<br>å°±æ˜¯åœ¨entryä¸­é…ç½®çš„å…¥å£ï¼Œå¼•ç”¨äº†è¯¥æ¨¡å—çš„æœ€å°‘ä¸ªæ•°ï¼Œåªæœ‰æ»¡è¶³äº†æœ€å°‘æœ‰minChunksä¸ªchunkå¼•ç”¨äº†å½“å‰æ¨¡å—ï¼Œæ‰ä¼šè¿›è¡Œå•ç‹¬æ‰“åŒ…</p><h3 id="æ‡’åŠ è½½ã€é¢„åŠ è½½"><a href="#æ‡’åŠ è½½ã€é¢„åŠ è½½" class="headerlink" title="æ‡’åŠ è½½ã€é¢„åŠ è½½"></a>æ‡’åŠ è½½ã€é¢„åŠ è½½</h3><p>äº‹å®ä¸Šæ‡’åŠ è½½ä¸æ˜¯webpackçš„åŠŸèƒ½ï¼Œå®ƒæ˜¯es6çš„æ¨¡å—åŠŸèƒ½</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">//æ‡’åŠ è½½</span><br><span class="hljs-keyword">import</span>(<span class="hljs-comment">/*webpackChunkName:&#x27;test&#x27; */</span><span class="hljs-string">&quot;./test&quot;</span>)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123;test&#125;</span>) =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;teståŠ è½½æˆåŠŸ&#x27;</span>)<br>      <span class="hljs-title function_">test</span>()<br>  &#125;)<br>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;teståŠ è½½å¤±è´¥ error:&#x27;</span>, error)<br>  &#125;)<br><span class="hljs-comment">//é¢„åŠ è½½</span><br><span class="hljs-keyword">import</span>(<span class="hljs-comment">/*webpackChunkName:&#x27;test&#x27; ,webpackPrefetch:true*/</span><span class="hljs-string">&quot;./test&quot;</span>)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">&#123;test&#125;</span>) =&gt;</span> &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;teståŠ è½½æˆåŠŸ&#x27;</span>)<br>      <span class="hljs-title function_">test</span>()<br>  &#125;)<br><br></code></pre></td></tr></table></figure><h3 id="Cachingç¼“å­˜"><a href="#Cachingç¼“å­˜" class="headerlink" title="Cachingç¼“å­˜"></a>Cachingç¼“å­˜</h3><p><em><strong>ä¸ºä»€ä¹ˆéœ€è¦hashï¼Ÿ</strong></em></p><p>æµè§ˆå™¨ä¼šç¼“å­˜æˆ‘ä»¬çš„æ–‡ä»¶ã€‚</p><p>ä¼˜ç‚¹æ˜¯æµè§ˆå™¨è¯»å–ç¼“å­˜çš„æ–‡ä»¶ï¼Œèƒ½å¸¦æ¥æ›´ä½³çš„ç”¨æˆ·ä½“éªŒï¼ˆä¸éœ€è¦é¢å¤–æµé‡ï¼Œé€Ÿåº¦æ›´å¿«ï¼‰ï¼›</p><p>ç¼ºç‚¹æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬ä¿®æ”¹äº†æ–‡ä»¶å†…å®¹ï¼Œä½†æ˜¯æµè§ˆå™¨ä¾ç„¶è¯»å–ç¼“å­˜çš„æ–‡ä»¶ï¼ˆä¹Ÿå°±æ˜¯æ—§æ–‡ä»¶ï¼‰ï¼Œå¯¼è‡´ç”¨æˆ·çœ‹åˆ°çš„æ–‡ä»¶ä¸æ˜¯æœ€æ–°çš„ã€‚</p><p>è§£å†³æ–¹æ³•ï¼šæ–‡ä»¶å°¾åŠ å“ˆå¸Œï¼Œé˜²æ­¢æ–‡ä»¶æ›´æ–°åç¼“å­˜ä¸åˆ·æ–°ã€‚æ–‡ä»¶å†…å®¹ä¸å˜åŒ–ï¼Œå“ˆå¸Œä¸ä¼šå˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].[contenthash].js&#x27;</span>,<br>    <span class="hljs-attr">chunkFilename</span>: <span class="hljs-string">&#x27;[name].[contenthash].js&#x27;</span><br>  &#125;<br></code></pre></td></tr></table></figure><h3 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h3><p>åœ¨æ‰“åŒ…å‘½ä»¤é‡Œå¯ä»¥é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">package.json<br><span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack --env.production --config ./build/webpack.common.js&quot;</span><br><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">const path = require(<span class="hljs-string">&#x27;path&#x27;</span>);<br>const HtmlWebpackPlugin = require(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>);<br>const CleanWebpackPlugin = require(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>);<br>const webpack = require(<span class="hljs-string">&#x27;webpack&#x27;</span>);<br>const merge = require(<span class="hljs-string">&#x27;webpack-merge&#x27;</span>);<br>const devConfig = require(<span class="hljs-string">&#x27;./webpack.dev.js&#x27;</span>);<br>const prodConfig = require(<span class="hljs-string">&#x27;./webpack.prod.js&#x27;</span>);<br>const commonConfig = &#123;<br>...<br>&#125;<br>//ç¯å¢ƒå˜é‡<br>module.exports = (<span class="hljs-built_in">env</span>) =&gt; &#123;<br>  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">env</span> &amp;&amp; env.production) &#123;<br>    <span class="hljs-built_in">return</span> merge(commonConfig, prodConfig);<br>  &#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-built_in">return</span> merge(commonConfig, devConfig);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡æ‰“åŒ…æ¨¡å¼åŒºåˆ†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">&#x27;production&#x27;</span>) &#123;<br>  console.log(<span class="hljs-string">&#x27;ä½ æ­£åœ¨çº¿ä¸Šç¯å¢ƒ&#x27;</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>  console.log(<span class="hljs-string">&#x27;ä½ æ­£åœ¨ä½¿ç”¨å¼€å‘ç¯å¢ƒ&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>webpack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>webpack åŸºç¡€é…ç½®</title>
    <link href="/2023/08/21/webpack%20%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/"/>
    <url>/2023/08/21/webpack%20%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#webpack-%E5%AE%89%E8%A3%85">webpack å®‰è£…</a></li><li><a href="#webpack-cli-%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%89%93%E5%8C%85">webpack-cli å‘½ä»¤è¡Œæ‰“åŒ…</a></li><li><a href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BF%AE%E6%94%B9%E6%89%93%E5%8C%85%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%9B%AE%E5%BD%95">å‘½ä»¤è¡Œä¿®æ”¹æ‰“åŒ…è¾“å…¥è¾“å‡ºç›®å½•</a></li><li><a href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BD%BF%E7%94%A8babel-es6%E8%BD%ACes5">å‘½ä»¤è¡Œä½¿ç”¨babel es6è½¬es5</a></li><li><a href="#Webpack-%E5%B8%B8%E8%A7%81%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A">Webpack å¸¸è§åè¯è§£é‡Š</a></li><li><a href="#webpack%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">webpacké…ç½®æ–‡ä»¶</a></li><li><a href="#mode-%E6%A8%A1%E5%BC%8F">mode æ¨¡å¼</a></li><li><a href="#entry%E5%85%A5%E5%8F%A3">entryå…¥å£</a><ul><li><a href="#%E5%A4%9A%E6%96%87%E4%BB%B6%E5%85%A5%E5%8F%A3">å¤šæ–‡ä»¶å…¥å£</a></li></ul></li><li><a href="#output-%E8%BE%93%E5%87%BA">output è¾“å‡º</a></li><li><a href="#Loader">Loader</a><ul><li><a href="#file-loader">file-loader</a></li><li><a href="#url-loader">url-loader</a></li><li><a href="#style-loader">style-loader</a></li><li><a href="#css-loader">css-loader</a></li></ul></li><li><a href="#Plugins">Plugins</a><ul><li><a href="#HtmlWebpackPlugin">HtmlWebpackPlugin</a></li><li><a href="#CleanWebpackPlugin">CleanWebpackPlugin</a></li></ul></li><li><a href="#devServer">devServer</a></li><li><a href="#%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%BF%E6%8D%A2-HMR">æ¨¡å—çƒ­æ›¿æ¢ HMR</a></li><li><a href="#Babel-es6%E8%BD%ACes5">Babel es6è½¬es5</a></li></ul><h3 id="webpack-å®‰è£…"><a href="#webpack-å®‰è£…" class="headerlink" title="webpack å®‰è£…"></a>webpack å®‰è£…</h3><p><code>npm install webpack webpack-cli --save-dev</code></p><p>åˆ›å»ºç›®å½•å¹¶ä¸”è¿›å…¥</p><p><code>mkdir zero-config &amp;&amp; cd $_</code>åˆå§‹åŒ–</p><p><code>npm init -y</code> å¿«é€Ÿç”Ÿæˆpackage.json</p><p>å®‰è£… webpack å’Œ webpack-cliåˆ°å¼€å‘ä¾èµ–</p><p><code>npm i webpack --save-dev </code></p><p><code>npm i webpack-cli --save-dev</code></p><h3 id="webpack-cli-å‘½ä»¤è¡Œæ‰“åŒ…"><a href="#webpack-cli-å‘½ä»¤è¡Œæ‰“åŒ…" class="headerlink" title="webpack-cli å‘½ä»¤è¡Œæ‰“åŒ…"></a>webpack-cli å‘½ä»¤è¡Œæ‰“åŒ…</h3><p>Webpack é»˜è®¤çš„å…¥å£æ–‡ä»¶æ˜¯src&#x2F;index.jsï¼›</p><p>Webpack çš„é»˜è®¤è¾“å‡ºç›®å½•æ˜¯dist&#x2F;main.jsã€‚ &#x20;<br>--mode development&#x2F;production é…ç½®æ‰“åŒ…æµ‹è¯•&#x2F;ç”Ÿäº§ç‰ˆæœ¬</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;zero-config&quot;</span>,<br>  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,<br>  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;index.js&quot;</span>,<br>  <span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;dev&quot;</span>: <span class="hljs-string">&quot;webpack --mode development&quot;</span>,<br>    <span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack --mode production&quot;</span><br>  &#125;,<br>  <span class="hljs-string">&quot;keywords&quot;</span>: [],<br>  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-string">&quot;license&quot;</span>: <span class="hljs-string">&quot;ISC&quot;</span>,<br>  <span class="hljs-string">&quot;devDependencies&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;webpack&quot;</span>: <span class="hljs-string">&quot;^4.43.0&quot;</span>,<br>    <span class="hljs-string">&quot;webpack-cli&quot;</span>: <span class="hljs-string">&quot;^3.3.11&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å‘½ä»¤è¡Œä¿®æ”¹æ‰“åŒ…è¾“å…¥è¾“å‡ºç›®å½•"><a href="#å‘½ä»¤è¡Œä¿®æ”¹æ‰“åŒ…è¾“å…¥è¾“å‡ºç›®å½•" class="headerlink" title="å‘½ä»¤è¡Œä¿®æ”¹æ‰“åŒ…è¾“å…¥è¾“å‡ºç›®å½•"></a>å‘½ä»¤è¡Œä¿®æ”¹æ‰“åŒ…è¾“å…¥è¾“å‡ºç›®å½•</h3><p>æˆ‘ä»¬å¦‚æœè¦ä¿®æ”¹ Webpack çš„é»˜è®¤è¾“å‡ºç›®å½•ï¼Œéœ€è¦ç”¨åˆ° Webpack å‘½ä»¤çš„â€“outputï¼Œ è¾“å…¥æ˜¯ â€“entry æˆ‘ä»¬å°†ä¸Šé¢çš„ npm scripts åšä¸‹ä¿®æ”¹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>  <span class="hljs-string">&quot;dev&quot;</span>: <span class="hljs-string">&quot;webpack --mode development --entry ./src/app.js --output ./output/main.js&quot;</span>,<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å‘½ä»¤è¡Œä½¿ç”¨babel-es6è½¬es5"><a href="#å‘½ä»¤è¡Œä½¿ç”¨babel-es6è½¬es5" class="headerlink" title="å‘½ä»¤è¡Œä½¿ç”¨babel es6è½¬es5"></a>å‘½ä»¤è¡Œä½¿ç”¨babel es6è½¬es5</h3><p><code>npm i @babel/core babel-loader @babel/preset-env --save-dev</code></p><p>åˆ›å»º.babelrc</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>  <span class="hljs-string">&quot;presets&quot;</span>: [<span class="hljs-string">&quot;@babel/preset-env&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure><p>package.jsonä¿®æ”¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-string">&quot;scripts&quot;</span>: &#123;<br>  <span class="hljs-string">&quot;build&quot;</span>: <span class="hljs-string">&quot;webpack --mode production ./src/es/index.js --module-bind js=babel-loader&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Webpack-å¸¸è§åè¯è§£é‡Š"><a href="#Webpack-å¸¸è§åè¯è§£é‡Š" class="headerlink" title="Webpack å¸¸è§åè¯è§£é‡Š"></a>Webpack å¸¸è§åè¯è§£é‡Š</h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>å‚æ•°</td><td>è¯´æ˜</td></tr><tr><td>entry</td><td>é¡¹ç›®å…¥å£</td></tr><tr><td>output</td><td>æ‰“åŒ…æ–‡ä»¶è¾“å‡º</td></tr><tr><td>module</td><td>å¼€å‘ä¸­æ¯ä¸€ä¸ªæ–‡ä»¶éƒ½å¯ä»¥çœ‹åš moduleï¼Œæ¨¡å—ä¸å±€é™äº jsï¼Œä¹ŸåŒ…å« cssã€å›¾ç‰‡ç­‰</td></tr><tr><td>chunk</td><td>ä»£ç å—ï¼Œä¸€ä¸ª chunk å¯ä»¥ç”±å¤šä¸ªæ¨¡å—ç»„æˆ</td></tr><tr><td>loader</td><td>æ¨¡å—è½¬åŒ–å™¨ï¼Œæ¨¡å—çš„å¤„ç†å™¨ï¼Œå¯¹æ¨¡å—è¿›è¡Œè½¬æ¢å¤„ç†</td></tr><tr><td>plugin</td><td>æ‰©å±•æ’ä»¶ï¼Œæ’ä»¶å¯ä»¥å¤„ç† chunkï¼Œä¹Ÿå¯ä»¥å¯¹æœ€åçš„æ‰“åŒ…ç»“æœè¿›è¡Œå¤„ç†ï¼Œå¯ä»¥å®Œæˆ loader å®Œä¸æˆçš„ä»»åŠ¡</td></tr><tr><td>bundle</td><td>æœ€ç»ˆæ‰“åŒ…å®Œæˆçš„æ–‡ä»¶ï¼Œä¸€èˆ¬å°±æ˜¯å’Œ chunk ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œbundle å°±æ˜¯å¯¹ chunk è¿›è¡Œä¾¿æ„å‹ç¼©æ‰“åŒ…ç­‰å¤„ç†åçš„äº§å‡º</td></tr><tr><td>devtool</td><td>source-mapé…ç½®ï¼Œé»˜è®¤åœ¨modeæ˜¯developmentçš„æ—¶å€™æ˜¯å¼€ç€çš„ï¼Œå°±èƒ½ç›´æ¥é“¾åˆ°æºä»£ç ï¼Œproductionå°±æ²¡æœ‰</td></tr></tbody></table><h3 id="webpacké…ç½®æ–‡ä»¶"><a href="#webpacké…ç½®æ–‡ä»¶" class="headerlink" title="webpacké…ç½®æ–‡ä»¶"></a>webpacké…ç½®æ–‡ä»¶</h3><p>webpacké»˜è®¤é…ç½®æ–‡ä»¶ä¸º webpack.config.js, å¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œ â€”configæŒ‡å®šé…ç½®æ–‡ä»¶</p><p><code>npx webpack --config webpack.config.entry.js --mode development</code></p><h3 id="mode-æ¨¡å¼"><a href="#mode-æ¨¡å¼" class="headerlink" title="mode æ¨¡å¼"></a>mode æ¨¡å¼</h3><p>Webpack4.0 å¼€å§‹å¼•å…¥äº†modeé…ç½®ï¼Œé€šè¿‡é…ç½®mode&#x3D;developmentæˆ–è€…mode&#x3D;productionæ¥åˆ¶å®šæ˜¯å¼€å‘ç¯å¢ƒæ‰“åŒ…ï¼Œè¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ï¼Œæ¯”å¦‚ç”Ÿäº§ç¯å¢ƒä»£ç éœ€è¦å‹ç¼©ï¼Œå›¾ç‰‡éœ€è¦ä¼˜åŒ–ï¼ŒWebpack é»˜è®¤modeæ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œå³mode&#x3D;production</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span><br>&#125;;<br></code></pre></td></tr></table></figure><p>è¿˜å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½®modeï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">npx webpack --config webpack.<span class="hljs-property">config</span>.<span class="hljs-property">entry</span>.<span class="hljs-property">js</span> --mode development<br></code></pre></td></tr></table></figure><h3 id="entryå…¥å£"><a href="#entryå…¥å£" class="headerlink" title="entryå…¥å£"></a>entryå…¥å£</h3><p>å•æ–‡ä»¶çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;path/to/my/entry/file.js&#x27;</span><br>&#125;;<br><span class="hljs-comment">// æˆ–è€…ä½¿ç”¨å¯¹è±¡æ–¹å¼</span><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;path/to/my/entry/file.js&#x27;</span><br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>entryè¿˜å¯ä»¥ä¼ å…¥åŒ…å«æ–‡ä»¶è·¯å¾„çš„æ•°ç»„ï¼Œå½“entryä¸ºæ•°ç»„çš„æ—¶å€™ä¹Ÿä¼šåˆå¹¶è¾“å‡ºï¼Œä¾‹å¦‚ä¸‹é¢çš„é…ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: [<span class="hljs-string">&#x27;./src/app.js&#x27;</span>, <span class="hljs-string">&#x27;./src/home.js&#x27;</span>],<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;array.js&#x27;</span><br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><h4 id="å¤šæ–‡ä»¶å…¥å£"><a href="#å¤šæ–‡ä»¶å…¥å£" class="headerlink" title="å¤šæ–‡ä»¶å…¥å£"></a>å¤šæ–‡ä»¶å…¥å£</h4><p>å¤šæ–‡ä»¶å…¥å£æ˜¯ä½¿ç”¨å¯¹è±¡è¯­æ³•æ¥é€šè¿‡æ”¯æŒå¤šä¸ªentryï¼Œå¤šæ–‡ä»¶å…¥å£çš„å¯¹è±¡è¯­æ³•ç›¸å¯¹äºå•æ–‡ä»¶å…¥å£ï¼Œå…·æœ‰è¾ƒé«˜çš„çµæ´»æ€§ï¼Œä¾‹å¦‚å¤šé¡µåº”ç”¨ã€é¡µé¢æ¨¡å—åˆ†ç¦»ä¼˜åŒ–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">home</span>: <span class="hljs-string">&#x27;path/to/my/entry/home.js&#x27;</span>,<br>    <span class="hljs-attr">search</span>: <span class="hljs-string">&#x27;path/to/my/entry/search.js&#x27;</span>,<br>    <span class="hljs-attr">list</span>: <span class="hljs-string">&#x27;path/to/my/entry/list.js&#x27;</span><br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¯­æ³•å°†entryåˆ†æˆäº† 3 ä¸ªç‹¬ç«‹çš„å…¥å£æ–‡ä»¶ï¼Œè¿™æ ·ä¼šæ‰“åŒ…å‡ºæ¥ä¸‰ä¸ªå¯¹åº”çš„ bundle. &#x20;<br>å¯¹äºä¸€ä¸ª HTML é¡µé¢ï¼Œæˆ‘ä»¬æ¨èåªæœ‰ä¸€ä¸ª entry ï¼Œé€šè¿‡ç»Ÿä¸€çš„å…¥å£ï¼Œè§£æå‡ºæ¥çš„ä¾èµ–å…³ç³»æ›´æ–¹ä¾¿ç®¡ç†å’Œç»´æŠ¤</p><h3 id="output-è¾“å‡º"><a href="#output-è¾“å‡º" class="headerlink" title="output è¾“å‡º"></a>output è¾“å‡º</h3><p>webpack çš„outputæ˜¯æŒ‡å®šäº†entryå¯¹åº”æ–‡ä»¶ç¼–è¯‘æ‰“åŒ…åçš„è¾“å‡º bundleã€‚outputçš„å¸¸ç”¨å±æ€§æ˜¯ï¼š</p><ul><li>pathï¼šæ­¤é€‰é¡¹åˆ¶å®šäº†è¾“å‡ºçš„ bundle å­˜æ”¾çš„è·¯å¾„ï¼Œæ¯”å¦‚distã€outputç­‰,pathè·¯å¾„å¯æ”¹&#x20;<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname , <span class="hljs-string">&#x27;dist&#x27;</span>)<br></code></pre></td></tr></table></figure></li><li>filenameï¼šè¿™ä¸ªæ˜¯ bundle çš„åç§°</li><li>publicPathï¼šæŒ‡å®šäº†ä¸€ä¸ªåœ¨æµè§ˆå™¨ä¸­è¢«å¼•ç”¨çš„ URL åœ°å€</li></ul><p>å½“ä¸æŒ‡å®š output çš„æ—¶å€™ï¼Œé»˜è®¤è¾“å‡ºåˆ° dist&#x2F;main.js</p><p><strong>ä¸€ä¸ª webpack çš„é…ç½®ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªentryï¼Œä½†æ˜¯åªèƒ½æœ‰ä¸€ä¸ªoutputã€‚å¯¹äºä¸åŒçš„entryå¯ä»¥é€šè¿‡output.filenameå ä½ç¬¦è¯­æ³•æ¥åŒºåˆ†</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);<br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">home</span>: <span class="hljs-string">&#x27;path/to/my/entry/home.js&#x27;</span>,<br>    <span class="hljs-attr">search</span>: <span class="hljs-string">&#x27;path/to/my/entry/search.js&#x27;</span>,<br>    <span class="hljs-attr">list</span>: <span class="hljs-string">&#x27;path/to/my/entry/list.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].js&#x27;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname , <span class="hljs-string">&#x27;dist&#x27;</span>)<br>  &#125;<br>&#125;;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­[name]å°±æ˜¯å ä½ç¬¦ï¼Œå®ƒå¯¹åº”çš„æ˜¯entryçš„keyï¼ˆhomeã€searchã€listï¼‰ï¼Œæ‰€ä»¥æœ€ç»ˆè¾“å‡ºç»“æœæ˜¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs çº¯æ–‡æœ¬">path/to/my/entry/home.js â†’ dist/home.js<br>path/to/my/entry/search.js â†’ dist/search.js<br>path/to/my/entry/list.js â†’ dist/list.js<br></code></pre></td></tr></table></figure><p>Webpack ç›®å‰æ”¯æŒçš„å ä½ç¬¦</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>å ä½ç¬¦</td><td>å«ä¹‰</td></tr><tr><td>[hash]</td><td>æ¨¡å—æ ‡è¯†ç¬¦çš„ hash</td></tr><tr><td>[chunkhash]</td><td>chunk å†…å®¹çš„ hash</td></tr><tr><td>[name]</td><td>æ¨¡å—åç§°</td></tr><tr><td>[id]</td><td>æ¨¡å—æ ‡è¯†ç¬¦</td></tr><tr><td>[query]</td><td>æ¨¡å—çš„ queryï¼Œä¾‹å¦‚ï¼Œæ–‡ä»¶å ? åé¢çš„å­—ç¬¦ä¸²</td></tr></tbody></table><ul><li>[hash]ï¼šæ˜¯æ•´ä¸ªé¡¹ç›®çš„ hash å€¼ï¼Œå…¶æ ¹æ®æ¯æ¬¡ç¼–è¯‘å†…å®¹è®¡ç®—å¾—åˆ°ï¼Œæ¯æ¬¡ç¼–è¯‘ä¹‹åéƒ½ä¼šç”Ÿæˆæ–°çš„ hashï¼Œå³ä¿®æ”¹ä»»ä½•æ–‡ä»¶éƒ½ä¼šå¯¼è‡´æ‰€æœ‰æ–‡ä»¶çš„ hash å‘ç”Ÿæ”¹å˜ï¼›åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­è™½ç„¶å…¥å£ä¸åŒï¼Œä½†æ˜¯ hash æ˜¯ç›¸åŒçš„ï¼›hash æ— æ³•å®ç°å‰ç«¯é™æ€èµ„æºåœ¨æµè§ˆå™¨ä¸Šé•¿ç¼“å­˜ï¼Œè¿™æ—¶å€™åº”è¯¥ä½¿ç”¨ chunkhashï¼›</li><li>[chunkhash]ï¼šæ ¹æ®ä¸åŒçš„å…¥å£æ–‡ä»¶ï¼ˆentryï¼‰è¿›è¡Œä¾èµ–æ–‡ä»¶è§£æï¼Œæ„å»ºå¯¹åº”çš„ chunkï¼Œç”Ÿæˆç›¸åº”çš„ hashï¼›åªè¦ç»„æˆ entry çš„æ¨¡å—æ–‡ä»¶æ²¡æœ‰å˜åŒ–ï¼Œåˆ™å¯¹åº”çš„ hash ä¹Ÿæ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬é¡¹ç›®ä¼˜åŒ–æ—¶ï¼Œä¼šå°†å…¬å…±åº“ä»£ç æ‹†åˆ†åˆ°ä¸€èµ·ï¼Œå› ä¸ºå…¬å…±åº“ä»£ç å˜åŠ¨è¾ƒå°‘çš„ï¼Œä½¿ç”¨ chunkhash å¯ä»¥å‘æŒ¥æœ€é•¿ç¼“å­˜çš„ä½œç”¨ï¼›</li><li>[contenthash]ï¼šä½¿ç”¨ chunkhash å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå½“åœ¨ä¸€ä¸ª JS æ–‡ä»¶ä¸­å¼•å…¥äº† CSS æ–‡ä»¶ï¼Œç¼–è¯‘åå®ƒä»¬çš„ hash æ˜¯ç›¸åŒçš„ã€‚è€Œä¸”ï¼Œåªè¦ JS æ–‡ä»¶å†…å®¹å‘ç”Ÿæ”¹å˜ï¼Œä¸å…¶å…³è”çš„ CSS æ–‡ä»¶ hash ä¹Ÿä¼šæ”¹å˜ï¼Œé’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥æŠŠ CSS ä» JS ä¸­ä½¿ç”¨mini-css-extract-plugin æˆ– extract-text-webpack-pluginæŠ½ç¦»å‡ºæ¥å¹¶ä½¿ç”¨ contenthashã€‚</li></ul><h3 id="Loader"><a href="#Loader" class="headerlink" title="Loader"></a>Loader</h3><p>webpack åªèƒ½ç†è§£ JavaScript å’Œ JSON æ–‡ä»¶ï¼Œè¿™æ˜¯ webpack å¼€ç®±å¯ç”¨çš„è‡ªå¸¦èƒ½åŠ›ã€‚**loader è®© webpack èƒ½å¤Ÿå»å¤„ç†å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬è½¬æ¢ä¸ºæœ‰æ•ˆ **<a href="https://webpack.docschina.org/concepts/modules" title="æ¨¡å—"><strong>æ¨¡å—</strong></a><strong>ï¼Œä»¥ä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œä»¥åŠè¢«æ·»åŠ åˆ°ä¾èµ–å›¾ä¸­ã€‚</strong></p><p>åœ¨ webpack çš„é…ç½®ä¸­ï¼Œ<strong>loader</strong> æœ‰ä¸¤ä¸ªå±æ€§ï¼š</p><ol><li><code>test</code> å±æ€§ï¼Œè¯†åˆ«å‡ºå“ªäº›æ–‡ä»¶ä¼šè¢«è½¬æ¢ã€‚</li><li><code>use</code> å±æ€§ï¼Œå®šä¹‰å‡ºåœ¨è¿›è¡Œè½¬æ¢æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å“ªä¸ª <code>loader</code>ã€‚åŒæ—¶åœ¨use é‡Œé…ç½®loaderæ—¶å¯ä»¥åŒæ—¶åœ¨æ—è¾¹é…ç½®è¿™ä¸ªloaderç›¸åº”çš„<code>options</code>ï¼Œå¯¹è¿™ä¸ªloaderè¿›è¡Œé…ç½®ã€‚</li></ol><h4 id="file-loader"><a href="#file-loader" class="headerlink" title="file-loader"></a>file-loader</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [&#123;<br>      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jpg$/</span>,<br>      <span class="hljs-attr">use</span>: &#123;<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;file-loader&#x27;</span>,<br>        <span class="hljs-comment">//loader options</span><br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;[name].[ext]&#x27;</span>, <span class="hljs-comment">// placeholder []å ä½ç¬¦</span><br>          <span class="hljs-attr">outputPath</span>:<span class="hljs-string">&#x27;images/&#x27;</span>, <br>        &#125;<br>      &#125; <br>    &#125;]<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="url-loader"><a href="#url-loader" class="headerlink" title="url-loader"></a>url-loader</h4><p>å’Œfile-loader åŠŸèƒ½ç›¸ä¼¼ï¼Œä¸è¿‡å¯¹å¤„ç†å›¾ç‰‡å¼•ç”¨æ›´åŠ åˆé€‚ï¼Œå¯ä»¥æ ¹æ®å›¾ç‰‡å¤§å°é…ç½®ä¸åŒçš„å¼•ç”¨ç­–ç•¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [&#123;<br>      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jpg$/</span>,<br>      <span class="hljs-attr">use</span>: &#123;<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;url-loader&#x27;</span>,<br>        <span class="hljs-comment">//loader options</span><br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;[name]_[hash].[ext]&#x27;</span>, <span class="hljs-comment">// placeholder []å ä½ç¬¦</span><br>          <span class="hljs-attr">outputPath</span>:<span class="hljs-string">&#x27;images/&#x27;</span>, <br>          <span class="hljs-attr">limit</span>:<span class="hljs-number">20480</span> <span class="hljs-comment">//å¤§äº20kbçš„å›¾ç‰‡æ”¾åœ¨imagesï¼Œå°äºçš„æ”¾å…¥bundle.jsé‡Œè½¬æˆbase64</span><br>        &#125;<br>      &#125; <br>    &#125;]<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="style-loader"><a href="#style-loader" class="headerlink" title="style-loader"></a>style-loader</h4><p>css-loaderè´Ÿè´£æ•´åˆcssæ ·å¼ï¼Œstyle-loaderè´Ÿè´£å°†æ•´åˆçš„æ ·å¼æŒ‚è½½åˆ°htmlé‡Œçš„styleæ ‡ç­¾é‡Œï¼Œé…åˆä½¿ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [&#123;<br>      <span class="hljs-attr">test</span>:<span class="hljs-regexp">/\.css$/</span>,<br>      <span class="hljs-attr">use</span>:[<span class="hljs-string">&#x27;style-loader&#x27;</span>,<span class="hljs-string">&#x27;css-loader&#x27;</span>]<br>    &#125;]<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="css-loader"><a href="#css-loader" class="headerlink" title="css-loader"></a>css-loader</h4><p>é‡è¦é…ç½®é¡¹</p><table><thead><tr><th>importLoaders</th><th><code>importLoaders</code> é€‰é¡¹å…è®¸ä½ é…ç½®åœ¨ <code>css-loader</code> ä¹‹å‰æœ‰å¤šå°‘ loader åº”ç”¨äº <code>@import</code>ed èµ„æºä¸ CSS æ¨¡å—&#x2F;ICSS å¯¼å…¥&#xA;ï¼ˆå‡å¦‚css-loaderå‰æœ‰sass-loaderå’Œpostcss-loaderï¼Œå¦‚æœä¸é…ç½®importLoadersï¼Œimportå¯¼å…¥çš„cssæ¨¡å—å°±ä¸ä¼šå—è¿™ä¸¤ä¸ªloaderå¤„ç†ï¼‰</th></tr></thead><tbody><tr><td>modules</td><td>å¯ç”¨&#x2F;ç¦ç”¨ CSS æ¨¡å—æˆ–è€… ICSS åŠå…¶é…ç½®</td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">entry</span>: &#123;<br>    <span class="hljs-attr">main</span>: <span class="hljs-string">&#x27;./src/index.js&#x27;</span><br>  &#125;,<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [&#123;<br>      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.jpg$/</span>,<br>      <span class="hljs-attr">use</span>: &#123;<br>        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;url-loader&#x27;</span>,<br>        <span class="hljs-attr">options</span>: &#123;<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;[name]_[hash].[ext]&#x27;</span>,<br>          <span class="hljs-attr">outputPath</span>: <span class="hljs-string">&#x27;images/&#x27;</span>,<br>          <span class="hljs-attr">limit</span>: <span class="hljs-number">2048</span><br>        &#125;<br>      &#125;<br>    &#125;, &#123;<br>      <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,<br>      <span class="hljs-attr">use</span>: [<span class="hljs-string">&#x27;style-loader&#x27;</span>, &#123;<br>        <span class="hljs-attr">loader</span>:<span class="hljs-string">&#x27;css-loader&#x27;</span>,<br>        <span class="hljs-attr">options</span>:&#123;<br>          <span class="hljs-attr">importLoaders</span>:<span class="hljs-number">2</span>,<br>          <span class="hljs-attr">modules</span>:<span class="hljs-literal">true</span><br>        &#125;<br>      &#125;, <span class="hljs-string">&#x27;sass-loader&#x27;</span>, <span class="hljs-string">&#x27;postcss-loader&#x27;</span>],<br>    &#125;]<br>  &#125;,<br>  <span class="hljs-attr">output</span>: &#123;<br>    <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;bundle.js&#x27;</span>,<br>    <span class="hljs-attr">path</span>: path.<span class="hljs-title function_">resolve</span>(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>)<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Plugins"><a href="#Plugins" class="headerlink" title="Plugins"></a>Plugins</h3><p>å¯ä»¥åœ¨webpackè¿è¡Œåˆ°æŸä¸€æ—¶åˆ»çš„æ—¶å€™ï¼Œå¸®ä½ åšäº›ä»€ä¹ˆ</p><h4 id="HtmlWebpackPlugin"><a href="#HtmlWebpackPlugin" class="headerlink" title="HtmlWebpackPlugin"></a>HtmlWebpackPlugin</h4><p>ä¼šåœ¨æ‰“åŒ…ç»“æŸåè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªhtmlæ–‡ä»¶ï¼Œå¹¶æŠŠæ‰“åŒ…ç”Ÿæˆçš„jsè‡ªåŠ¨å¼•å…¥åˆ°è¿™ä¸ªhtmlä¸­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  ...<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;src/index.html&#x27;</span> <span class="hljs-comment">//é…ç½®ç”Ÿæˆhtmlæ–‡ä»¶çš„æ¨¡ç‰ˆ</span><br>    &#125;), <br>  ],<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="CleanWebpackPlugin"><a href="#CleanWebpackPlugin" class="headerlink" title="CleanWebpackPlugin"></a>CleanWebpackPlugin</h4><p>åœ¨é‡æ–°æ‰“åŒ…çš„æ—¶å€™æŠŠæ—§çš„æ‰“åŒ…æ–‡ä»¶åˆ é™¤</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>  ...<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">HtmlWebpackPlugin</span>(&#123;<br>      <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;src/index.html&#x27;</span> <span class="hljs-comment">//é…ç½®ç”Ÿæˆhtmlæ–‡ä»¶çš„æ¨¡ç‰ˆ</span><br>    &#125;), <br>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">CleanWebpackPlugin</span>([<span class="hljs-string">&#x27;dist&#x27;</span>])<br>  ],<br>  ...<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h3><p><code>webpack â€”watch</code> ä¹Ÿèƒ½å®æ—¶ç›‘å¬æ‰“åŒ…æ–‡ä»¶å˜åŒ–ï¼Œä½†æ²¡dev-serveråŠŸèƒ½å¤š</p><p>webpack-dev-server ä¸ä»…èƒ½å®æ—¶ç›‘å¬ï¼Œè¿˜èƒ½ç¼–è¯‘å®Œé‡æ–°åˆ·æ–°é¡µé¢</p><p>æ³¨æ„ï¼šæœ‰æ²¡æœ‰å‘ç°å¹³å¸¸å¼€å‘æ—¶vueå¹¶æ²¡æœ‰ç”Ÿæˆdistç›®å½•ï¼Œåªæœ‰<code>npm run build</code>åæ‰ä¼šç”Ÿæˆdistï¼Œè¿™æ˜¯å› ä¸ºwebpack-dev-server å°†æ‰“åŒ…ç¼–è¯‘å‡ºæ¥çš„æ–‡ä»¶æ”¾å…¥å†…å­˜ä¸­ï¼Œä»è€Œæå‡å®ƒçš„æ‰“åŒ…é€Ÿåº¦ï¼Œè¿™æ˜¯ä¸€ä¸ªdev-serverçš„éšè—ç‰¹æ€§</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs javascript">npm i webpack-dev-server -d<br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-attr">devServer</span>:&#123;<br>    <span class="hljs-comment">//è¿è¡Œä»£ç çš„ç›®å½•</span><br>    <span class="hljs-attr">contentBase</span>:<span class="hljs-title function_">resolve</span>(__dirname,<span class="hljs-string">&quot;build&quot;</span>),<br>    <span class="hljs-comment">//ç›‘è§†contentBaseä¸‹çš„å…¨éƒ¨æ–‡ä»¶ï¼Œä¸€æ—¦æ–‡ä»¶å˜åŒ–ï¼Œå°±ä¼šreload</span><br>    <span class="hljs-attr">watchContentBase</span>:<span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">//ç›‘è§†ä¸­å¿½ç•¥æŸäº›æ–‡ä»¶</span><br>    <span class="hljs-attr">watchOptions</span>:&#123;<br>        <span class="hljs-attr">ignored</span>:<span class="hljs-regexp">/node_modules/</span><br>    &#125;,<br>    <span class="hljs-comment">//ç«¯å£å·</span><br>    <span class="hljs-attr">port</span>:<span class="hljs-number">3000</span>,<br>    <span class="hljs-comment">//åŸŸå</span><br>    <span class="hljs-attr">host</span>:<span class="hljs-string">&#x27;localhost&#x27;</span>,<br>    <span class="hljs-comment">//å¯åŠ¨gzipå‹ç¼©</span><br>    <span class="hljs-attr">compress</span>:<span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">//è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨</span><br>    <span class="hljs-attr">open</span>:<span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">//å¼€å¯HMRåŠŸèƒ½</span><br>    <span class="hljs-attr">hot</span>:<span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">//ä¸è¦å¯åŠ¨æœåŠ¡çš„æ—¥å¿—ä¿¡æ¯</span><br>    <span class="hljs-attr">clientLogLevel</span>:<span class="hljs-string">&#x27;none&#x27;</span>,<br>    <span class="hljs-comment">//é™¤äº†ä¸€äº›åŸºæœ¬çš„å¯åŠ¨ä¿¡æ¯ä»¥å¤–ï¼Œå…¶ä»–éƒ½ä¸æ˜¾ç¤º</span><br>    <span class="hljs-attr">quiet</span>:<span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">//å¦‚æœå‡ºé”™äº†ï¼Œä¸è¦å…¨å±æç¤º</span><br>    <span class="hljs-attr">overlay</span>:<span class="hljs-literal">false</span>,<br>    <span class="hljs-comment">//æœåŠ¡å™¨ä»£ç† -&gt; è§£å†³å¼€å‘ç¯å¢ƒè·¨åŸŸé—®é¢˜</span><br>    <span class="hljs-attr">proxy</span>:&#123;<br>        <span class="hljs-comment">//ä¸€æ—¦devServer5000æ¥åˆ°/api/xxxçš„è¯·æ±‚ï¼Œå°±ä¼šæŠŠè¯·æ±‚è½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨3000</span><br>        <span class="hljs-string">&#x27;/api&#x27;</span>:&#123;<br>            <span class="hljs-comment">//è½¬å‘åçš„ç›®æ ‡åœ°å€</span><br>            <span class="hljs-comment">// target: project_config.proxyAddr,</span><br>            <span class="hljs-attr">target</span>:<span class="hljs-string">&#x27;localhost:3000&#x27;</span>,<br>            <span class="hljs-comment">// å‘é€è¯·æ±‚æ—¶ï¼Œè¯·æ±‚è·¯å¾„é‡å†™ /api/xxx -&gt;  /xxx ï¼ˆå»æ‰a/piï¼‰</span><br>            <span class="hljs-attr">pathRewrite</span>: &#123;<br>                <span class="hljs-string">&#x27;^/api&#x27;</span>: <span class="hljs-string">&#x27;&#x27;</span><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ¨¡å—çƒ­æ›¿æ¢-HMR"><a href="#æ¨¡å—çƒ­æ›¿æ¢-HMR" class="headerlink" title="æ¨¡å—çƒ­æ›¿æ¢ HMR"></a>æ¨¡å—çƒ­æ›¿æ¢ HMR</h3><p>ä½œç”¨ï¼šHMR æ—¢é¿å…äº†é¢‘ç¹æ‰‹åŠ¨åˆ·æ–°é¡µé¢ï¼Œä¹Ÿå‡å°‘äº†é¡µé¢åˆ·æ–°æ—¶çš„ç­‰å¾…ï¼Œå¯ä»¥æå¤§åœ°æé«˜å‰ç«¯é¡µé¢å¼€å‘æ•ˆç‡ã€‚</p><p>å®‰è£…webpackæ’ä»¶HotModuleReplacementPlugin</p><p>è¿™ä¸ªæ’ä»¶æ˜¯é…åˆdev-serverä¸€èµ·ä½¿ç”¨ï¼Œå¦‚æœåªç”¨dev-server ï¼Œåœ¨ä»£ç é‡Œæ”¹äº†æ ·å¼ä»€ä¹ˆï¼Œä¹Ÿä¼šé‡æ–°åˆ·æ–°é¡µé¢ã€‚çƒ­æ›´æ–°æ’ä»¶èƒ½å¸®åŠ©webpackç›´æ¥æ›¿æ¢æ ·å¼æ–‡ä»¶ï¼Œä¸åˆ·æ–°é¡µé¢çŠ¶æ€ã€‚</p><p>devServeré…ç½® hotï¼štrue ï¼Œæ’ä»¶é‡Œå†åŠ ä¸Šhmræ’ä»¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> devConfig = &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;development&#x27;</span>,<br>  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&#x27;cheap-module-eval-source-map&#x27;</span>,<br>  <span class="hljs-attr">devServer</span>: &#123;<br>    <span class="hljs-attr">contentBase</span>: <span class="hljs-string">&#x27;./dist&#x27;</span>,<br>    <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,<br>    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">//å¼€å¯çƒ­æ›´æ–°</span><br>  &#125;,<br>  ...<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-keyword">new</span> webpack.<span class="hljs-title class_">HotModuleReplacementPlugin</span>()<br>  ],<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/img/image_GcvwJIz_Dd.png" alt="hmrå®ç°åŸç†" title="hmrå®ç°åŸç†"></p><p>åŸç†è¯¦ç»†ä¿¡æ¯å¯ä»¥æŸ¥çœ‹</p><p><a href="https://www.kancloud.cn/sllyli/webpack/1242354">https://www.kancloud.cn/sllyli/webpack/1242354</a></p><h3 id="Babel-es6è½¬es5"><a href="#Babel-es6è½¬es5" class="headerlink" title="Babel es6è½¬es5"></a>Babel es6è½¬es5</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm install --save-dev babel-loader @babel/core<br>npm install @babel/preset-env --save-dev  //è¿™ä¸ªæ‰æ˜¯es6è½¬es5ç”¨çš„ä¸œè¥¿ï¼Œé‡Œé¢æœ‰es6è½¬es5çš„ç¿»è¯‘è§„åˆ™<br>npm install --save @babel/polyfill<br><br><br></code></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&#123;<br>  <span class="hljs-attr">module</span>: &#123;<br>    <span class="hljs-attr">rules</span>: [<br>      &#123;<br>        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.m?js$/</span>,<br>        <span class="hljs-attr">exclude</span>: <span class="hljs-regexp">/node_modules/</span>,<span class="hljs-comment">//è¿™ä¸ªä¸€å®šè¦æœ‰ï¼Œå› ä¸ºnode_modulesé‡Œéƒ½æ˜¯ä¾èµ–åŒ…</span><br>        <span class="hljs-attr">use</span>: &#123;<br>          <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,<br>          <span class="hljs-attr">options</span>: &#123;<br>            <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>]<br>          &#125;<br>        &#125;<br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>babelçš„é…ç½®é¡¹å¯èƒ½ä¼šå¾ˆå¤šï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ª<code>.babelrc</code>æ–‡ä»¶ä¸“é—¨å­˜æ”¾é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  presets: [<br>    [<br>      <span class="hljs-string">&quot;@babel/preset-env&quot;</span>, &#123;<br>        targets: &#123;<br>          chrome: <span class="hljs-string">&quot;67&quot;</span>,<br>        &#125;,<br>        useBuiltIns: <span class="hljs-string">&#x27;usage&#x27;</span><br>      &#125;<br>    ],<br>    <span class="hljs-string">&quot;@babel/preset-react&quot;</span><br>  ],<br>  plugins: [<span class="hljs-string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>webpack</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webpack</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nginxé…ç½®å­¦ä¹ </title>
    <link href="/2023/08/19/Nginx%E5%AD%A6%E4%B9%A0/"/>
    <url>/2023/08/19/Nginx%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul><li><a href="#nginx-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4">nginx åŸºç¡€å‘½ä»¤</a></li><li><a href="#nginx-location-%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%99">nginx location è·¯ç”±è§„åˆ™</a><ul><li><a href="#demo-%E5%90%8E%E7%BC%80%E5%90%8D%E5%8C%B9%E9%85%8D">demo åç¼€ååŒ¹é…</a></li><li><a href="#demo2%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99">demo2åŒ¹é…è§„åˆ™</a></li><li><a href="#demo3%E5%8C%B9%E9%85%8D%E9%A1%BA%E5%BA%8F">demo3åŒ¹é…é¡ºåº</a></li><li><a href="#demo4%E6%97%A0%E7%AC%A6%E5%8F%B7%E5%8C%B9%E9%85%8D">demo4æ— ç¬¦å·åŒ¹é…</a></li></ul></li><li><a href="#nginx%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85">nginxç¼–è¯‘å®‰è£…</a></li><li><a href="#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E4%B8%80%E6%AC%A1http%E8%AF%B7%E6%B1%82">å¦‚ä½•ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ä¸€æ¬¡httpè¯·æ±‚</a></li><li><a href="#nginx-%E6%97%A5%E5%BF%97">nginx æ—¥å¿—</a><ul><li><a href="#errorlog">error.log</a></li><li><a href="#accesslog">access.log</a></li><li><a href="#%E6%8C%89%E6%97%A5%E6%9C%9F%E7%94%9F%E6%88%90%E8%AE%BF%E9%97%AE%E6%97%A5%E5%BF%97">æŒ‰æ—¥æœŸç”Ÿæˆè®¿é—®æ—¥å¿—</a></li></ul></li><li><a href="#nginx%E6%A8%A1%E5%9D%97%E9%85%8D%E7%BD%AE">nginxæ¨¡å—é…ç½®</a><ul><li><a href="#%E6%9F%A5%E7%9C%8Bnginx%E5%B7%B2%E5%AE%89%E8%A3%85%E6%A8%A1%E5%9D%97">æŸ¥çœ‹nginxå·²å®‰è£…æ¨¡å—</a></li><li><a href="#%E6%9F%A5%E7%9C%8Bnginx%E5%8F%AF%E4%BB%A5%E5%AE%89%E8%A3%85%E7%9A%84%E5%8C%85">æŸ¥çœ‹nginxå¯ä»¥å®‰è£…çš„åŒ…</a></li></ul></li><li><a href="#%E5%9F%BA%E4%BA%8Enginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84">åŸºäºnginxçš„ä¸­é—´ä»¶æ¶æ„</a><ul><li><a href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90web%E6%9C%8D%E5%8A%A1">é™æ€èµ„æºwebæœåŠ¡</a></li><li><a href="#mimetype-%E8%B5%84%E6%BA%90%E7%9A%84%E5%AA%92%E4%BD%93%E7%B1%BB%E5%9E%8B">mime.type èµ„æºçš„åª’ä½“ç±»å‹</a></li><li><a href="#sendfile-%E9%85%8D%E7%BD%AE">sendfile é…ç½®</a></li><li><a href="#gzip%E5%8E%8B%E7%BC%A9">gzipå‹ç¼©</a></li><li><a href="#http%E7%BC%93%E5%AD%98">httpç¼“å­˜</a></li><li><a href="#expireshttp10">expiresï¼ˆhttp1.0ï¼‰</a></li><li><a href="#expireshttp11">expiresï¼ˆhttp1.1ï¼‰</a></li><li><a href="#nginx-%E8%B7%A8%E5%9F%9F%E8%AE%BF%E9%97%AE">nginx è·¨åŸŸè®¿é—®</a></li><li><a href="#nginx-%E9%98%B2%E7%9B%97%E9%93%BE">nginx é˜²ç›—é“¾</a></li></ul></li><li><a href="#nginx-%E4%BB%A3%E7%90%86">nginx ä»£ç†</a><ul><li><a href="#%E5%8F%91%E5%90%91%E4%BB%A3%E7%90%86%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86">å‘å‘ä»£ç†&#x2F;æ­£å‘ä»£ç†</a></li><li><a href="#%E5%B8%B8%E7%94%A8%E4%BB%A3%E7%90%86%E7%9A%84%E9%85%8D%E7%BD%AE">å¸¸ç”¨ä»£ç†çš„é…ç½®</a></li><li><a href="#proxy_params">proxy_params</a></li><li><a href="#nginx-%E8%BD%AE%E8%AF%A2">nginx è½®è¯¢</a></li></ul></li><li><a href="#nginx-%E5%8F%98%E9%87%8F%E8%A7%A3%E6%9E%90">nginx å˜é‡è§£æ</a></li><li><a href="#nginx%E7%BC%93%E5%AD%98%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E7%BC%93%E5%AD%98%E5%87%8F%E5%B0%91%E5%90%8E%E7%AB%AF%E5%8E%8B%E5%8A%9B%E6%8F%90%E9%AB%98%E7%BD%91%E7%AB%99%E5%B9%B6%E5%8F%91%E5%BB%B6%E6%97%B6">nginxç¼“å­˜ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ç¼“å­˜ï¼Œå‡å°‘åç«¯å‹åŠ›ï¼Œæé«˜ç½‘ç«™å¹¶å‘å»¶æ—¶ï¼‰</a><ul><li><a href="#%E9%83%A8%E5%88%86%E9%A1%B5%E9%9D%A2%E4%B8%8D%E7%BC%93%E5%AD%98">éƒ¨åˆ†é¡µé¢ä¸ç¼“å­˜</a></li></ul></li></ul><h4 id="nginx-åŸºç¡€å‘½ä»¤"><a href="#nginx-åŸºç¡€å‘½ä»¤" class="headerlink" title="nginx åŸºç¡€å‘½ä»¤"></a>nginx åŸºç¡€å‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx -t // æ£€æŸ¥é…ç½®æ–‡ä»¶ æŸ¥çœ‹å½“å‰nginx é…ç½®è·¯å¾„<br>nginx -s reload // é‡è½½nginxé…ç½®æ–‡ä»¶<br></code></pre></td></tr></table></figure><h3 id="nginx-location-è·¯ç”±è§„åˆ™"><a href="#nginx-location-è·¯ç”±è§„åˆ™" class="headerlink" title="nginx location è·¯ç”±è§„åˆ™"></a>nginx location è·¯ç”±è§„åˆ™</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> [=|~|~*|^~|@] pattern &#123; ... &#125;<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx">= : è¡¨ç¤ºç²¾ç¡®åŒ¹é…åé¢çš„<span class="hljs-attribute">url</span><br><span class="hljs-regexp">~ :</span> è¡¨ç¤ºæ­£åˆ™åŒ¹é…ï¼Œä½†æ˜¯åŒºåˆ†å¤§å°å†™<br><span class="hljs-regexp">~* :</span> æ­£åˆ™åŒ¹é…ï¼Œä¸åŒºåˆ†å¤§å°å†™<span class="hljs-regexp"></span><br><span class="hljs-regexp">^~</span> : è¡¨ç¤ºæ™®é€šå­—ç¬¦åŒ¹é…ï¼Œå¦‚æœè¯¥é€‰é¡¹åŒ¹é…ï¼ŒåªåŒ¹é…è¯¥é€‰é¡¹ï¼Œä¸åŒ¹é…åˆ«çš„é€‰é¡¹ï¼Œä¸€èˆ¬ç”¨æ¥åŒ¹é…ç›®å½•<br>@ : <span class="hljs-string">&quot;@&quot;</span> å®šä¹‰ä¸€ä¸ªå‘½åçš„ locationï¼Œä½¿ç”¨åœ¨å†…éƒ¨å®šå‘æ—¶ï¼Œä¾‹å¦‚ error_page<br></code></pre></td></tr></table></figure><h4 id="demo-åç¼€ååŒ¹é…"><a href="#demo-åç¼€ååŒ¹é…" class="headerlink" title="demo åç¼€ååŒ¹é…"></a>demo åç¼€ååŒ¹é…</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~ .*\.(html|htm|gif|jpg|jpeg|bmp|png|ico|txt|js|css|woff|ttf|map|woff2|json|manifest|svg|eot)$</span>  &#123;   <br>  <span class="hljs-attribute">root</span> /Users/sunqixiong/project/crm-cerm/ecrm-mobile/www;<br>&#125;<br></code></pre></td></tr></table></figure><p>å°±æ˜¯æ­£åˆ™åŒ¹é…,å…¶ä¸­<code>.*\.(html|htm|gif|jpg|jpeg|bmp|png|ico|txt|js|css|woff|ttf|map|woff2|json|manifest|svg|eot)$</code>å°±æ˜¯ä¸€ä¸²åŒ¹é…åç¼€åçš„æ­£åˆ™è¡¨è¾¾å¼</p><h4 id="demo2åŒ¹é…è§„åˆ™"><a href="#demo2åŒ¹é…è§„åˆ™" class="headerlink" title="demo2åŒ¹é…è§„åˆ™"></a>demo2åŒ¹é…è§„åˆ™</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> = /world &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">600</span>;<br>&#125;<br><br><span class="hljs-section">location</span> = /hello &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">600</span>;<br>&#125;<br><br><span class="hljs-section">location</span> <span class="hljs-regexp">~ /hellowo</span> &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">602</span>;<br>&#125;<br><br><span class="hljs-section">location</span><span class="hljs-regexp"> ^~</span> /hello &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">601</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs text">- è¯·æ±‚ localhost/world è¿”å›600<br>- è¯·æ±‚ localhost/world2 localhost/test/world è¿”å›å…¶ä»–<br>- è¯·æ±‚ localhost/hello  è¿”å›600<br>- è¯·æ±‚ localhost/hello/123 è¿”å›601<br>- è¯·æ±‚ localhost/hellow è¿”å›601<br>- è¯·æ±‚ localhost/hellowo è¿”å›601<br>- è¯·æ±‚ localhost/test/hellowo  è¿”å›602<br>- è¯·æ±‚ localhost/test/hello è¿”å›å…¶ä»–<br></code></pre></td></tr></table></figure><ul><li>= æ˜¯ç²¾ç¡®å®Œæ•´åŒ¹é…, ä¸”ä¼˜ç§€æœ€é«˜</li><li>åŒ¹é…æ—¶ï¼Œå¦‚æœ ~ å’Œ ^~ åŒæ—¶åŒ¹é…è§„åˆ™ï¼Œåˆ™ ^~ ä¼˜å…ˆ</li><li>^~ è¿™ä¸ªä¸ä¼šåŒ¹é…è¯·æ±‚urlä¸­åé¢çš„è·¯å¾„, å¦‚ä¸Šé¢çš„ &#x2F;test&#x2F;hello æ²¡æœ‰åŒ¹é…ä¸Š</li><li>^~ ä¸æ”¯æŒæ­£åˆ™ï¼Œå’Œ&#x3D;ç›¸æ¯”ï¼ŒèŒƒå›´æ›´å¹¿ï¼Œ hellowo æ˜¯å¯ä»¥è¢«^~åŒ¹é…ï¼Œä½†æ˜¯ &#x3D; ä¸ä¼šåŒ¹é…</li><li>~ è·¯å¾„ä¸­åªè¦åŒ…å«å°±å¯ä»¥åŒ¹é…ï¼Œå¦‚ä¸Šé¢çš„ &#x2F;test&#x2F;hellowo è¿”å›äº†602</li></ul><h4 id="demo3åŒ¹é…é¡ºåº"><a href="#demo3åŒ¹é…é¡ºåº" class="headerlink" title="demo3åŒ¹é…é¡ºåº"></a>demo3åŒ¹é…é¡ºåº</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~ /hello</span> &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">602</span>;<br>&#125;<br><br><span class="hljs-section">location</span> <span class="hljs-regexp">~ /helloworld</span> &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">601</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">- è¯·æ±‚ localhost/world/helloworld è¿”å› 602<br>- è¯·æ±‚ localhost/helloworld è¿”å› 602<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~ /helloworld</span> &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">601</span>;<br>&#125;<br><br><span class="hljs-section">location</span> <span class="hljs-regexp">~ /hello</span> &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">602</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">- è¯·æ±‚ localhost/helloworld è¿”å›601<br>- è¯·æ±‚ localhost/world/helloworld è¿”å›601<br>- è¯·æ±‚ localhost/helloWorld è¿”å›602<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥åŒæ—¶æ­£åˆ™åŒ¹é…æ—¶</p><ul><li>æ”¾åœ¨å‰é¢çš„ä¼˜å…ˆåŒ¹é…</li><li>æ³¨æ„å¦‚æœä¸åŒºåˆ†å¤§å°å†™æ—¶ï¼Œä½¿ç”¨~*</li><li>å°½é‡å°†ç²¾ç¡®åŒ¹é…çš„æ”¾åœ¨å‰é¢</li></ul><h4 id="demo4æ— ç¬¦å·åŒ¹é…"><a href="#demo4æ— ç¬¦å·åŒ¹é…" class="headerlink" title="demo4æ— ç¬¦å·åŒ¹é…"></a>demo4æ— ç¬¦å·åŒ¹é…</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span><span class="hljs-regexp"> ^~</span> /hello/ &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">601</span>;<br>&#125;<br><br><span class="hljs-section">location</span> /hello/world &#123;<br>  <span class="hljs-attribute">return</span> <span class="hljs-number">602</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">- http://localhost/hello/wor è¿”å›601<br>- http://localhost/hello/world è¿”å›602<br>- http://localhost/hello/world23 è¿”å›602<br>- http://localhost/hello/world/123 è¿”å›602<br></code></pre></td></tr></table></figure><ul><li>æ²¡æœ‰ç¬¦å·æ—¶ï¼Œå…¨åŒ¹é…æ˜¯ä¼˜å…ˆäº^~çš„</li></ul><h3 id="nginxç¼–è¯‘å®‰è£…"><a href="#nginxç¼–è¯‘å®‰è£…" class="headerlink" title="nginxç¼–è¯‘å®‰è£…"></a>nginxç¼–è¯‘å®‰è£…</h3><p>é¦–å…ˆä¸‹è½½ä¾èµ–åŒ…</p><p>nginxï¼ŒpenSSLã€PCREã€zlib</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mv</span> openssl-1.1.0g pcre-8.41 zlib-1.2.11 /usr/local/bin<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œé…ç½®å‘½ä»¤ï¼Œå‡ ä¸ªä¾èµ–åŒ…çš„è·¯å¾„å¯¹å°±å¯ä»¥ï¼Œå®˜æ–¹æ–‡æ¡£æç¤ºè¦å†™åˆ°ä¸€è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure --with-http_ssl_module  --with-http_stub_status_module --with-http_gzip_static_module  --with-pcre=../pcre-8.00 --with-zlib=../zlib-1.2.11 --with-openssl=../openssl-1.1.0k<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">make<br></code></pre></td></tr></table></figure><p>ä¹‹åå®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo make install<br></code></pre></td></tr></table></figure><p>é…ç½®nginx ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ln</span> -s /usr/local/nginx/sbin/nginx /usr/local/bin/nginx(åšè½¯é“¾ï¼Œæ·»åŠ åˆ°ç¯å¢ƒå˜é‡)<br></code></pre></td></tr></table></figure><p>ç„¶åå°±å¯ä»¥æ‰§è¡Œ <code>nginx -v</code> çœ‹ä¾èµ–äº†</p><h3 id="å¦‚ä½•ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ä¸€æ¬¡httpè¯·æ±‚"><a href="#å¦‚ä½•ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ä¸€æ¬¡httpè¯·æ±‚" class="headerlink" title="å¦‚ä½•ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ä¸€æ¬¡httpè¯·æ±‚"></a>å¦‚ä½•ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ä¸€æ¬¡httpè¯·æ±‚</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -v http://www.baidu.com &gt;/dev/null<br></code></pre></td></tr></table></figure><h3 id="nginx-æ—¥å¿—"><a href="#nginx-æ—¥å¿—" class="headerlink" title="nginx æ—¥å¿—"></a>nginx æ—¥å¿—</h3><h4 id="error-log"><a href="#error-log" class="headerlink" title="error.log"></a>error.log</h4><p>é”™è¯¯æ—¥å¿—çš„å­˜æ”¾ä½ç½® çº§åˆ«ï¼Œæ”¾åœ¨æœ€å¤–é¢</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">error_log</span> /usr/local/etc/nginx/log/<span class="hljs-literal">error</span>.log <span class="hljs-literal">warn</span>;<br></code></pre></td></tr></table></figure><h4 id="access-log"><a href="#access-log" class="headerlink" title="access.log"></a>access.log</h4><p>é¦–å…ˆç¬¬ä¸€æ¡ log_formatè¦æ”¾åœ¨ httpä¹‹ä¸‹ï¼Œå…¶æ¬¡åé¢çš„main æŒ‡çš„æ˜¯ log_formatå¯¹åº”çš„åå­—</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">log_format</span>  main  <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &quot;<span class="hljs-variable">$request</span>&quot; &#x27;</span><br>                  <span class="hljs-string">&#x27;<span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &quot;<span class="hljs-variable">$http_referer</span>&quot; &#x27;</span><br>                  <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_user_agent</span>&quot; &quot;<span class="hljs-variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">access_log</span>  /var/log/nginx/access.log  main;<br></code></pre></td></tr></table></figure><h4 id="æŒ‰æ—¥æœŸç”Ÿæˆè®¿é—®æ—¥å¿—"><a href="#æŒ‰æ—¥æœŸç”Ÿæˆè®¿é—®æ—¥å¿—" class="headerlink" title="æŒ‰æ—¥æœŸç”Ÿæˆè®¿é—®æ—¥å¿—"></a>æŒ‰æ—¥æœŸç”Ÿæˆè®¿é—®æ—¥å¿—</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#æ­¤å¤„æ˜¯æœ¬åœ°å¼€å‘æ‰€éœ€ï¼Œå¦‚æ˜¯å®¹å™¨ï¼Œåˆ™æ— éœ€owner</span><br><span class="hljs-attribute">user</span> root owner;<br>http&#123;<br>    <span class="hljs-attribute">log_format</span>  main  <span class="hljs-string">&#x27;<span class="hljs-variable">$remote_addr</span> - <span class="hljs-variable">$remote_user</span> [<span class="hljs-variable">$time_local</span>] &quot;<span class="hljs-variable">$request</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;zhuang tai m<span class="hljs-variable">$status</span> <span class="hljs-variable">$body_bytes_sent</span> &quot;<span class="hljs-variable">$http_referer</span>&quot; &#x27;</span><br>                      <span class="hljs-string">&#x27;&quot;<span class="hljs-variable">$http_user_agent</span>&quot; &quot;<span class="hljs-variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;<br>    ...<br>    server&#123;<br>       <span class="hljs-attribute">if</span> (<span class="hljs-variable">$time_iso8601</span> <span class="hljs-regexp">~ &quot;^(\d</span>&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)&quot;) &#123;<br>            <span class="hljs-attribute">set</span> <span class="hljs-variable">$year</span> <span class="hljs-variable">$1</span>;<br>            <span class="hljs-attribute">set</span> <span class="hljs-variable">$month</span> <span class="hljs-variable">$2</span>;<br>            <span class="hljs-attribute">set</span> <span class="hljs-variable">$day</span> <span class="hljs-variable">$3</span>;<br>        &#125;<br><br>        <span class="hljs-attribute">access_log</span>  /usr/local/etc/nginx/log/access_<span class="hljs-variable">$year</span>-<span class="hljs-variable">$month</span>-<span class="hljs-variable">$day</span>.log  main;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æœ‰ä¸ªç¼ºç‚¹ï¼Œè®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—ç”Ÿæˆçš„ä»£ç åªèƒ½æ”¾åœ¨serverä¸‹é¢</p><p>è¿˜æœ‰å…¶ä»–çš„æ–¹æ³•å¦‚ç¼–å†™å®šæ—¶shè„šæœ¬</p><h3 id="nginxæ¨¡å—é…ç½®"><a href="#nginxæ¨¡å—é…ç½®" class="headerlink" title="nginxæ¨¡å—é…ç½®"></a>nginxæ¨¡å—é…ç½®</h3><p>nginxç¼–è¯‘å®‰è£…ä»¥åæƒ³è¦å†åŠ nginxæ¨¡å—åªèƒ½é‡æ–°é…ç½®å†ç¼–è¯‘å®‰è£…ã€‚</p><h4 id="æŸ¥çœ‹nginxå·²å®‰è£…æ¨¡å—"><a href="#æŸ¥çœ‹nginxå·²å®‰è£…æ¨¡å—" class="headerlink" title="æŸ¥çœ‹nginxå·²å®‰è£…æ¨¡å—"></a>æŸ¥çœ‹nginxå·²å®‰è£…æ¨¡å—</h4><p>nginx å¤§Vçœ‹æ¨¡å— å°vçœ‹ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">nginx -V<br></code></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹nginxå¯ä»¥å®‰è£…çš„åŒ…"><a href="#æŸ¥çœ‹nginxå¯ä»¥å®‰è£…çš„åŒ…" class="headerlink" title="æŸ¥çœ‹nginxå¯ä»¥å®‰è£…çš„åŒ…"></a>æŸ¥çœ‹nginxå¯ä»¥å®‰è£…çš„åŒ…</h4><p>è¿›å…¥nginx ç¼–è¯‘å®‰è£…å‰çš„åŒ…çš„ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> auto/options | grep YES<br></code></pre></td></tr></table></figure><p>æ¨¡å—ä»‹ç»</p><ol><li>è¿æ¥é¢‘ç‡é™åˆ¶</li></ol><p><code>ngx_http_limit_conn_module</code></p><p>åœ¨nginxé…ç½®æ–‡ä»¶ä¸­çš„(http, server, location) ä¸‹é…ç½®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">http</span> &#123;<br>  <span class="hljs-comment"># ...å…¶å®ƒä»£ç çœç•¥...</span><br>  <span class="hljs-comment"># å¼€è¾Ÿä¸€ä¸ª10mçš„è¿æ¥ç©ºé—´ï¼Œå‘½åä¸ºaddr</span><br>  <span class="hljs-attribute">limit_conn_zone</span> <span class="hljs-variable">$binary_remote_addr</span> zone=addr:<span class="hljs-number">10m</span>;<br>  <span class="hljs-section">server</span> &#123;<br>    ...<br>    <span class="hljs-section">location</span> /download/ &#123;<br>      <span class="hljs-comment"># æœåŠ¡å™¨æ¯æ¬¡åªå…è®¸ä¸€ä¸ªIPåœ°å€è¿æ¥</span><br>      <span class="hljs-attribute">limit_conn</span> addr <span class="hljs-number">1</span>;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>è¯·æ±‚é¢‘ç‡é™åˆ¶</li></ol><p><code>ngx_http_limit_req_module</code></p><p>åœ¨nginxé…ç½®æ–‡ä»¶ä¸­çš„(http, server, location) ä¸‹é…ç½®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">http</span> &#123;<br> <br>  <span class="hljs-comment"># ...å…¶å®ƒä»£ç çœç•¥...</span><br>   <br>  <span class="hljs-comment"># å¼€è¾Ÿä¸€ä¸ª10mçš„è¯·æ±‚ç©ºé—´ï¼Œå‘½åä¸ºoneã€‚åŒä¸€ä¸ªIPå‘é€çš„è¯·æ±‚ï¼Œå¹³å‡æ¯ç§’åªå¤„ç†ä¸€æ¬¡</span><br>  <span class="hljs-attribute">limit_req_zone</span> <span class="hljs-variable">$binary_remote_addr</span> zone=one:<span class="hljs-number">10m</span> rate=1r/s;<br>   <br>  <span class="hljs-section">server</span> &#123;<br>      ...<br> <br>    <span class="hljs-section">location</span> /search/ &#123;<br>      <span class="hljs-attribute">limit_req</span> zone=one;<br>      <span class="hljs-comment"># å½“å®¢æˆ·ç«¯è¯·æ±‚è¶…è¿‡æŒ‡å®šæ¬¡æ•°ï¼Œæœ€å¤šå®½é™5æ¬¡è¯·æ±‚ï¼Œå¹¶å»¶è¿Ÿå¤„ç†ï¼Œ1ç§’1ä¸ªè¯·æ±‚</span><br>      <span class="hljs-comment"># limit_req zone=one burst=5;</span><br>      <span class="hljs-comment"># å½“å®¢æˆ·ç«¯è¯·æ±‚è¶…è¿‡æŒ‡å®šæ¬¡æ•°ï¼Œæœ€å¤šå®½é™5æ¬¡è¯·æ±‚ï¼Œå¹¶ç«‹å³å¤„ç†ã€‚</span><br>      <span class="hljs-comment"># limit_req zone=one burst=5 nodelay;</span><br> <br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>åŸºäºIPçš„è®¿é—®æ§åˆ¶</li></ol><p><code>ngx_http_access_module</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">Syntax:    allow address | CIDR | unix: | all;<br>Default:  â€”<br>Context:  http, server, location, limit_except<br> <br>Syntax:    deny address | CIDR | unix: | all;<br>Default:  â€”<br>Context:  http, server, location, limit_except<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>  <span class="hljs-comment"># ...å…¶å®ƒä»£ç çœç•¥...</span><br>  <span class="hljs-section">location</span> <span class="hljs-regexp">~ ^/index_1.html</span> &#123;<br>    <span class="hljs-attribute">root</span>  /usr/share/nginx/html;<br>    <span class="hljs-attribute">deny</span> <span class="hljs-number">151.19.57.60</span>; <span class="hljs-comment"># æ‹’ç»è¿™ä¸ªIPè®¿é—®</span><br>    <span class="hljs-attribute">allow</span> all; <span class="hljs-comment"># å…è®¸å…¶ä»–æ‰€æœ‰IPè®¿é—®</span><br>  &#125;<br> <br>  <span class="hljs-section">location</span> <span class="hljs-regexp">~ ^/index_2.html</span> &#123;<br>    <span class="hljs-attribute">root</span>  /usr/share/nginx/html;<br>    <span class="hljs-attribute">allow</span> <span class="hljs-number">151.19.57.0</span>/<span class="hljs-number">24</span>; <span class="hljs-comment"># å…è®¸IP 151.19.57.* è®¿é—®</span><br>    <span class="hljs-attribute">deny</span> all; <span class="hljs-comment"># æ‹’ç»å…¶ä»–æ‰€æœ‰IPè®¿é—®</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ngx_http_access_module çš„å±€é™æ€§</p><p>å½“å®¢æˆ·ç«¯é€šè¿‡ä»£ç†è®¿é—®æ—¶ï¼Œnginxçš„remote_addrè·å–çš„æ˜¯ä»£ç†çš„IP</p><h3 id="åŸºäºnginxçš„ä¸­é—´ä»¶æ¶æ„"><a href="#åŸºäºnginxçš„ä¸­é—´ä»¶æ¶æ„" class="headerlink" title="åŸºäºnginxçš„ä¸­é—´ä»¶æ¶æ„"></a>åŸºäºnginxçš„ä¸­é—´ä»¶æ¶æ„</h3><h4 id="é™æ€èµ„æºwebæœåŠ¡"><a href="#é™æ€èµ„æºwebæœåŠ¡" class="headerlink" title="é™æ€èµ„æºwebæœåŠ¡"></a>é™æ€èµ„æºwebæœåŠ¡</h4><h4 id="mime-type-èµ„æºçš„åª’ä½“ç±»å‹"><a href="#mime-type-èµ„æºçš„åª’ä½“ç±»å‹" class="headerlink" title="mime.type èµ„æºçš„åª’ä½“ç±»å‹"></a>mime.type èµ„æºçš„åª’ä½“ç±»å‹</h4><p>è¿™ç©æ„çœ‹èµ·æ¥ä¸æ˜¾çœ¼ï¼Œä½†æ˜¯å¦‚æœæ²¡äº†å®ƒï¼Œæ–‡ä»¶èµ„æºä¸‹è½½äº†æµè§ˆå™¨å´æ²¡æ³•è¯†åˆ«</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">include</span>     /etc/nginx/mime.types;<br></code></pre></td></tr></table></figure><h4 id="sendfile-é…ç½®"><a href="#sendfile-é…ç½®" class="headerlink" title="sendfile é…ç½®"></a>sendfile é…ç½®</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">è¯­æ³•ï¼š sendfile on | off;<br>é»˜è®¤å€¼ï¼š sendfile off;<br>ä¸Šä¸‹æ–‡ï¼š httpï¼Œserverï¼Œlocationï¼Œif in location<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">http</span> ï½›<br>    <span class="hljs-comment"># other directives</span><br>    sendfile    <span class="hljs-literal">on</span>;<br>    <span class="hljs-comment"># other directives</span><br>ï½<br></code></pre></td></tr></table></figure><p>æŒ‡å®šæ˜¯å¦ä½¿ç”¨sendfileç³»ç»Ÿè°ƒç”¨æ¥ä¼ è¾“æ–‡ä»¶ã€‚</p><p>sendfileç³»ç»Ÿè°ƒç”¨åœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´ç›´æ¥ä¼ é€’æ•°æ®(å®Œå…¨åœ¨å†…æ ¸ä¸­æ“ä½œ)ï¼Œä»è€Œé¿å…äº†æ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºå’Œç”¨æˆ·ç¼“å†²åŒºä¹‹é—´çš„æ‹·è´ï¼Œæ“ä½œæ•ˆç‡å¾ˆé«˜ï¼Œè¢«ç§°ä¹‹ä¸ºé›¶æ‹·è´ã€‚</p><p>æ‰€ä»¥å½“ Nginx æ˜¯ä¸€ä¸ªé™æ€æ–‡ä»¶æœåŠ¡å™¨çš„æ—¶å€™ï¼Œå¼€å¯ SENDFILE é…ç½®é¡¹èƒ½å¤§å¤§æé«˜ Nginx çš„æ€§èƒ½ã€‚ ä½†æ˜¯å½“ Nginx æ˜¯ä½œä¸ºä¸€ä¸ªåå‘ä»£ç†æ¥ä½¿ç”¨çš„æ—¶å€™ï¼ŒSENDFILE åˆ™æ²¡ä»€ä¹ˆç”¨äº†</p><h4 id="gzipå‹ç¼©"><a href="#gzipå‹ç¼©" class="headerlink" title="gzipå‹ç¼©"></a>gzipå‹ç¼©</h4><p>æ³¨ï¼šå¼€å¯ gzip_static on æŒ‡ä»¤éœ€è¦ http_gzip_static_module æ¨¡å—</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">http</span> &#123;<br>    <span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>; <br>    <span class="hljs-attribute">gzip_static</span> <span class="hljs-literal">on</span>; <span class="hljs-comment">#Â Nginxçš„åŠ¨æ€å‹ç¼©æ˜¯å¯¹æ¯ä¸ªè¯·æ±‚å…ˆå‹ç¼©å†è¾“å‡ºï¼Œè¿™æ ·é€ æˆè™šæ‹Ÿæœºæµªè´¹äº†å¾ˆå¤šcpuï¼Œè§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥åˆ©ç”¨nginxæ¨¡å—Gzip Precompressionï¼Œè¿™ä¸ªæ¨¡å—çš„ä½œç”¨æ˜¯å¯¹äºéœ€è¦å‹ç¼©çš„æ–‡ä»¶ï¼Œç›´æ¥è¯»å–å·²ç»å‹ç¼©å¥½çš„æ–‡ä»¶(æ–‡ä»¶åä¸ºåŠ .gz)ï¼Œè€Œä¸æ˜¯åŠ¨æ€å‹ç¼©ï¼Œå¯¹äºä¸æ”¯æŒgzipçš„è¯·æ±‚åˆ™è¯»å–åŸæ–‡ä»¶</span><br>    <span class="hljs-attribute">gzip_buffers</span> <span class="hljs-number">4</span> <span class="hljs-number">16k</span>;<br>    <span class="hljs-attribute">gzip_comp_level</span> <span class="hljs-number">5</span>;<br>    <span class="hljs-attribute">gzip_types</span> text/plain application/javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="httpç¼“å­˜"><a href="#httpç¼“å­˜" class="headerlink" title="httpç¼“å­˜"></a>httpç¼“å­˜</h4><ol><li>å…ˆæ ¡éªŒæ˜¯å¦è¿‡æœŸ Expires[http1.0]ã€Cache-Control(max-age)[http1.1]</li><li>å†æ ¡éªŒåè®®ä¸­etagå¤´ä¿¡æ¯æ ¡éªŒ</li><li>å†æ ¡éªŒLast-Modified å¤´ä¿¡æ¯æ ¡éªŒ</li></ol><p>æ³¨æ„ï¼š<br>æœ‰æ—¶å€™è¯·æ±‚åˆ°çš„ç¼“å­˜æ–‡ä»¶ï¼Œæ˜æ˜è¯·æ±‚å¤´æ²¡æœ‰åŠ  <code>cache-control</code>ï¼Œä½†è¯·æ±‚å¤´ä¼šæœ‰ <code>Cache-Control: max-age=0</code>ç»æµ‹è¯•å‘ç°chromeä¼šå¯¹htmlã€pngç­‰æ ¼å¼è‡ªå¸¦ï¼Œè€Œå¯¹cssã€jsæ–‡ä»¶ä¸è‡ªå¸¦ï¼Œè¿™ä¸ªæœºåˆ¶å¾ˆå¥½ï¼Œè¿™æ˜¯å› ä¸ºæµè§ˆå™¨ä¼šè‡ªå¸¦è¿™ä¸ªè¯·æ±‚å¤´è®©æœåŠ¡å™¨å»æ£€æŸ¥è¿™ä¸ªæ–‡ä»¶çš„etagæˆ–è€…Last-Modifiedæ˜¯å¦è¿‡æœŸ</p><h4 id="expiresï¼ˆhttp1-0ï¼‰"><a href="#expiresï¼ˆhttp1-0ï¼‰" class="headerlink" title="expiresï¼ˆhttp1.0ï¼‰"></a>expiresï¼ˆhttp1.0ï¼‰</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> <span class="hljs-regexp">~ .*\.(jpg|png)$</span> &#123;<br>    <span class="hljs-attribute">expires</span> <span class="hljs-number">24h</span>;<br>    <span class="hljs-attribute">root</span> /Users/sunqixiong/Pictures;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡è¯·æ±‚å°±ä¼šè¿”å› response</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx">Expires: Thu, 15 <span class="hljs-attribute">Aug</span> <span class="hljs-number">2019</span> <span class="hljs-number">07</span>:<span class="hljs-number">47</span>:<span class="hljs-number">54</span> GMT<br>Cache-Control: max-age=<span class="hljs-number">86400</span><br></code></pre></td></tr></table></figure><p>ç¬¬äºŒæ¬¡è¯·æ±‚è¿”å›304ï¼Œè¿”å› response é™¤äº†ä¸€æ ·ä»¥å¤–ï¼Œå®ƒçš„request header è¿˜æ˜¯å¸¦ä¸Šäº† <code>Cache-Control: max-age=0</code>ï¼Œæ–‡ä»¶æ¥æºè¿˜æ˜¯otherï¼Œå¹¶æ²¡æœ‰ä»cache  memory æ¥ï¼Œå› ä¸ºå®ƒæ˜¯å›¾ç‰‡chromeè‡ªå¸¦Cache-Control:max-age&#x3D;0</p><h4 id="expiresï¼ˆhttp1-1ï¼‰"><a href="#expiresï¼ˆhttp1-1ï¼‰" class="headerlink" title="expiresï¼ˆhttp1.1ï¼‰"></a>expiresï¼ˆhttp1.1ï¼‰</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> /zjmobile &#123;<br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$request_filename</span> <span class="hljs-regexp">~ .*\.(htm|html)$)</span><br>    &#123;<br>        <span class="hljs-attribute">add_header</span> Cache-Control <span class="hljs-literal">no</span>-cache;<br>    &#125;<br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$request_filename</span> <span class="hljs-regexp">~ .*\.(js|css|png|jpg|ttf|eot|svg|jpeg|woff)$)</span><br>    &#123;<br>        <span class="hljs-attribute">add_header</span>  Cache-Control  max-age=<span class="hljs-number">86400</span>;<br>    &#125;<br>    <span class="hljs-attribute">alias</span>   /app/app/enrollment;<br>    <span class="hljs-attribute">index</span>  index.html;<br>    <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html <span class="hljs-literal">last</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="nginx-è·¨åŸŸè®¿é—®"><a href="#nginx-è·¨åŸŸè®¿é—®" class="headerlink" title="nginx è·¨åŸŸè®¿é—®"></a>nginx è·¨åŸŸè®¿é—®</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#è®¾ç½®å…è®¸æ¥è·¨åŸŸè®¿é—®çš„ç½‘ç«™</span><br><span class="hljs-attribute">add_header</span> Access-Control-Allow-Origin *;<br><span class="hljs-comment">#add_header Access-Control-Allow-Origin http://www.jsonc.com;</span><br><span class="hljs-attribute">add_header</span> Access-Control-Allow-Methods GET,POST,PUT,DELETE,OPTIONS<br></code></pre></td></tr></table></figure><h4 id="nginx-é˜²ç›—é“¾"><a href="#nginx-é˜²ç›—é“¾" class="headerlink" title="nginx é˜²ç›—é“¾"></a>nginx é˜²ç›—é“¾</h4><p>http_refer ä¸Šä¸€çº§é¡µé¢çš„åœ°å€</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> / &#123;<br>    <span class="hljs-attribute">valid_referers</span> <span class="hljs-literal">none</span> <span class="hljs-literal">blocked</span> <span class="hljs-number">127.0.0.1</span>;<br>    if($invalid_referer)&#123;<br>        <span class="hljs-attribute">return</span> <span class="hljs-number">403</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æµ‹è¯•é˜²ç›—é“¾æ¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">curl -e <span class="hljs-string">&quot;http://www.baidu.com&quot;</span> -I http://localhost:7676/refer<br>curl -e 127.0.0.1 -I http://localhost:7676/refer<br></code></pre></td></tr></table></figure><h3 id="nginx-ä»£ç†"><a href="#nginx-ä»£ç†" class="headerlink" title="nginx ä»£ç†"></a>nginx ä»£ç†</h3><h4 id="å‘å‘ä»£ç†-æ­£å‘ä»£ç†"><a href="#å‘å‘ä»£ç†-æ­£å‘ä»£ç†" class="headerlink" title="å‘å‘ä»£ç†&#x2F;æ­£å‘ä»£ç†"></a>å‘å‘ä»£ç†&#x2F;æ­£å‘ä»£ç†</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#å‘å‘ä»£ç†</span><br><span class="hljs-section">location</span> /zjmobile/service &#123;<br>    <span class="hljs-attribute">proxy_pass</span> http://tomcat_pool/zjcm/service<br>&#125;<br><span class="hljs-comment">#æ­£å‘ä»£ç†</span><br>location / &#123;<br>    <span class="hljs-attribute">proxy_pass</span> http://<span class="hljs-variable">$http_host</span><span class="hljs-variable">$request_uri</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="å¸¸ç”¨ä»£ç†çš„é…ç½®"><a href="#å¸¸ç”¨ä»£ç†çš„é…ç½®" class="headerlink" title="å¸¸ç”¨ä»£ç†çš„é…ç½®"></a>å¸¸ç”¨ä»£ç†çš„é…ç½®</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> / &#123;<br>    <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:8080;<br>    <span class="hljs-attribute">include</span> proxy_params;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="proxy-params"><a href="#proxy-params" class="headerlink" title="proxy_params"></a>proxy_params</h4><p>æ³¨æ„:proxy bufferè¿™ä¸€å—å…·ä½“æ•°å€¼ï¼Œçœ‹æœåŠ¡å™¨æ•°å€¼å†³å®šã€‚è™½ç„¶å¯ä»¥é€šç”¨ï¼Œä½†å¦‚æœä¸ç†Ÿæ‚‰ï¼Œè¿˜æ˜¯ä¸å»ºè®®ä½¿ç”¨ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxy_redirect</span> default;<br><span class="hljs-attribute">proxy_set_header</span> HOST <span class="hljs-variable">$http_host</span>;<br><span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>; <span class="hljs-comment">#å¸¦ä¸Šç”¨æˆ·çœŸå®çš„ip</span><br><br><span class="hljs-attribute">proxy_connect_timeout</span> <span class="hljs-number">30</span>;<br><br><span class="hljs-attribute">proxy_buffering</span> <span class="hljs-literal">on</span>;<span class="hljs-comment">#æ˜¯å¦å¼€å¯å¯¹åç«¯responseçš„ç¼“å†²</span><br><span class="hljs-attribute">proxy_buffer_size</span> <span class="hljs-number">32k</span>; <span class="hljs-comment">#ç¼“å­˜responseçš„ç¬¬ä¸€éƒ¨åˆ†,é€šå¸¸æ˜¯header,é»˜è®¤proxy_buffer_size è¢«è®¾ç½®æˆ proxy_buffers é‡Œä¸€ä¸ªbuffer çš„å¤§å°ï¼Œå½“ç„¶å¯ä»¥è®¾ç½®æ›´å°äº›ã€‚</span><br><span class="hljs-attribute">proxy_buffers</span> <span class="hljs-number">4</span> <span class="hljs-number">128k</span>;<span class="hljs-comment">#å‰é¢ä¸€ä¸ªæ˜¯num,åé¢ä¸€ä¸ªæ˜¯æ¯ä¸ªbufferçš„size.Nginxå°†ä¼šå°½å¯èƒ½çš„è¯»å–åç«¯æœåŠ¡å™¨çš„æ•°æ®åˆ°bufferï¼Œç›´åˆ°proxy_buffersè®¾ç½®çš„æ‰€æœ‰bufferä»¬è¢«å†™æ»¡æˆ–è€…æ•°æ®è¢«è¯»å–å®Œ(EOF)ï¼Œæ­¤æ—¶Nginxå¼€å§‹å‘å®¢æˆ·ç«¯ä¼ è¾“æ•°æ®ï¼Œä¼šåŒæ—¶ä¼ è¾“è¿™ä¸€æ•´ä¸²bufferä»¬ã€‚å¦‚æœæ•°æ®å¾ˆå¤§çš„è¯ï¼ŒNginxä¼šæ¥æ”¶å¹¶æŠŠä»–ä»¬å†™å…¥åˆ°temp_fileé‡Œå»ï¼Œå¤§å°ç”±proxy_max_temp_file_size æ§åˆ¶ã€‚</span><br><span class="hljs-attribute">proxy_busy_buffers_size</span> <span class="hljs-number">256k</span>;<span class="hljs-comment">#ä¸€æ—¦proxy_buffersè®¾ç½®çš„bufferè¢«å†™å…¥ï¼Œç›´åˆ°bufferé‡Œé¢çš„æ•°æ®è¢«å®Œæ•´çš„ä¼ è¾“å®Œï¼ˆä¼ è¾“åˆ°å®¢æˆ·ç«¯ï¼‰ï¼Œè¿™ä¸ªbufferå°†ä¼šä¸€ç›´å¤„ åœ¨busyçŠ¶æ€ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹è¿™ä¸ªbufferè¿›è¡Œä»»ä½•åˆ«çš„æ“ä½œã€‚æ‰€æœ‰å¤„åœ¨busyçŠ¶æ€çš„buffer sizeåŠ èµ·æ¥ä¸èƒ½è¶…è¿‡proxy_busy_buffers_sizeï¼Œæ‰€ä»¥proxy_busy_buffers_sizeæ˜¯ç”¨æ¥æ§åˆ¶åŒæ—¶ä¼ è¾“åˆ°å®¢æˆ·ç«¯çš„bufferæ•°é‡çš„ã€‚</span><br><span class="hljs-attribute">proxy_max_temp_file_size</span> <span class="hljs-number">128m</span>;<span class="hljs-comment">#é»˜è®¤æƒ…å†µä¸‹proxy_max_temp_file_sizeå€¼ä¸º1024MB,ä¹Ÿå°±æ˜¯è¯´åç«¯æœåŠ¡å™¨çš„æ–‡ä»¶ä¸å¤§äº1Géƒ½å¯ä»¥ç¼“å­˜åˆ°nginxä»£ç†ç¡¬ç›˜ä¸­ï¼Œå¦‚æœè¶…è¿‡1Gï¼Œé‚£ä¹ˆæ–‡ä»¶ä¸ç¼“å­˜ï¼Œè€Œæ˜¯ç›´æ¥ä¸­è½¬å‘é€ç»™å®¢æˆ·ç«¯.å¦‚æœproxy_max_temp_file_sizeè®¾ç½®ä¸º0ï¼Œè¡¨ç¤ºä¸ä½¿ç”¨ä¸´æ—¶ç¼“å­˜ã€‚</span><br></code></pre></td></tr></table></figure><h4 id="nginx-è½®è¯¢"><a href="#nginx-è½®è¯¢" class="headerlink" title="nginx è½®è¯¢"></a>nginx è½®è¯¢</h4><ul><li>RR(é»˜è®¤)</li></ul><p>æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æœåŠ¡å™¨downæ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">upstream</span> tomcats &#123;<br>     <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.107:88</span> max_fails=<span class="hljs-number">3</span> fail_timeout=<span class="hljs-number">3s</span> weight=<span class="hljs-number">9</span>;<br>     <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.132:80</span> max_fails=<span class="hljs-number">3</span> fail_timeout=<span class="hljs-number">3s</span> weight=<span class="hljs-number">9</span>;<br>     <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.137:82</span>  backup;<br>     <span class="hljs-attribute">Server</span> <span class="hljs-number">10.1.1.136:86</span>  backup;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>ip_hash</li></ul><p>æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—®ipçš„hashç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³session(cookie)çš„é—®é¢˜</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">upstream</span> tomcats &#123;<br>    ip_hash;<br>    <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.107:88</span>;<br>    <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.132:80</span>;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>url_hash</li></ul><p>æ ¹æ®è¯·æ±‚çš„$request_uri,ä¸€è‡´çš„è¯ä¼šè¯·æ±‚åŒä¸€å°æœåŠ¡å™¨ï¼Œè¿™ä¸ªåº”ç”¨åœºæ™¯å¾ˆå°‘</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">upstream</span> tomcats &#123;<br>    <span class="hljs-attribute">hash</span> <span class="hljs-variable">$request_uri</span>;<br>    <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.107:88</span>;<br>    <span class="hljs-attribute">server</span> <span class="hljs-number">10.1.1.132:80</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="nginx-å˜é‡è§£æ"><a href="#nginx-å˜é‡è§£æ" class="headerlink" title="nginx å˜é‡è§£æ"></a>nginx å˜é‡è§£æ</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs nginx">$<span class="hljs-attribute">http_host</span>  --localhost:<span class="hljs-number">7676</span>(åŸŸååŠ ç«¯å£)<br><span class="hljs-variable">$host</span>  --localhostï¼ˆåŸŸåï¼‰<br><span class="hljs-variable">$request_uri</span>    -- /zjmobile/css/app.956b573.css<br><span class="hljs-variable">$http_content_type</span>  --text/css<br><br><span class="hljs-comment">#ä¸€äº›å¯æ¶èƒ½ä¼šç”¨åˆ°çš„å˜é‡</span><br><span class="hljs-variable">$request_method</span> <span class="hljs-comment">#å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œï¼Œé€šå¸¸ä¸ºGETæˆ–POSTã€‚</span><br><span class="hljs-variable">$remote_addr</span> <span class="hljs-comment">#å®¢æˆ·ç«¯çš„IPåœ°å€ã€‚</span><br><span class="hljs-variable">$request_uri</span> <span class="hljs-comment">#åŒ…å«è¯·æ±‚å‚æ•°çš„åŸå§‹URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œå¦‚ï¼šâ€/foo/bar.php?arg=bazâ€ã€‚ä¸èƒ½ä¿®æ”¹ã€‚</span><br><span class="hljs-variable">$server_port</span> <span class="hljs-comment">#è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·(è¿™ä¸ªæ‰æ˜¯urlè¾“çš„ç«¯å£)ã€‚</span><br><span class="hljs-variable">$remote_port</span> <span class="hljs-comment">#å®¢æˆ·ç«¯çš„ç«¯å£ã€‚</span><br><span class="hljs-variable">$query_string</span> <span class="hljs-comment">#ä¸argsç›¸åŒã€‚</span><br><span class="hljs-variable">$args</span> <span class="hljs-comment">#è¿™ä¸ªå˜é‡ç­‰äºè¯·æ±‚è¡Œä¸­(GETè¯·æ±‚)çš„å‚æ•°ï¼Œå¦‚ï¼šfoo=123&amp;bar=blahblah;</span><br><span class="hljs-variable">$http_user_agent</span> <span class="hljs-comment">#å®¢æˆ·ç«¯agentä¿¡æ¯</span><br><span class="hljs-variable">$server_protocol</span> <span class="hljs-comment">#è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯HTTP/1.0æˆ–HTTP/1.1ã€‚</span><br><span class="hljs-variable">$server_addr</span> <span class="hljs-comment">#æœåŠ¡å™¨åœ°å€ï¼Œåœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼ã€‚</span><br><span class="hljs-variable">$server_name</span> <span class="hljs-comment">#æœåŠ¡å™¨åç§°ã€‚</span><br></code></pre></td></tr></table></figure><h3 id="nginxç¼“å­˜ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ç¼“å­˜ï¼Œå‡å°‘åç«¯å‹åŠ›ï¼Œæé«˜ç½‘ç«™å¹¶å‘å»¶æ—¶ï¼‰"><a href="#nginxç¼“å­˜ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ç¼“å­˜ï¼Œå‡å°‘åç«¯å‹åŠ›ï¼Œæé«˜ç½‘ç«™å¹¶å‘å»¶æ—¶ï¼‰" class="headerlink" title="nginxç¼“å­˜ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ç¼“å­˜ï¼Œå‡å°‘åç«¯å‹åŠ›ï¼Œæé«˜ç½‘ç«™å¹¶å‘å»¶æ—¶ï¼‰"></a>nginxç¼“å­˜ï¼ˆä»£ç†æœåŠ¡å™¨ç«¯ç¼“å­˜ï¼Œå‡å°‘åç«¯å‹åŠ›ï¼Œæé«˜ç½‘ç«™å¹¶å‘å»¶æ—¶ï¼‰</h3><p>é…ç½®</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-comment">#vim /usr/local/nginx/conf/nginx.conf </span><br><span class="hljs-section">upstream</span> node &#123;<br>    <span class="hljs-attribute">server</span> <span class="hljs-number">192.9.191.31:8081</span>;<br>    <span class="hljs-attribute">server</span> <span class="hljs-number">192.9.191.31:8082</span>;<br>&#125;<br><span class="hljs-attribute">proxy_cache_path</span> /cache levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=xcache:<span class="hljs-number">10m</span> max_size=<span class="hljs-number">10g</span> inactive=<span class="hljs-number">60m</span> use_temp_path=<span class="hljs-literal">off</span>;<br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> www.test.com;<br>    <span class="hljs-attribute">index</span> index.html;<br>    <span class="hljs-section">location</span> / &#123;<br>        <span class="hljs-attribute">proxy_pass</span> http://node;<br>        <span class="hljs-attribute">proxy_cache</span> xcache;<br>        <span class="hljs-attribute">proxy_cache_valid</span>   <span class="hljs-number">200</span> <span class="hljs-number">304</span> <span class="hljs-number">12h</span>;<br>        <span class="hljs-attribute">proxy_cache_valid</span>   any <span class="hljs-number">10m</span>;<br>        <span class="hljs-attribute">add_header</span>  Nginx-Cache <span class="hljs-string">&quot;<span class="hljs-variable">$upstream_cache_status</span>&quot;</span>;<br>        <span class="hljs-attribute">proxy_next_upstream</span> <span class="hljs-literal">error</span> timeout invalid_header http_500 http_502 http_503 http_504;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxy_cache_path</span> /soft/cache levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=cache:<span class="hljs-number">10m</span> max_size=<span class="hljs-number">10g</span> inactive=<span class="hljs-number">60m</span> use_temp_path=<span class="hljs-literal">off</span>;<br><span class="hljs-comment">#proxy_cache    //å­˜æ”¾ç¼“å­˜ä¸´æ—¶æ–‡ä»¶</span><br><span class="hljs-comment">#levels         //æŒ‰ç…§ä¸¤å±‚ç›®å½•åˆ†çº§</span><br><span class="hljs-comment">#keys_zone      //å¼€è¾Ÿç©ºé—´å,10m:å¼€è¾Ÿç©ºé—´å¤§å°,1må¯å­˜æ”¾8000key</span><br><span class="hljs-comment">#max_size       //æ§åˆ¶æœ€å¤§å¤§å°,è¶…è¿‡åNginxä¼šå¯ç”¨æ·˜æ±°è§„åˆ™</span><br><span class="hljs-comment">#inactive       //60åˆ†é’Ÿæ²¡æœ‰è¢«è®¿é—®ç¼“å­˜ä¼šè¢«æ¸…ç†</span><br><span class="hljs-comment">#use_temp_path  //ä¸´æ—¶æ–‡ä»¶,ä¼šå½±å“æ€§èƒ½,å»ºè®®å…³é—­</span><br></code></pre></td></tr></table></figure><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">proxy_cache</span> cache;<br><span class="hljs-attribute">proxy_cache_valid</span>   <span class="hljs-number">200</span> <span class="hljs-number">304</span> <span class="hljs-number">12h</span>;<br><span class="hljs-attribute">proxy_cache_valid</span>   any <span class="hljs-number">10m</span>;<br><span class="hljs-attribute">add_header</span>  Nginx-Cache <span class="hljs-string">&quot;<span class="hljs-variable">$upstream_cache_status</span>&quot;</span>;<br><span class="hljs-attribute">proxy_next_upstream</span> <span class="hljs-literal">error</span> timeout invalid_header http_500 http_502 http_503 http_504;<br><span class="hljs-comment">#proxy_cache            //å¼€å¯ç¼“å­˜</span><br><span class="hljs-comment">#proxy_cache_valid      //çŠ¶æ€ç 200|304çš„è¿‡æœŸä¸º12h,å…¶ä½™çŠ¶æ€ç 10åˆ†é’Ÿè¿‡æœŸ</span><br><span class="hljs-comment">#proxy_cache_key        //ç¼“å­˜key</span><br><span class="hljs-comment">#add_header             //å¢åŠ å¤´ä¿¡æ¯,è§‚å¯Ÿå®¢æˆ·ç«¯respoceæ˜¯å¦å‘½ä¸­</span><br><span class="hljs-comment">#proxy_next_upstream    //å‡ºç°502-504æˆ–é”™è¯¯,ä¼šè·³è¿‡æ­¤å°æœåŠ¡å™¨è®¿é—®ä¸‹ä¸€å°æœåŠ¡å™¨</span><br></code></pre></td></tr></table></figure><p>æ³¨æ„ï¼šå€¼å¾—ä¸€æçš„æ˜¯nginxä»£ç†æœåŠ¡å™¨ç¼“å­˜ï¼Œå¤šæ˜¯ä¸ºäº†ç¼“å­˜æœåŠ¡å™¨çš„èµ„æºæ–‡ä»¶ï¼Œå¦‚æœåªæ˜¯åå‘ä»£ç†æœåŠ¡çš„è¯å°±ä¸ç”¨é…ç½®</p><h4 id="éƒ¨åˆ†é¡µé¢ä¸ç¼“å­˜"><a href="#éƒ¨åˆ†é¡µé¢ä¸ç¼“å­˜" class="headerlink" title="éƒ¨åˆ†é¡µé¢ä¸ç¼“å­˜"></a>éƒ¨åˆ†é¡µé¢ä¸ç¼“å­˜</h4><p>æŸäº›é¡µé¢å¦‚ç™»é™†æ³¨å†Œï¼Œä¸èƒ½ä½¿ç”¨ç¼“å­˜</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">upstream</span> node &#123;<br>        <span class="hljs-attribute">server</span> <span class="hljs-number">192.9.191.31:8081</span>;<br>        <span class="hljs-attribute">server</span> <span class="hljs-number">192.9.191.31:8082</span>;<br>&#125;<br><span class="hljs-attribute">proxy_cache_path</span> /cache levels=<span class="hljs-number">1</span>:<span class="hljs-number">2</span> keys_zone=cache:<span class="hljs-number">10m</span> max_size=<span class="hljs-number">10g</span> inactive=<span class="hljs-number">60m</span> use_temp_path=<span class="hljs-literal">off</span>;<br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;<br>    <span class="hljs-attribute">server_name</span> www.test.com;<br>    <span class="hljs-attribute">index</span> index.html;<br>    <span class="hljs-attribute">if</span> (<span class="hljs-variable">$request_uri</span> <span class="hljs-regexp">~ ^/(static|login|register|password))</span> &#123;<br>            <span class="hljs-attribute">set</span> <span class="hljs-variable">$cookie_nocache</span> <span class="hljs-number">1</span>;<br>            &#125;<br>    <span class="hljs-section">location</span> / &#123;<br>        <span class="hljs-attribute">proxy_pass</span> http://node;<br>        <span class="hljs-attribute">proxy_cache</span>     cache;<br>        <span class="hljs-attribute">proxy_cache_valid</span>       <span class="hljs-number">200</span> <span class="hljs-number">304</span> <span class="hljs-number">12h</span>;<br>        <span class="hljs-attribute">proxy_cache_valid</span>       any     <span class="hljs-number">10m</span>;<br>        <span class="hljs-attribute">add_header</span>      Nginx-Cache     <span class="hljs-string">&quot;<span class="hljs-variable">$upstream_cache_status</span>&quot;</span>;<br>        <span class="hljs-attribute">proxy_next_upstream</span>     <span class="hljs-literal">error</span> timeout invalid_header http_500 http_502 http_503 http_504;<br>        <span class="hljs-attribute">proxy_no_cache</span> <span class="hljs-variable">$cookie_nocache</span> <span class="hljs-variable">$arg_nocache</span> <span class="hljs-variable">$arg_comment</span>;<br>        <span class="hljs-attribute">proxy_no_cache</span> <span class="hljs-variable">$http_pargma</span> <span class="hljs-variable">$http_authorization</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Nginx</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°ä¸€æ¬¡hexo åšå®¢ä¸Šçº¿ ç»éªŒæ€»ç»“</title>
    <link href="/2018/12/03/%E8%AE%B0%E4%B8%80%E6%AC%A1hexo-%E5%8D%9A%E5%AE%A2%E4%B8%8A%E7%BA%BF-%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/"/>
    <url>/2018/12/03/%E8%AE%B0%E4%B8%80%E6%AC%A1hexo-%E5%8D%9A%E5%AE%A2%E4%B8%8A%E7%BA%BF-%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<p>å‰ä¸¤å¤©ä¹°äº†ä¸€å°ç™¾åº¦äº‘æœåŠ¡å™¨èŠ±äº†11å—é’±ï¼ŒèŠ±äº†ç‚¹æ—¶é—´å­¦äº†ä¸‹å¦‚ä½•éƒ¨ç½²hexoåšå®¢ä»¥åŠä¸€äº›æœåŠ¡å™¨æ–¹é¢çš„é…ç½®ï¼Œæ²¡ç”¨hexoæ¨èçš„æ–¹å¼éƒ¨ç½²ã€‚ä¸“é—¨è®°ä¸€ä¸ªæ–‡ç« ã€‚ç³»ç»Ÿç”¨çš„æ˜¯centosï¼Œå…ˆä¸Šå›¾å’Œé“¾æ¥</p><h2 id="åšå®¢åœ°å€"><a href="#åšå®¢åœ°å€" class="headerlink" title="åšå®¢åœ°å€"></a>åšå®¢åœ°å€</h2><p><img src="/img/6114493-3d1caea56828ef4a.webp" alt="preview.png"></p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li>å…ˆç”¨hexoå¿«æ·æ­å»ºæœ¬åœ°blogï¼Œå†æŠŠé¡¹ç›®ä¸Šä¼ åˆ°github </li><li>æœ¬åœ°sshæ— å¯†ç ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼ŒæŠŠæœåŠ¡å™¨çš„é˜²ç«å¢™æ‰“å¼€å¹¶é…ç½®æŒ‡å®šç«¯å£æ‰å¯ä»¥ç™»é™†</li><li>è¿œç¨‹æœåŠ¡å™¨é…ç½® ssh key åå†æŠŠé¡¹ç›®ä»git cloneåˆ°äº‘æœåŠ¡å™¨</li><li>å†ç”¨pm2ï¼Œç›´æ¥æœ¬åœ°å¿«æ·éƒ¨ç½²é¡¹ç›®åˆ°æœåŠ¡å™¨å¹¶é‡å¯</li><li>ä½¿ç”¨nginx è½¬å‘ç«¯å£</li></ol><h2 id="é…ç½®è¦ç‚¹"><a href="#é…ç½®è¦ç‚¹" class="headerlink" title="é…ç½®è¦ç‚¹"></a>é…ç½®è¦ç‚¹</h2><h4 id="å…ˆç”¨hexoå¿«æ·æ­å»ºæœ¬åœ°blog"><a href="#å…ˆç”¨hexoå¿«æ·æ­å»ºæœ¬åœ°blog" class="headerlink" title="å…ˆç”¨hexoå¿«æ·æ­å»ºæœ¬åœ°blog"></a>å…ˆç”¨hexoå¿«æ·æ­å»ºæœ¬åœ°blog</h4><p>é¦–å…ˆè§£é‡Šä¸‹<br>hexo åŸºäºnodejsçš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ï¼Œå®ƒæ˜¯å¸®äººå¿«é€Ÿæ­å»ºä¸ªäººåšå®¢çš„ã€‚<br>PM2æ˜¯nodeè¿›ç¨‹ç®¡ç†å·¥å…·,å¯ä»¥åˆ©ç”¨å®ƒæ¥ç®€åŒ–å¾ˆå¤šnodeåº”ç”¨ç®¡ç†çš„ç¹çä»»åŠ¡,å¦‚æ€§èƒ½ç›‘æ§ã€è‡ªåŠ¨é‡å¯ã€è´Ÿè½½å‡è¡¡ç­‰,è€Œä¸”ä½¿ç”¨éå¸¸ç®€å•ã€‚å°±æ˜¯ä¸€å¼€å§‹ä¸Šæ‰‹æ„Ÿè§‰å¥½å®¹æ˜“æŠ¥é”™ã€‚</p><p>è¿™é‡Œåªå°†ä¸€äº›å®˜ç½‘ä¸Šæ²¡æœ‰çš„ï¼Œå¦‚ä½•æœ¬åœ°è·‘èµ·æ¥ä¸€ä¸ªhexo é¡¹ç›®å’Œéƒ¨ç½²ä¸€ä¸ªä¸»é¢˜è¯·çœ‹å®˜ç½‘ <a href="https://hexo.io/zh-cn/">hexoå®˜ç½‘</a></p><p><code>hexo server</code>  æ˜¯é¡¹ç›® çš„å¯åŠ¨å‘½ä»¤ ï¼Œé»˜è®¤hexoå¯åŠ¨ç«¯å£æ˜¯4000ã€‚ä½†è¿™æ ·å¯åŠ¨é¡¹ç›®ï¼Œnodejsæ˜¯ä¸€ä¸ªå•çº¿ç¨‹é¡¹ç›®ï¼Œä¸‡ä¸€æŸä¸€æ¬¡ç¨‹åºå‡ºé”™ï¼Œé‚£æ•´ä¸ªæœåŠ¡å°±æŒ‚äº†ã€‚æ‰€ä»¥éœ€è¦pm2 æ¥ç›‘æ§è¿™é¡¹çº¿ç¨‹ï¼Œä¸‡ä¸€å‡ºé”™pm2è¿˜èƒ½è‡ªåŠ¨é‡å¯ã€‚</p><p>pm2 å¯åŠ¨å‘½ä»¤ä¸€èˆ¬æ˜¯<code> pm2 start app.js</code>  é‚£å¦‚ä½•ç”¨pm2 æ¥ç®¡ç†hexoå‘¢ï¼Œå¯ä»¥é€šè¿‡åœ¨é¡¹ç›®ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª app.js</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">var spawn = require(<span class="hljs-string">&#x27;child_process&#x27;</span>).spawn;<br>free = spawn(<span class="hljs-string">&#x27;hexo&#x27;</span>, [<span class="hljs-string">&#x27;server&#x27;</span>, <span class="hljs-string">&#x27;-p 4000&#x27;</span>]);/* å…¶å®å°±æ˜¯ç­‰äºæ‰§è¡Œhexo server -p 4000*/<br><br>free.stdout.on(<span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-keyword">function</span> (data) &#123;<br>    console.log(<span class="hljs-string">&#x27;hexo standard output:\n&#x27;</span> + data);<br>&#125;);<br><br>free.stderr.on(<span class="hljs-string">&#x27;data&#x27;</span>, <span class="hljs-keyword">function</span> (data) &#123;<br>    console.log(<span class="hljs-string">&#x27;hexo standard error output:\n&#x27;</span> + data);<br>&#125;);<br><br>free.on(<span class="hljs-string">&#x27;exit&#x27;</span>, <span class="hljs-keyword">function</span> (code, signal) &#123;<br>    console.log(<span class="hljs-string">&#x27;hexo child process eixt ,exit:&#x27;</span> + code);<br>&#125;);<br></code></pre></td></tr></table></figure><p>å¦‚æ­¤ä¸€æ¥åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹  å°±èƒ½ç”¨ <code>pm2 start app.js</code> æ¥è·‘hexoé¡¹ç›®äº†</p><h4 id="æœ¬åœ°sshæ— å¯†ç ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨-ssh-key-é…ç½®"><a href="#æœ¬åœ°sshæ— å¯†ç ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨-ssh-key-é…ç½®" class="headerlink" title="æœ¬åœ°sshæ— å¯†ç ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ ssh key é…ç½®"></a>æœ¬åœ°sshæ— å¯†ç ç™»é™†è¿œç¨‹æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ ssh key é…ç½®</h4><p>åˆæ¬¡é…ç½®çš„äº‘æœåŠ¡å™¨éœ€è¦å®‰è£…è¿™äº›å·¥å…·åŒ…</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo yum <span class="hljs-keyword">install </span>vim openssl <span class="hljs-keyword">build-essential </span>libssl-dev wget curl git<br>yum <span class="hljs-keyword">install </span>gcc-c++<br></code></pre></td></tr></table></figure><p>æœ¬åœ°é…ç½®ssh key</p><ol><li>æœ¬åœ° cd &#x2F;</li><li>cd .ssh  æˆ–è€… open ~&#x2F;.ssh  </li><li>ls<br> <code>id_rsa  id_rsa.pub  known_hosts</code></li><li>å¤‡ä»½<br><code> mv id_rsa id_rsa_backup</code><br><code>mv id_rsa.pub id_rsa_backup.pub</code></li><li>ç”Ÿæˆsshå…¬é’¥<br><code>ssh-keygen -t rsa -b 4096 -C &quot;931035063@qq.com&quot; </code></li><li>æŸ¥çœ‹<br><code>cat id_rsa</code><br><code>cat id_rsa.pub</code></li><li>keyä½œç”¨ç”Ÿæ•ˆ<br><code>eval &quot;$(ssh-agent -s)&quot;</code><br><code>ssh-add ~/.ssh/id_rsa</code></li><li>ç„¶ååœ¨è¿ä¸Š<strong>è¿œç¨‹æœåŠ¡å™¨</strong> <code>cd ~/.ssh</code> ,ç¼–è¾‘æœåŠ¡å™¨ç«¯æˆæƒæ–‡ä»¶ <code>vi authorized_keys</code></li><li>åœ¨åœ¨<strong>å®¢æˆ·ç«¯</strong> è¾“å…¥ <code>cat id_rsa.pub</code>å°†å¸¦æœ‰é‚®ç®±çš„å…¬é’¥å¤åˆ¶è¿›å»ï¼Œå†:wq!é€€å‡ºauthorized_keys</li><li>é…ç½®ç”Ÿæ•ˆ <code>sudo service sshd restart</code> </li><li>ç„¶åå°±å¯ä»¥ç›´æ¥é€šè¿‡ ssh <a href="mailto:&#114;&#111;&#111;&#x74;&#x40;&#x78;&#120;&#x2e;&#x78;&#x78;&#46;&#120;&#120;&#x2e;&#x78;&#120;">&#114;&#111;&#111;&#x74;&#x40;&#x78;&#120;&#x2e;&#x78;&#x78;&#46;&#120;&#120;&#x2e;&#x78;&#120;</a> æ¥å…å¯†ç  ç™»é™†äº†</li></ol><p>æ³¨æ„ç‚¹:</p><ul><li>å› ä¸ºæˆ‘è¿ä¸Šäº‘æœåŠ¡å™¨åä¹Ÿæ²¡åˆ›å»ºæ–°ç”¨æˆ·ï¼Œç›´æ¥ç”¨root ç¼–è¾‘çš„ï¼Œå…¶ä»–äººé…ç½®æ˜¯è¦æ³¨æ„ä¸€ä¸‹ æƒé™é—®é¢˜ï¼Œæˆ‘çœ‹ç½‘ä¸Šä¹Ÿæœ‰ä¸å°‘äººå› ä¸ºæƒé™é—®é¢˜è€Œç”Ÿæ•ˆå¤±è´¥</li><li>å¦‚æœè¿˜æ˜¯é…ç½®æ²¡ç”Ÿæ•ˆï¼Œéœ€è¦çœ‹ä¸€ä¸‹  <a href="https://www.cnblogs.com/jingwu/articles/5598340.html">sshd_configé…ç½®è¯¦è§£</a><br>RSAAuthentication yes<br>PubkeyAuthentication yes<br>è¿™ä¸¤é¡¹ä¸èƒ½ä¸ºno</li><li>è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹ï¼Œæ¯æ¬¡sshç™»é™†è¾“ipå¤ªè¿‡äºéº»çƒ¦ï¼Œå½“ç„¶ä½ ç”¨secureCRTè¿™æ ·çš„å·¥å…·å½“æˆ‘æ²¡è¯´, <strong>åœ¨macä¸‹é¢ å¯ä»¥é…ç½®å¿«æ·è¿æ¥äº‘æœåŠ¡å™¨çš„å‘½ä»¤</strong><br>â€“ åœ¨<code>sudo vim ~/.bashrc</code><br>â€“ æ–°åŠ  <code>alias ssh_baiduyun=&quot;ssh root@xx.xx.xx.xx&quot;</code><br>â€“ <code>source .bashrc</code> ä»¥åå³å¯é€šè¿‡ <code>ssh_baiduyun</code> è¿æ¥æœåŠ¡å™¨</li><li>å†é‡ç”³ä¸€ç‚¹ æœ¬åœ°çš„ <code>id_rsa.pub</code> å¯¹åº”çš„æ˜¯ æœåŠ¡å™¨ä¸Šçš„ <code>authorized_keys</code>,ä¸¤ä¸ªå¤åˆ¶é”™äº†å°±å°´å°¬äº†</li></ul><h4 id="åœ¨æœåŠ¡å™¨é…ç½®sshå¹¶clone-git-é¡¹ç›®"><a href="#åœ¨æœåŠ¡å™¨é…ç½®sshå¹¶clone-git-é¡¹ç›®" class="headerlink" title="åœ¨æœåŠ¡å™¨é…ç½®sshå¹¶clone git é¡¹ç›®"></a>åœ¨æœåŠ¡å™¨é…ç½®sshå¹¶clone git é¡¹ç›®</h4><p>ç”ŸæˆæœåŠ¡å™¨ç«¯å…¬é’¥ å’Œæœ¬åœ°ä¸€æ ·<br><code>cd ~/.ssh</code><br><code>ssh-keygen -t rsa -b 4096 -C &quot;931035063@qq.com&quot;</code><br><code>eval &quot;$(ssh-agent -s)&quot;</code><br><code>ssh-add ~/.ssh/id_rsa</code><br>ç”Ÿæ•ˆ,centos ä¸‹<code>service sshd restart</code><br>æŠŠ  <code>id_rsa.pub</code> é‡Œé¢çš„å†…å®¹ æ”¾åˆ°git è´¦æˆ·é‡Œé¢ssh é…ç½®é‡Œ<br><img src="/img/6114493-9b765e356cd0a732.webp" alt="Screenshot 2018-12-02_23-25-37.png"><br><strong>æ³¨æ„ï¼ï¼</strong> åœ¨æœåŠ¡å™¨é‡Œä½ å‡†å¤‡clone é¡¹ç›®çš„æ–‡ä»¶å¤¹é‡Œ å…ˆç”¨ssh clone ä¸€é <code>git@github.com:SHpoi/my-blog.git</code> ç¬¬ä¸€æ¬¡git clone ä¼šæœ‰ç¡®è®¤é¡¹ï¼Œä¸ç„¶åé¢ç”¨pm2éƒ¨ç½²è€æ˜¯ä¼šé‡åˆ°ä¸€ä¸ªæ‹‰å–é¡¹ç›®ä¸ºç©ºçš„æŠ¥é”™ã€‚</p><h4 id="åœ¨æœåŠ¡å™¨é…ç½®nodejsç¯å¢ƒ"><a href="#åœ¨æœåŠ¡å™¨é…ç½®nodejsç¯å¢ƒ" class="headerlink" title="åœ¨æœåŠ¡å™¨é…ç½®nodejsç¯å¢ƒ"></a>åœ¨æœåŠ¡å™¨é…ç½®nodejsç¯å¢ƒ</h4><p>æœåŠ¡å™¨é…ç½®nodejs ç”¨çš„æ˜¯nvmï¼Œå®‰è£…nvm</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">wget -qO- https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/creationix/</span>nvm<span class="hljs-regexp">/v0.33.2/i</span>nstall.sh | bash<br></code></pre></td></tr></table></figure><p><strong>nvm å®‰è£…ä»¥åé‡æ–°è¿æ¥äº‘æœåŠ¡å™¨</strong>ï¼Œä¸ç„¶ç¯å¢ƒå˜é‡ä¸ä¼šç”Ÿæ•ˆ<br>nvmå®‰è£…nodejsï¼Œä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nvm</span> install v8.<span class="hljs-number">9</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">nvm</span> use v8.<span class="hljs-number">9</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">nvm</span> alias default v8.<span class="hljs-number">9</span>.<span class="hljs-number">0</span><br><span class="hljs-attribute">npm</span> --registry=https://registry.npm.taobao.org install -g npm<br></code></pre></td></tr></table></figure><p>æ‹‰å–å®Œä»¥åè®°å¾—å…ˆè¯•ç”¨<code>hexo server</code>ç€èƒ½ä¸èƒ½è·‘èµ·æ¥,è¿›å…¥æ–‡ä»¶å¤¹å…ˆ<code>npm install</code>å†çœ‹è¿˜å·®ä»€ä¹ˆå…¶ä»–çš„å…¨å±€ä¾èµ–</p><h4 id="åœ¨æœ¬åœ°ä½¿ç”¨pm2-ä¸€é”®éƒ¨ç½²äº‘æœåŠ¡å™¨ä¸Šçš„é¡¹ç›®"><a href="#åœ¨æœ¬åœ°ä½¿ç”¨pm2-ä¸€é”®éƒ¨ç½²äº‘æœåŠ¡å™¨ä¸Šçš„é¡¹ç›®" class="headerlink" title="åœ¨æœ¬åœ°ä½¿ç”¨pm2 ä¸€é”®éƒ¨ç½²äº‘æœåŠ¡å™¨ä¸Šçš„é¡¹ç›®"></a>åœ¨æœ¬åœ°ä½¿ç”¨pm2 ä¸€é”®éƒ¨ç½²äº‘æœåŠ¡å™¨ä¸Šçš„é¡¹ç›®</h4><p>è¿™ä¸€å—çœŸçš„æ˜¯è¡€æ³ªå•Šï¼Œå°±2è¡Œå‘½ä»¤è¡Œï¼ŒæŠ¥çš„é”™æŸ¥äº†ä¸€ä¸‹åˆã€‚</p><ol><li>åœ¨æœ¬åœ°é¡¹ç›®ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª ecosystem.jsonï¼Œä¸app.jså¹³çº§<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs ada">&#123;<br>  <span class="hljs-string">&quot;apps&quot;</span> : [&#123;<br>    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;myApp&quot;</span>,<br>    <span class="hljs-string">&quot;script&quot;</span>: <span class="hljs-string">&quot;app.js&quot;</span>,<br>    <span class="hljs-string">&quot;instances&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;autorestart&quot;</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&quot;env&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;NODE_ENV&quot;</span>: <span class="hljs-string">&quot;development&quot;</span><br>    &#125;,<br>    <span class="hljs-string">&quot;env_production&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;NODE_ENV&quot;</span>: <span class="hljs-string">&quot;production&quot;</span><br>    &#125;<br>  &#125;],<br>  <span class="hljs-string">&quot;deploy&quot;</span> : &#123;<br>    <span class="hljs-string">&quot;production&quot;</span> : &#123;<br>      <span class="hljs-string">&quot;user&quot;</span> : &quot;<span class="hljs-type">root</span><span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>host<span class="hljs-string">&quot; : &quot;</span>xx.xx.xx.xx<span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>port<span class="hljs-string">&quot; : &quot;</span><span class="hljs-number">22</span><span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>ssh_options<span class="hljs-string">&quot;: &quot;</span>StrictHostKeyChecking=no<span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>ref<span class="hljs-string">&quot;  : &quot;</span>origin/master<span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>repo<span class="hljs-string">&quot; : &quot;</span>git@github.com:SHpoi/my-blog.git<span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>path<span class="hljs-string">&quot; : &quot;</span>/root/www/myblog/<span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>env<span class="hljs-string">&quot;: &#123;</span><br><span class="hljs-string">        &quot;</span>NODE_ENV<span class="hljs-string">&quot;: &quot;</span>production<span class="hljs-string">&quot;</span><br><span class="hljs-string">      &#125;,</span><br><span class="hljs-string">      &quot;</span>pre-setup<span class="hljs-string">&quot;: &quot;</span>rm -rf /var/www/myblog/production/source<span class="hljs-string">&quot;,</span><br><span class="hljs-string">      &quot;</span>post-deploy<span class="hljs-string">&quot; : &quot;</span>npm install &amp;&amp; pm2 startOrRestart ecosystem.json <span class="hljs-comment">--env production&quot;,</span><br>      <span class="hljs-string">&quot;env&quot;</span>  : &#123;<br>        <span class="hljs-string">&quot;NODE_ENV&quot;</span>: <span class="hljs-string">&quot;production&quot;</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>ç„¶åè¿è¡Œ2è¡Œå‘½ä»¤ ç¬¬ä¸€è¡Œåœ¨äº‘æœåŠ¡å™¨æ­å»ºè¿è¡Œç¯å¢ƒï¼Œç¬¬äºŒè¡Œæ¯æ¬¡é‡æ–°å‘å¸ƒé¡¹ç›®éœ€è¦<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">pm2 deploy ecosystem.<span class="hljs-keyword">json </span>production setup<br>æ³¨æ„æœ‰å·¨å‘ï¼Œç¬¬ä¸€æ¬¡ssh <span class="hljs-keyword">clone </span>ä¼šæ ¡éªŒï¼Œè¦å…ˆåœ¨è¯¥ç›®å½•ä¸‹<span class="hljs-keyword">clone </span>ä¸€égit ssh è¿æ¥ï¼Œä¹‹åæ‰ä¼šæˆåŠŸã€‚ä¸ç„¶ä¼šä¸€ç›´æŠ¥ç©ºé“¾æ¥<br>pm2 deploy ecosystem.<span class="hljs-keyword">json </span>production --force<br>forceä¸€å®šè¦åŠ ä¸ç„¶gitä¼šæŠ¥å†²çªä¸è§£å†³<br></code></pre></td></tr></table></figure>ä»¥åæ¯æ¬¡å‘å¸ƒåšå®¢<br><code>hexo new  &#39;è®°ä¸€æ¬¡hexo åšå®¢ä¸Šçº¿ ç»éªŒæ€»ç»“&#39;</code> ç”Ÿæˆmdæ–‡ä»¶ï¼Œå†™å®Œä»¥åæäº¤åˆ°gitä»“åº“<br>å†ç”¨å‘½ä»¤è¡Œåœ¨æœ¬åœ°é¡¹ç›®æ‰§è¡Œä¸‹ <code>pm2 deploy ecosystem.json production --force</code> å³å¯</li></ol><h5 id="pm2-é…ç½®æ³¨æ„ç‚¹"><a href="#pm2-é…ç½®æ³¨æ„ç‚¹" class="headerlink" title="pm2 é…ç½®æ³¨æ„ç‚¹"></a>pm2 é…ç½®æ³¨æ„ç‚¹</h5><ul><li><p><code>pm2 deploy ecosystem.json production --force</code> forceä¸€å®šè¦åŠ ä¸ç„¶gitä¼šæŠ¥å†²çªä¸è§£å†³</p></li><li><p>è¿è¡Œsetupå‘½ä»¤æ—¶ ç¬¬ä¸€æ¬¡ssh clone ä¼šæ ¡éªŒï¼Œè¦å…ˆåœ¨è¯¥ç›®å½•ä¸‹clone ä¸€égit ssh è¿æ¥ï¼Œä¹‹åæ‰ä¼šæˆåŠŸã€‚ä¸ç„¶ä¼šä¸€ç›´æŠ¥ç©ºé“¾æ¥ã€‚ç¬¬ä¸€æ¬¡cloneå®Œåˆ äº†å³å¯ã€‚</p></li><li><p>å¯åŠ¨å‰å…ˆåˆ äº†sourceé‡Œé¢çš„git ä»£ç ï¼Œä¸ç„¶pm2 ä¼šæŠ¥å†²çªä¸è§£å†³è€Œéƒ¨ç½²å¤±è´¥</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-string">&quot;pre-setup&quot;</span>: <span class="hljs-string">&quot;rm -rf /var/www/myblog/production/source&quot;</span>,<br>- éƒ¨ç½²åè¿è¡Œ å‘½ä»¤è¿›è¡Œé¡¹ç›®ä¾èµ–åŒ…å®‰è£… å†è·‘èµ·æ¥hexoé¡¹ç›® <br><span class="hljs-string">&quot;post-deploy&quot;</span> : &quot;<span class="hljs-type">npm</span> install &amp;&amp; pm2 startOrRestart ecosystem.json <span class="hljs-comment">--env production&quot;,</span><br></code></pre></td></tr></table></figure></li><li><p><code>&quot;script&quot;: &quot;app.js&quot;</code> ä¸ºäº†è®©json æ‰¾åˆ°app.js,æ‰€ä»¥æ”¾å¹³çº§ï¼Œè¿™ä¸ªjsonæ–‡ä»¶å¦‚æœä¸æ˜¯ç§æœ‰ä»“åº“ä¸å»ºè®®æäº¤ï¼Œå½“ç„¶æˆ‘æ˜¯æäº†ï¼Œä¸è¿‡ä½ ä»¬æœ‰é«˜æ‰‹åƒä¸‡åˆ«çœ‹äº†æˆ‘çš„gité¡¹ç›®çš„é…ç½®æ–‡ä»¶å°±æ”»å‡»å®ƒï¼Œæ´»åŠ¨ä¹°çš„åŠ ä¸ŠåŸŸåæœåŠ¡å°±12å—é’±ã€‚</p></li><li><p><code>/root/www/myblog/</code> æˆ‘æ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ç™»è¿›å»å°±èƒ½æ‰¾é¡¹ç›®æ‰æ”¾rootä¸‹çš„ã€‚è¿˜æœ‰è¿™ä¸ªç›®å½•éœ€å…ˆåˆ›å»ºï¼Œä¸ç„¶pm2ä¸çŸ¥é“éƒ¨ç½²åœ¨å“ªã€‚</p></li><li><p><code>pm2 deploy ecosystem.json  production setup </code> æœ‰æ—¶å€™è¿˜éœ€è¦å†æ¬¡æ‰§è¡Œï¼Œå› ä¸ºæœ‰æ—¶å€™ä¼šå‡ºç°è¿™ç§é”™è¯¯ <code>bash: line 0: cd: /root/www/myblog/source: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•</code></p></li></ul><h4 id="nginxé…ç½®"><a href="#nginxé…ç½®" class="headerlink" title="nginxé…ç½®"></a>nginxé…ç½®</h4><p>è¿™ä¸€å—æ²¡å•¥è¯´çš„ æ— éå°±æ˜¯ç«¯å£è½¬å‘ï¼Œ 80è½¬4000<br>nginx å®‰è£…</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">sudo yum <span class="hljs-keyword">install</span> nginx<br></code></pre></td></tr></table></figure><p><strong>å®‰è£…å®Œé‡è¿æœåŠ¡å™¨ï¼Œä¸ç„¶æ€ä¹ˆè¾“å‘½ä»¤é…ç½®éƒ½ä¸ç”Ÿæ•ˆ</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">upstream</span> myblog&#123;<br> <span class="hljs-attribute">server</span> localhost:<span class="hljs-number">4000</span>;<br>&#125;<br><br><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span>  <span class="hljs-number">80</span> ;<br>    <span class="hljs-attribute">server_name</span>  www.sunqx.top;<br><br>    <span class="hljs-section">location</span> / &#123;<br>          <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;<br>          <span class="hljs-attribute">proxy_set_header</span> X-Forward-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>          <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$http_host</span>;<br>          <span class="hljs-attribute">proxy_set_header</span> X-Nginx-Proxy <span class="hljs-literal">true</span>;<br>          <span class="hljs-attribute">proxy_pass</span> http://myblog;<br>          <span class="hljs-attribute">proxy_redirect</span> <span class="hljs-literal">off</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>nginx é…ç½®ç”Ÿæ•ˆ</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo nginx -t </span><br><span class="hljs-attribute">sudo nginx -s reload</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nginx</tag>
      
      <tag>pm2</tag>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ionic webview in native(android)</title>
    <link href="/2018/11/25/ionic-webview-in-native-android/"/>
    <url>/2018/11/25/ionic-webview-in-native-android/</url>
    
    <content type="html"><![CDATA[<p>å…¶å®å¼€å‘äº†è¿™ä¹ˆä¹…ï¼Œwebviewçš„ä¼˜ç‚¹å¾ˆå¤šï¼Œçƒ­æ›´æ–°ã€è·¨å¹³å°å¼€å‘ã€æ˜“ç»´æŠ¤ã€‚ä½†æ˜¯å±€é™æ€§ä¹Ÿå¾ˆå¤§ï¼Œä¸€äº›åŸç”Ÿçš„åŠŸèƒ½è¿˜æ˜¯ç”¨åŸç”Ÿæ’ä»¶æœ€å¥½ã€‚webview webviewï¼ŒåŠŸèƒ½åªæ˜¯web ç”¨æ¥ view çš„ã€‚æŠŠç½‘é¡µå½“ä½œnative é‡Œçš„ä¸€ä¸ªæ¨¡å—æˆ–æ’ä»¶æœ€å¥½ã€‚å¥½ä¹…æ²¡æ›´æ–°blogäº†ï¼Œæ›´æ–°ä¸€æ³¢è®©è‡ªå·±è®°ä½ã€‚<br>æŠŠionic éƒ¨ç½²åˆ°androidåŸç”Ÿåº”ç”¨é‡Œé¢</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">MainActivity<br>public <span class="hljs-keyword">class</span> MainActivity extends AppCompatActivity &#123;<br>    <span class="hljs-keyword">private</span>  View cv;<br>    @Override<br>    protected void on<span class="hljs-constructor">Create(Bundle <span class="hljs-params">savedInstanceState</span>)</span> &#123;<br>        super.on<span class="hljs-constructor">Create(<span class="hljs-params">savedInstanceState</span>)</span>;<br>        set<span class="hljs-constructor">ContentView(R.<span class="hljs-params">layout</span>.<span class="hljs-params">activity_main</span>)</span>;<br>        cv = get<span class="hljs-constructor">Window()</span>.get<span class="hljs-constructor">DecorView()</span>;<br>        find<span class="hljs-constructor">ViewById(R.<span class="hljs-params">id</span>.<span class="hljs-params">ionic</span>)</span>.set<span class="hljs-constructor">OnClickListener(<span class="hljs-params">cordovaViewClickListener</span>)</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> View.OnClickListener cordovaViewClickListener=<span class="hljs-keyword">new</span> View.<span class="hljs-constructor">OnClickListener()</span> &#123;<br>        @Override<br>        public void on<span class="hljs-constructor">Click(View <span class="hljs-params">v</span>)</span>&#123;<br>            start<span class="hljs-constructor">CordovaActivity(<span class="hljs-params">cv</span>)</span>;<br>        &#125;<br>    &#125;;<br><br>    public void start<span class="hljs-constructor">CordovaActivity(View <span class="hljs-params">view</span>)</span> &#123;<br>        <span class="hljs-comment">// é¡¹ç›®ç”¨çš„æ–¹å¼</span><br>        <span class="hljs-comment">//Intent intent = new Intent(this, TestCordovaActivity.class);</span><br>        <span class="hljs-comment">//ionic ç°åœ¨åº”ç”¨çš„æ–¹å¼</span><br>        Intent intent = <span class="hljs-keyword">new</span> <span class="hljs-constructor">Intent(<span class="hljs-params">this</span>, IonicActivity.<span class="hljs-params">class</span>)</span>;<br>        start<span class="hljs-constructor">Activity(<span class="hljs-params">intent</span>)</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹çœ‹ionic å¦‚ä½•åµŒå¥—webviewçš„ï¼Œactivityæ— éœ€xml</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IonicActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CordovaActivity</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    public void onCreate(<span class="hljs-type">Bundle</span> savedInstanceState)<br>    &#123;<br>        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);<br><br>        <span class="hljs-comment">// enable Cordova apps to be started in the background</span><br>        <span class="hljs-type">Bundle</span> extras = getIntent().getExtras();<br>        <span class="hljs-keyword">if</span> (extras != <span class="hljs-literal">null</span> &amp;&amp; extras.getBoolean(<span class="hljs-string">&quot;cdvStartInBackground&quot;</span>, <span class="hljs-literal">false</span>)) &#123;<br>            moveTaskToBack(<span class="hljs-literal">true</span>);<br>        &#125;<br><br>        <span class="hljs-comment">// Set by &lt;content src=&quot;index.html&quot; /&gt; in config.xml</span><br>        loadUrl(<span class="hljs-string">&quot;file:///android_asset/ionic/index.html&quot;</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬é¡¹ç›®ç»„åµŒå¥—nativeçš„æ–¹å¼ï¼Œæ•ˆæœä¸Šå’Œæ˜¯ä¸€æ ·çš„</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">public <span class="hljs-keyword">class</span> TestCordovaActivity extends Activity &#123;<br><br>    SystemWebView webView;<br>    public void on<span class="hljs-constructor">Create(Bundle <span class="hljs-params">savedInstanceState</span>)</span> &#123;<br>        super.on<span class="hljs-constructor">Create(<span class="hljs-params">savedInstanceState</span>)</span>;<br>        set<span class="hljs-constructor">ContentView(R.<span class="hljs-params">layout</span>.<span class="hljs-params">content_frame</span>)</span>;<br>        init<span class="hljs-constructor">CordovaWebView()</span>;<br>    &#125;<br><br>    public CordovaInterfaceImpl cordovaInterface;<br>    <span class="hljs-keyword">private</span> CordovaWebView cordovaWebView;<br>    public final ArrayBlockingQueue&lt;String&gt; onPageFinishedUrl = <span class="hljs-keyword">new</span> ArrayBlockingQueue&lt;String&gt;(<span class="hljs-number">5</span>);<br>    public void init<span class="hljs-constructor">CordovaWebView()</span> &#123;<br>        cordovaInterface = <span class="hljs-keyword">new</span> <span class="hljs-constructor">CordovaInterfaceImpl(<span class="hljs-params">this</span>)</span> &#123;<br>            @Override<br>            public Object on<span class="hljs-constructor">Message(String <span class="hljs-params">id</span>, Object <span class="hljs-params">data</span>)</span> &#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;onPageFinished&quot;</span>.equals(id)) &#123;<br>                    onPageFinishedUrl.add((String) data);<br>                &#125;<br>                return super.on<span class="hljs-constructor">Message(<span class="hljs-params">id</span>, <span class="hljs-params">data</span>)</span>;<br>            &#125;<br>        &#125;;<br>        ConfigXmlParser parser = <span class="hljs-keyword">new</span> <span class="hljs-constructor">ConfigXmlParser()</span>;<br>        parser.parse(this);<br>        webView = (SystemWebView) find<span class="hljs-constructor">ViewById(R.<span class="hljs-params">id</span>.<span class="hljs-params">aiCordovaWebView</span>)</span>;<br>        SystemWebViewEngine systemWebViewEngine = <span class="hljs-keyword">new</span> <span class="hljs-constructor">SystemWebViewEngine(<span class="hljs-params">webView</span>)</span>;<br>        <span class="hljs-comment">//å…è®¸JavaScriptæ‰§è¡Œ</span><br>        webView.get<span class="hljs-constructor">Settings()</span>.set<span class="hljs-constructor">JavaScriptEnabled(<span class="hljs-params">true</span>)</span>;<br>        this.cordovaWebView = <span class="hljs-keyword">new</span> <span class="hljs-constructor">CordovaWebViewImpl(<span class="hljs-params">systemWebViewEngine</span>)</span>;<br>        this.cordovaWebView.init(this.cordovaInterface, parser.get<span class="hljs-constructor">PluginEntries()</span>, parser.get<span class="hljs-constructor">Preferences()</span>);<br>        this.cordovaWebView.load<span class="hljs-constructor">Url(<span class="hljs-string">&quot;file:///android_asset/ionic/index.html&quot;</span>)</span>;<br><br>    &#125;<br><br><br>    @Override<br>    public void on<span class="hljs-constructor">ActivityResult(<span class="hljs-params">int</span> <span class="hljs-params">requestCode</span>, <span class="hljs-params">int</span> <span class="hljs-params">resultCode</span>, Intent <span class="hljs-params">intent</span>)</span> &#123;<br>        super.on<span class="hljs-constructor">ActivityResult(<span class="hljs-params">requestCode</span>, <span class="hljs-params">resultCode</span>, <span class="hljs-params">intent</span>)</span>;<br>        this.cordovaInterface.on<span class="hljs-constructor">ActivityResult(<span class="hljs-params">requestCode</span>, <span class="hljs-params">resultCode</span>, <span class="hljs-params">intent</span>)</span>;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹åº”çš„xml</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&lt;org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.cordova</span><span class="hljs-selector-class">.engine</span><span class="hljs-selector-class">.SystemWebView</span><br>        android:id=<span class="hljs-string">&quot;@+id/aiCordovaWebView&quot;</span><br>        android:layout_width=<span class="hljs-string">&quot;match_parent&quot;</span><br>        android:layout_height=<span class="hljs-string">&quot;match_parent&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢å°±æ˜¯ä¸»è¦ä»£ç ï¼Œè‡³äºå…¶ä»–çš„æ­¥éª¤ï¼Œç½‘ä¸Šå…¶ä»–blog éƒ½æœ‰ï¼Œç°åœ¨æœ‰ä¸€ä¸ªnativeçš„åº”ç”¨ï¼Œè¿˜æœ‰ä¸€ä¸ªionic build å‡ºæ¥çš„android é¡¹ç›®</p><ol><li>æŠŠwwwæ–‡ä»¶å¤¹æ”¾åœ¨android assets èµ„æºç›®å½•ä¸‹ï¼Œæˆ‘æ”¹åå«ionic æ–‡ä»¶å¤¹äº†</li><li>src&#x2F;main&#x2F;res&#x2F;xml é‡Œé¢çš„config.xml æ–‡ä»¶è¦ä»ionic buildçš„androidé¡¹ç›®é‡ŒæŒªè¿‡æ¥ï¼Œè¿™ä¸ªæ–‡ä»¶å¾ˆé‡è¦ï¼Œé‡Œé¢æœ‰å„ç§cordovaæ’ä»¶æ‰€ç”¨çš„javaä¾èµ–é…ç½®,ä½¿ç”¨commandæˆ–è€…ctrl ç‚¹å‡»æŸä¸€é¡¹çœ‹èƒ½ä¸èƒ½è·³åˆ°javaæ–‡ä»¶ï¼Œä¸ç„¶æ‰¾ä¸åˆ°é¡¹ç›®æ˜¯ä¼šæŠ¥é”™çš„ã€‚ </li><li>AndroidManifest.xml é‡Œé¢è¿˜è¦åŠ å„ç§å„æ ·çš„æƒé™ï¼ŒåŒç†æŒªè¿‡æ¥ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªæ³¨æ„çš„åœ°æ–¹<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-comment">&lt;!-- androidç½‘ç»œè¯·æ±‚æƒé™ --&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">uses-permission</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.permission.INTERNET&quot;</span> /&gt;</span></span><br><span class="language-xml"> <span class="hljs-comment">&lt;!-- è¿™ä¸ªç‰¹åˆ«é‡è¦ï¼ï¼ï¼ï¼ï¼ï¼ä¸ç„¶å¯èƒ½ç›¸æœºä¸èƒ½ç”¨ --&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">provider</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.support.v4.content.FileProvider&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">android:authorities</span>=<span class="hljs-string">&quot;$</span></span></span><span class="hljs-template-variable">&#123;applicationId&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">.provider&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">android:exported</span>=<span class="hljs-string">&quot;false&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">            <span class="hljs-attr">android:grantUriPermissions</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">meta-data</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.support.FILE_PROVIDER_PATHS&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">android:resource</span>=<span class="hljs-string">&quot;@xml/provider_paths&quot;</span> /&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">provider</span>&gt;</span></span><br></code></pre></td></tr></table></figure>è¿˜æœ‰å°±æ˜¯ cordova çš„sqllite pluginï¼Œå¦‚æœç”¨åˆ°äº†æ³¨æ„æŠŠå®ƒçš„2ä¸ªjaråŒ…æ”¾è¿›é¡¹ç›®ä¾èµ–é‡Œé¢ï¼Œsqlite-connector.jarã€sqlite-native-driver.jar åˆ«æ¼äº†ï¼Œä¸ç„¶å¯èƒ½ä¼šé‡åˆ°å¥‡æ€ªçš„æŠ¥é”™ï¼Œå½“æ—¶è¿˜æ˜¯åœ¨ stackflow æ‰çŸ¥é“ä»€ä¹ˆæƒ…å†µ</li><li>æœ€åä¸€ç‚¹åˆ«å¿˜è®°ï¼ŒæŠŠcordovaçš„jaråŒ…ä»¥åŠcordovaæ’ä»¶çš„jaråŒ…æˆ–è€…æ¨¡å—æ‹·è¿‡æ¥ã€‚</li><li>ç›´æ¥ç”¨android studio è·‘èµ·æ¥çœ‹ä¸€ä¸‹å§</li></ol>]]></content>
    
    
    <categories>
      
      <category>ionic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>webview</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ionicç¯‡å­¦ä¹ ç¬”è®°-éƒ¨ç½²é¡¹ç›®ç¼–</title>
    <link href="/2018/03/18/ionic%E7%AF%87%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%E7%BC%96/"/>
    <url>/2018/03/18/ionic%E7%AF%87%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE%E7%BC%96/</url>
    
    <content type="html"><![CDATA[<p>##1.å¯åŠ¨ionicé¡¹ç›®<br>é¦–å…ˆæ˜¯éšä¾¿éƒ½èƒ½æŸ¥åˆ°çš„npmå®‰è£…å‘½ä»¤</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dos">npm install -g ionic cordova<br>ionic <span class="hljs-built_in">start</span> myIonicProject blank<br><span class="hljs-built_in">cd</span> myIonicProject<br>ionic serve<br></code></pre></td></tr></table></figure><p>çœ‹ä¸€ä¸‹é¡¹ç›®ç›®å½•ï¼Œäº†è§£ä¸€ä¸‹<br>é¦–å…ˆsrcé‡Œå­˜æ”¾çš„ionicçš„angularä»£ç <br>å…¶æ¬¡www é‡Œå­˜æ”¾çš„æ˜¯srcé‡Œçš„typescriptä»£ç ç¼–è¯‘åçš„æ³¨å…¥çš„jsä»£ç ï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–çš„ä¸œè¥¿ï¼Œæ¯”å¦‚è¯´å›¾ç‰‡ï¼Œsassç¼–è¯‘åæ³¨å…¥çš„cssä»£ç ï¼Œéƒ½æ˜¯ç”¨webpackæ‰“åŒ…ç¼–è¯‘ç”Ÿæˆã€‚<br>wwwå¾ˆé‡è¦ï¼Œå°±ç®—ionicæ‰“åŒ…androidå®‰è£…åŒ…ä¹Ÿæ˜¯æŠŠwwwç§»è¿‡å»ã€‚<br>##2.é…ç½®ç§»åŠ¨å¼€å‘ç¯å¢ƒ<br>å…¶ä¸­iosçš„å¼€å‘ç¯å¢ƒå¦‚æœæ˜¯è‹¹æœç”µè„‘å°±ä¸ç”¨é…äº†ï¼Œiosåªèƒ½åœ¨è‹¹æœä¸Šå¼€å‘ã€‚<br>androidçš„ç¯å¢ƒé…ç½®ç½‘ä¸Šä¸€å¤§å †ï¼Œå°±æ˜¯å®‰è£…sdké…ä¸‹ç¯å¢ƒå˜é‡ã€‚å¦‚æœæƒ³è¦è´ªä¾¿å®œï¼Œå¯ä»¥ç›´æ¥ä¸‹ä¸ªandroidStudioï¼Œç¥å™¨å•Šï¼Œå¿«é€Ÿå¸®åŠ©æ–°æ‰‹é…ç½®ç¯å¢ƒã€‚<br>##3.æ‰“åŒ…androidå®‰è£…åŒ…<br>é¦–å…ˆå…ˆç»™ionicé¡¹ç›®æ·»åŠ æ”¯æŒçš„å¹³å°ï¼Œåœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œå‘½ä»¤è¡Œ</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi">ionic cordova <span class="hljs-keyword">platform</span><br></code></pre></td></tr></table></figure><p>èƒ½çœ‹åˆ°ä¸€å¤§ä¸²æ”¯æŒçš„å¹³å°åˆ—è¡¨(androidã€iosã€browser)å’Œå·²ç»å®‰è£…çš„å¹³å°<br>è¿è¡Œå‘½ä»¤å®‰è£…ionicçš„androidå¹³å°</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">ionic cordova <span class="hljs-built_in">platform</span> <span class="hljs-built_in">add</span> android<br></code></pre></td></tr></table></figure><p>æ·»åŠ å®Œä»¥åï¼Œå¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹çš„platformsæ–‡ä»¶å¤¹ä¸‹å¤šäº†ä¸ªandroidæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å°±æ˜¯androidé¡¹ç›®ä»£ç ï¼Œç„¶åå†è¿è¡Œå‘½ä»¤buildä¸€ä¸‹androidå¹³å°çš„ä»£ç ã€‚</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ionic cordova build android</span><br></code></pre></td></tr></table></figure><p>è¿™è¡Œå‘½ä»¤è¡Œå°±æ˜¯ä¸ºäº†æ›´æ–°androidå¹³å°ä¸‹çš„ä»£ç ï¼Œå…¶ä¸­å°±æœ‰æŠŠwwwæ›¿æ¢androidé¡¹ç›®é‡Œçš„wwwã€‚</p><p>åœ¨macä¸‹buildå®Œä»¥åï¼Œæœ€å¥½è¿›åˆ°ä¸Šä¸€å±‚ç›®å½•, sudo chmod -R 777 myIonicProject<br>ä¸ç„¶å¯èƒ½androidStudioæ²¡æƒé™æ‰“å¼€ï¼Œwindowsä¸‹ä¹Ÿåº”è¯¥ç”¨ç®¡ç†å‘˜æƒé™è®¾ç½®ä¸€ä¸‹ã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™ä¸ªbuildå¾ˆå¤šäººéƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå¦‚æœæ˜¯androidç¯å¢ƒæ²¡é…å¥½ï¼Œç¡®ä¿ä½ çš„androidStudioèƒ½æ–°å»ºä¸€ä¸ªé¡¹ç›®å¹¶æˆåŠŸè·‘èµ·æ¥ã€‚ç„¶åå¦‚æœå¯¹androidå¼€å‘ä¸å¤ªç†Ÿï¼Œä¸çŸ¥é“gradleæ€ä¹ˆç”¨æ€ä¹ˆæ‰“åŒ…çš„ç­’å­ï¼ˆä½œè€…æˆ‘ï½ï½ï¼‰,ç›´æ¥ç”¨androidStudioæ‰“å¼€ionicç¼–è¯‘åç”Ÿæˆçš„androidé¡¹ç›®ï¼Œå°±æ˜¯é‚£ä¸ªplatformä¸‹çš„androidæ–‡ä»¶å¤¹ã€‚androidStudioä¼šè‡ªåŠ¨å¸®ä½ æ„å»ºé¡¹ç›®ã€‚</p><p>æˆ‘åœ¨androidStudioç¼–è¯‘é¡¹ç›®æ—¶é‡åˆ°äº†ä¸€äº›é—®é¢˜ï¼Œå¦‚æœç¼–è¯‘å¤±è´¥ï¼Œé™¤äº†ç½‘é€Ÿé—®é¢˜ï¼ˆç§‘å­¦ä¸Šç½‘ï¼‰ä»¥å¤–ï¼Œè¿˜é‡åˆ°è¿‡<br><img src="/img/6114493-80d4abe9ba203c9c.webp" alt="Jietu20171218-134359@2x.png"><br>è¿™ç§é—®é¢˜ï¼Œç°åœ¨ionic buildé¡¹ç›®æˆ‘å·²ç»æ²¡é‡è§äº†ï¼Œå‰å‡ ä¸ªæœˆbuildä¸€æ¬¡é‡è§ä¸€æ¬¡ã€‚<br>ç›´æ¥å» <a href="https://www.imooc.com/article/21867">https://www.imooc.com/article/21867</a> çœ‹ï¼Œæ‰¾åˆ°é—®é¢˜6å°±è¡Œäº†ã€‚</p><p>androidé¡¹ç›®å¯¼å…¥androidStudioæ²¡é—®é¢˜ä»¥åï¼Œç›´æ¥è¿è¡Œï¼Œå°±èƒ½çœ‹åˆ°è‡ªå·±çš„appè·‘èµ·æ¥äº†ã€‚</p><p>ionicé¡¹ç›®å¼€å‘èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯çœŸæ­£éš¾çš„å°±æ˜¯ä»–çš„åº•å±‚ç¯å¢ƒé…ç½®ã€‚ä¹Ÿä¸èƒ½è¯´ä»–å‘ï¼Œå› ä¸ºä»–æ˜¯åŸºäºcordovaå¼€å‘çš„ï¼Œcordovaé…ç½®ç¯å¢ƒæœ¬æ¥å°±å¾ˆå‘ã€‚æ‰“ä¸ªcordovaçš„jaråŒ…ç”¨å®˜æ–¹çš„å‘½ä»¤æ ¹æœ¬æ‰“ä¸èµ·æ¥ï¼Œé‡ä¸Šäº†å¥½å¤šé—®é¢˜ï¼Œæœ€ååœ¨androidStudioçš„å¸®åŠ©ä¸‹æ‰æˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ionic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éƒ¨ç½²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ionic3 çƒ­æ›´æ–°androidç¯‡</title>
    <link href="/2018/03/18/ionic3-%E7%83%AD%E6%9B%B4%E6%96%B0android%E7%AF%87/"/>
    <url>/2018/03/18/ionic3-%E7%83%AD%E6%9B%B4%E6%96%B0android%E7%AF%87/</url>
    
    <content type="html"><![CDATA[<p>è¿™çƒ­æ›´æ–°ç®€ç›´äº†ï¼Œå…¶å®çœ‹ç½‘ä¸Šé…æ¥é…å»å°±è¿™å‡ æ­¥ï¼Œä½†è‡ªå·±ä¸€é…å°±ç«‹é©¬é‡ä¸Šå¾ˆå¤šé—®é¢˜ï¼Œä¸»è¦è¿˜æ˜¯ç»†èŠ‚æ–¹é¢å¤„ç†ä¸å¤Ÿåˆ°ä½ã€‚ç´¢æ€§è‡ªå·±ä¹Ÿå¼€ä¸€ç¯‡ï¼Œé˜²æ­¢è‡ªå·±å¿˜äº†ã€‚</p><ol><li><p>è¿›å…¥è‡ªå·±çš„ionicé¡¹ç›®æ ¹ç›®å½•ä¸‹ å¯åŠ¨ ionicæœåŠ¡  <code>ionic serve</code></p></li><li><p>å®‰è£…ionic native çƒ­æ›´æ–°æ’ä»¶</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gauss">ionic cordova plugin add cordova-hot-<span class="hljs-built_in">code</span>-<span class="hljs-keyword">push</span>-plugin<br>ionic cordova plugin add cordova-hot-<span class="hljs-built_in">code</span>-<span class="hljs-keyword">push</span>-<span class="hljs-keyword">local</span>-dev-addon<br>npm install -g cordova-hot-<span class="hljs-built_in">code</span>-<span class="hljs-keyword">push</span>-cli<br></code></pre></td></tr></table></figure><p>å½“ç„¶äº†è¿˜è¦ç¡®ä¿è‡ªå·±å·²ç»å®‰è£…äº†androidå¹³å°ï¼ˆæ²¡å®‰è£…å¯ä»¥æ‰§è¡Œ <code>ionic cordova platform add android</code>ï¼‰</p></li><li><p>åœ¨config.xmlé…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä¸‹é¢èŠ‚ç‚¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">chcp</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">config-file</span> <span class="hljs-attr">url</span>=<span class="hljs-string">&quot;http://192.168.1.76:8121/chcp.json&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">native-interface</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;1&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">chcp</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸Šé¢é‚£ä¸ªåœ°å€æ˜¯ä½ è¿œç¨‹æœåŠ¡å™¨å­˜æ”¾wwwæ–‡ä»¶å¤¹è·¯å¾„çš„åœ°å€ ï¼Œå½“ç„¶æˆ‘è¿™ä¸ªåœ°å€<a href="http://192.168.1.76:8121æ˜¯é€šè¿‡http-server">http://192.168.1.76:8121æ˜¯é€šè¿‡http-server</a> -p 8121 åœ¨wwwç›®å½•ä¸‹å¼€æœåŠ¡æ‹¿çš„åœ°å€ã€‚æ˜¯æœ¬åœ°çš„ä¸€ä¸ªæœåŠ¡ã€‚</p></li><li><p>çƒ­æ›´æ–°æœåŠ¡å¼€å¯ <code>cordova-hcp server </code>  è¿˜æœ‰å¦‚æœè¿è¡Œå‘½ä»¤æ­£å¸¸wwwç›®å½•ä¸‹ä¼šæœ‰ æœ‰chcp.jsonå’Œchcp.manifestæ–‡ä»¶å‡ºç°ã€‚åˆ°è¿™ä¸€æ­¥ä½ å°±çŸ¥é“ä¸ºä»€ä¹ˆç¬¬ä¸‰æ­¥è¦é…è¿™ä¸ªåœ°å€äº†ã€‚</p></li><li><p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºæ¨¡æ¿ cordova-hcp.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;content_url&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;http://192.168.1.76:8121&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;autogenerated&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;update&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;now&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>è¿™ä¸€æ­¥é…ç½®å®Œåæ€¥çš„è®¿é—®ä¸‹ï¼Œ<br><a href="http://192.168.1.76:8121/">http://192.168.1.76:8121</a> è®¿é—®çš„æ˜¯ionicé¡¹ç›®çš„é¦–é¡µ<br><a href="http://192.168.1.76:8121/chcp.json">http://192.168.1.76:8121/chcp.json</a> ä¹Ÿè¦èƒ½è®¿é—®åˆ°</p></li><li><p>ä»¥åå‘å¸ƒæ‰§è¡Œ<code>cordova-hcp build</code>å‘½ä»¤ï¼Œå°±å¯ä»¥æŠŠæ¨¡æ¿å†…å®¹æ›¿æ¢åˆ°chcp.jsonæ–‡ä»¶å†…ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°æˆ–è€…å‘å¸ƒappéƒ½ä¼šä½¿çƒ­æ›´æ–°æœåŠ¡é‡æ–°ç”Ÿæˆchcp.jsonæ–‡ä»¶å†…å®¹<br>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™æ¡å‘½ä»¤ä¸€è¿è¡Œï¼Œçƒ­æ›´æ–°æœåŠ¡çš„è¿è¡Œçª—å£ä¹Ÿä¼šæŠ¥ç›¸åº”çš„æ—¥å¿—<br><img src="/img/6114493-0386c299e9515172.webp" alt="Screenshot 2018-02-16_20-10-53.png"></p></li></ol><p>  å¯è§è¿™æ¡å‘½ä»¤ä¸ä»…ç”Ÿæˆchcp.jsonå†…å®¹è¿™ä¹ˆç®€å•ã€‚ç„¶åå†è¯´æˆ‘å‘ç°çš„ä¸€ä¸ªé—®é¢˜ï¼Œæ‰§è¡Œionic serve å°±ä¼šchcp.jsonåˆæ”¹å›åŸæ¥çš„äº†ï¼Œæ‰€ä»¥æ‰“åŒ…buildçš„æ—¶å€™è¦å°å¿ƒä¸€ç‚¹ã€‚</p><ol start="7"><li>buildå®‰å“åŒ… <code>ionic cordova build android</code><br>åˆ°è¿™ä¸€æ­¥ï¼Œç¼–è¯‘å®ŒandroidåŒ…ä»¥åè®°å¾—å†çœ‹ä¸€ä¸‹é…ç½®ï¼Œè¿™å›è¦çœ‹appé‡Œé¢çš„ã€‚<br><img src="/img/6114493-11068a510e2fbf35.webp" alt="Screenshot 2018-02-16_20-17-13.png"></li></ol><p>  åˆ«åˆæ˜¯ä»€ä¹ˆngrokå†…ç½‘ç©¿é€çš„åœ°å€ï¼Œè¿™å°±ä¸å¥½ç©äº†ï¼Œä¸å¯¹çš„è¯ï¼ŒæŠŠwwwé‡Œé¢çš„chcp.jsonå†…å®¹å¤åˆ¶è¿‡æ¥æ›¿æ¢ä¸€ä¸‹ã€‚</p><p>8.æœ€åä¸€æ­¥å°±ç›´æ¥æ‰“å¼€å®‰è£…å¥½çš„appäº†ï¼Œæ”¹ä¸€ä¸‹htmlå†…å®¹,ç”¨<code>ionic serve</code> ç¼–è¯‘ä¸€ä¸‹ï¼ŒæŠŠappå…³æ‰é‡æ–°å¼€ä¸€ä¸‹ï¼Œå°±å¯ä»¥çœ‹åˆ°çƒ­æ›´æ–°æ”¹çš„ä¸œè¥¿äº†ã€‚<br>æ³¨æ„ï¼šæˆ‘è¿™è¾¹æµ‹è¯•çƒ­æ›´æ–°æ˜¯ç”¨æ¨¡æ‹Ÿå™¨çš„ï¼Œç”¨çœŸçš„å°ä¼™ä¼´æ³¨æ„ä¸‹ä½ çš„åœ°å€æ˜¯ä¸æ˜¯æ‰‹æœºå¯ä»¥è®¿é—®å“¦ï¼</p>]]></content>
    
    
    <categories>
      
      <category>ionic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hot codePush</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>angular4å­¦ä¹ ç¬”è®°æ•´ç†ï¼ˆä¸€ï¼‰</title>
    <link href="/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E4%B8%80%EF%BC%89/"/>
    <url>/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>å¥½ä¹…æ²¡å†™ç‚¹ä¸œè¥¿äº†ï¼Œæ¯•ä¸šåˆšåˆšå›åˆ°ä¸Šæµ·ï¼Œå°±é©¬ä¸Šå‡ºå·®å»äº†æ­å·å»åšapp h5çš„webviewå¼€å‘ï¼Œç”¨çš„æ˜¯ionic3ï¼Œionicç°åœ¨å­¦ä¹ è¿˜æ²¡å­¦å®Œï¼Œç°åœ¨å°±æŠŠè‡ªå·±å­¦åˆ°çš„angularçš„ç¬”è®°æ•´ç†ä¸€ä¸‹ã€‚</p><h2 id="angular-çš„-nodejså®‰è£…"><a href="#angular-çš„-nodejså®‰è£…" class="headerlink" title="angular çš„ nodejså®‰è£…"></a>angular çš„ nodejså®‰è£…</h2><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install -g angular<br><span class="hljs-built_in">npm</span> -g install @angular/cli    angularå‘½ä»¤è¡Œå·¥å…·å®‰è£…<br></code></pre></td></tr></table></figure><p>ç”¨typescriptæ¥å†™nodeéœ€è¦å¼•å…¥ä¸€ä¸ªåŒ…</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">npm i @types/<span class="hljs-keyword">node</span> <span class="hljs-title">--save</span><br></code></pre></td></tr></table></figure><h2 id="angular-cliå¸¸ç”¨çš„command"><a href="#angular-cliå¸¸ç”¨çš„command" class="headerlink" title="angular cliå¸¸ç”¨çš„command"></a>angular cliå¸¸ç”¨çš„command</h2><p>ng new é¡¹ç›®åç§°          æ–°å»ºangularé¡¹ç›®<br>ng g component xxx  ç”Ÿæˆç»„ä»¶<br>ng g service xxx  ç”ŸæˆæœåŠ¡     </p><h2 id="jqueryçš„ä½¿ç”¨"><a href="#jqueryçš„ä½¿ç”¨" class="headerlink" title="jqueryçš„ä½¿ç”¨"></a>jqueryçš„ä½¿ç”¨</h2><p>å…¶å®angular4é‡Œå¯ä»¥ä½¿ç”¨jqueryäº†ï¼Œä¸ç”¨åƒangular1é‡Œé¢ä½¿ç”¨ç±»ä¼¼jqçš„å…ƒç´ é€‰æ‹©å™¨ï¼Œä¸è¿‡å…¶ä¸­éœ€è¦ä¸€ç‚¹é…ç½®ã€‚</p><ol><li><p>npmå®‰è£…jq </p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">npm <span class="hljs-keyword">install </span><span class="hljs-keyword">jquery </span>--save<br></code></pre></td></tr></table></figure></li><li><p>åœ¨angular-cli.json  é‡Œçš„app é…ç½®æ–‡ä»¶é‡Œé¢ çš„stylesã€scriptsé‡Œé¢æ·»åŠ jsæˆ–è€…cssçš„ç›¸å¯¹è·¯å¾„,å°±æ”¾åœ¨appçš„scripté‡Œé¢ï¼Œé‡Œé¢è¿˜æœ‰ä¸€ä¸ªæ¡†çš„æ˜¯bootstrap<br><img src="/img/6114493-648480aa2acad151.webp" alt="Screenshot 2018-01-12_19-03-46.png"></p></li><li><p>ç”±äºtypescript ä¸è®¤è¯†jsçš„ä¸œè¥¿ï¼Œè¿˜éœ€è¦ä¸€ä¸ª ç±»å‹æè¿°æ–‡ä»¶</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install @types/jquery --save<br></code></pre></td></tr></table></figure></li></ol><h2 id="æŒ‡ä»¤çš„ç®€å•è¿ç”¨"><a href="#æŒ‡ä»¤çš„ç®€å•è¿ç”¨" class="headerlink" title="æŒ‡ä»¤çš„ç®€å•è¿ç”¨"></a>æŒ‡ä»¤çš„ç®€å•è¿ç”¨</h2><p>åƒä¸‹é¢è¿™æ ·ä¸€æ®µä»£ç åŸºæœ¬å³çœ‹æ‡‚ï¼Œ*ngForå¾ªç¯æ•°ç»„ ï¼Œjsçš„classæ ·å¼æ§åˆ¶ç”¨è¿™ç§[class.xxxx]&#x3D;â€xxâ€ è¿™ç§æ–¹å¼</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs typescript">html<br>&lt;p &gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> *<span class="hljs-attr">ngFor</span>=<span class="hljs-string">&quot;let star of stars&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;glyphicon glyphicon-star&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">[<span class="hljs-attr">class.glyphicon-star-empty</span>]=<span class="hljs-string">&quot;star&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br>&#123;&#123;rating&#125;&#125;<br>&lt;/p&gt;<br>ts<br><span class="hljs-meta">@Component</span>(&#123;<br><span class="hljs-attr">selector</span>: <span class="hljs-string">&#x27;app-stars&#x27;</span>,<br><span class="hljs-attr">templateUrl</span>: <span class="hljs-string">&#x27;./stars.component.html&#x27;</span>,<br><span class="hljs-attr">styleUrls</span>: [<span class="hljs-string">&#x27;./stars.component.css&#x27;</span>]<br>&#125;)<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StarsComponent</span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-attr">rating</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">private</span> <span class="hljs-attr">stars</span>: <span class="hljs-built_in">boolean</span>[];<br><span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123; &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®"><a href="#çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®" class="headerlink" title="çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®"></a>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®</h2><p>å­ç»„ä»¶ä»£ç å°±æ˜¯ä¸Šé¢ä¸€æ®µä»£ç ï¼Œå®ƒéœ€è¦çˆ¶ç»„ä»¶è¾“å…¥ä¸€ä¸ªratingå±æ€§ï¼Œçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶ï¼Œåªéœ€åœ¨htmlé‡Œé¢è°ƒç”¨å­ç»„ä»¶çš„htmlæ ‡ç­¾ï¼Œè¾“å…¥å±æ€§ç”¨[]æ‰©èµ·æ¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">app-stars</span> [<span class="hljs-attr">rating</span>]=<span class="hljs-string">&quot;product.rating&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-stars</span>&gt;</span><br></code></pre></td></tr></table></figure><p>è¾“å…¥å±æ€§ï¼šè¿™ç§å±æ€§ç»‘å®š  æ˜¯è¾“å…¥æ•°æ®çš„ç»‘å®šæ–¹å¼</p><p>ç„¶åå­ç»„ä»¶é‡Œé¢çš„ä»£ç ä¹Ÿéœ€è¦æ”¹ä¸€ä¸‹ï¼Œå°†ratingè®¾ç½®ä¸ºè¾“å…¥å±æ€§</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StarsComponent</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">OnInit</span> &#123;<br><span class="hljs-meta">@Input</span>()        é€šè¿‡è¿™ä¸ªinputè¾“å…¥æ ‡æ³¨     å£°æ˜ratingä¼šè¢«çˆ¶ç»„ä»¶è¾“å…¥çš„å±æ€§è¦†ç›–<br><span class="hljs-keyword">private</span> <span class="hljs-attr">rating</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;<span class="hljs-comment">//é»˜è®¤</span><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>angular</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>angular4å­¦ä¹ ç¬”è®°æ•´ç†ï¼ˆä¸‰ï¼‰angular4çš„æœåŠ¡</title>
    <link href="/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E4%B8%89%EF%BC%89angular4%E7%9A%84%E6%9C%8D%E5%8A%A1/"/>
    <url>/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E4%B8%89%EF%BC%89angular4%E7%9A%84%E6%9C%8D%E5%8A%A1/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¾èµ–æ³¨å…¥åŸºæœ¬æ­¥éª¤"><a href="#ä¾èµ–æ³¨å…¥åŸºæœ¬æ­¥éª¤" class="headerlink" title="ä¾èµ–æ³¨å…¥åŸºæœ¬æ­¥éª¤"></a>ä¾èµ–æ³¨å…¥åŸºæœ¬æ­¥éª¤</h2><ol><li><p>ç”Ÿæˆservice</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProductService</span> &#123;<br><span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123; &#125;<br><span class="hljs-title function_">getProduct</span>(): <span class="hljs-title class_">Product</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Product</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;iphone&#x27;</span>, <span class="hljs-number">5899</span>, <span class="hljs-string">&#x27;hahah&#x27;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>app.module.tsæˆ–è€… æŸç»„ä»¶çš„é…ç½®é‡ŒåŠ ä¸Š æä¾›å™¨</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@NgModule</span>(&#123;<br><span class="hljs-attribute">declarations</span>: [<br>AppComponent,<br>Product1Component,<br>Product2Component<br>],<br><span class="hljs-attribute">imports</span>: [<br>BrowserModule<br>],<br><span class="hljs-attribute">providers</span>: [ProductService],<br><span class="hljs-attribute">bootstrap</span>: [AppComponent]<br>&#125;)<br></code></pre></td></tr></table></figure><p>åœ¨moduleé‡Œé…ç½®çš„providersä¼šå¯¹æ‰€æœ‰ç»„ä»¶ç”Ÿæ•ˆ<br>ä½†å¦‚æœåœ¨ç»„ä»¶çš„tsé‡Œé¢é…ç½®ï¼Œåˆ™ç»„ä»¶é‡Œé…ç½®çš„ä¼˜å…ˆç”Ÿæ•ˆå¦‚ï¼š</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Component</span>(&#123;<br><span class="hljs-attribute">selector</span>: <span class="hljs-string">&#x27;app-product2&#x27;</span>,<br><span class="hljs-attribute">templateUrl</span>: <span class="hljs-string">&#x27;./product2.component.html&#x27;</span>,<br><span class="hljs-attribute">styleUrls</span>: [<span class="hljs-string">&#x27;./product2.component.css&#x27;</span>],<br><span class="hljs-attribute">providers</span>: [&#123;<span class="hljs-attribute">provide</span>: ProductService , <span class="hljs-attribute">useClass</span>: AnotherProductService&#125;]<br>&#125;)<br></code></pre></td></tr></table></figure><p>å¹¶ä¸”å¯ä»¥æ ¹æ®</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">providers:</span> [&#123;<span class="hljs-attr">provide:</span> <span class="hljs-string">ProductService</span> , <span class="hljs-attr">useClass:</span> <span class="hljs-string">AnotherProductService</span>&#125;]<br></code></pre></td></tr></table></figure><p>æ¥æŒ‡å®šä¸åŒçš„æœåŠ¡ï¼Œè™½ç„¶ä¸åŒclassï¼Œä½†åœ¨ç»„ä»¶ç”Ÿæˆçš„ä¸œè¥¿è¿˜æ˜¯ä¸€æ ·çš„</p></li><li><p>åœ¨ç»„ä»¶é‡Œé¢æ³¨å…¥æœåŠ¡å¦‚</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(<span class="hljs-keyword">private</span> productService: ProductService)</span> <span class="hljs-comment">&#123; &#125;</span></span><br></code></pre></td></tr></table></figure></li></ol><p>å¦å¤–<br>æœåŠ¡ä¹‹é—´ä¹Ÿèƒ½ç›¸äº’æ³¨å…¥é @Injectable()<br>æœåŠ¡ä¹‹é—´ä¹Ÿå¯ä»¥æ³¨å…¥ï¼Œæ­¥éª¤ä¸€æ ·ï¼Œæ³¨å†Œæä¾›</p><p>è¿˜æœ‰è¿™ä¸ª<br>å·¥å‚å’Œå€¼ç”³æ˜æä¾›å™¨,é«˜çº§ç©æ³•ï¼Œæˆ‘å°±å­¦è¿‡æ²¡ç”¨è¿‡ï¼Œæé†’ä¸€ä¸‹è‡ªå·±</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs arcade">providers: [<br><span class="hljs-comment">// ProductService,</span><br>&#123;<br><span class="hljs-attr">provide</span>: ProductService ,<br><span class="hljs-attr">useFactory</span>: <span class="hljs-function">(<span class="hljs-params">logger: LoggerService, isDev</span>) =&gt;</span> &#123;   <span class="hljs-comment">//ä¾èµ–æ³¨å…¥æœåŠ¡å·¥å‚æ–¹æ³•ï¼Œå®ä¾‹åŒ–ä¸åŒçš„productService</span><br><span class="hljs-comment">// let logger = new LoggerService();</span><br><span class="hljs-keyword">if</span> (isDev) &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ProductService(logger);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AnotherProductService(logger);<br>&#125;<br>&#125;,<br><span class="hljs-attr">deps</span>: [ LoggerService , <span class="hljs-string">&quot;IS_DEV_ENV&quot;</span>]     <span class="hljs-comment">//å·¥å‚æ–¹æ³•ä¹Ÿå¯ä»¥æ³¨å…¥æœåŠ¡æˆ–è€…å€¼ï¼Œå‰ä¸€ä¸ªæ˜¯loginæœåŠ¡ ï¼Œåä¸€ä¸ªæ˜¯ å˜é‡æ³¨å…¥ï¼ˆå¯ä»¥ä½¿å¯¹è±¡ï¼‰</span><br>&#125;,<br>&#123;<span class="hljs-attr">provide</span> : <span class="hljs-string">&quot;IS_DEV_ENV&quot;</span> , <span class="hljs-attr">useValue</span> : <span class="hljs-literal">false</span> &#125;,  <span class="hljs-comment">//å£°æ˜çš„å€¼æœåŠ¡</span><br>LoggerService<br>],<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>service</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>angular4å­¦ä¹ ç¬”è®°æ•´ç†ï¼ˆäºŒï¼‰angular4çš„è·¯ç”±ä½¿ç”¨</title>
    <link href="/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E4%BA%8C%EF%BC%89angular4%E7%9A%84%E8%B7%AF%E7%94%B1%E4%BD%BF%E7%94%A8/"/>
    <url>/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E4%BA%8C%EF%BC%89angular4%E7%9A%84%E8%B7%AF%E7%94%B1%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<p>è¿™ç« è¯´ä¸€ä¸‹angularçš„è·¯ç”±ï¼Œæˆ‘ä¹Ÿå°±ç´§æ€¥å­¦äº†ä¸‹ï¼Œå®é™…ä¸Šåœ¨ionicé‡Œéƒ½æ²¡ç”¨åˆ°è¿™æ–¹é¢çš„çŸ¥è¯†ï¼ŒionicæŠŠè·¯ç”±éƒ½å°å¥½äº†<br>å…ˆè¯´angularè·¯ç”±æ€ä¹ˆå¼•å…¥ï¼Œä¸€å¼€å§‹newå‡ºæ¥çš„angularé¡¹ç›®å®ƒè·¯ç”±å¸®ä½ é…å¥½äº†ï¼Œä½†çœ‹è¦çœ‹app.module.tsé‡Œé¢</p><ol><li>é¦–å…ˆæœ€ä¸Šé¢è¦å¼•å…¥è·¯ç”±æ¨¡å—<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> &#123;RouterModule, Routes&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/router&#x27;</span>;<br></code></pre></td></tr></table></figure></li><li>ç„¶ååœ¨ngModuleé‡Œé¢åŠ ç‚¹ä¸œè¥¿<br><img src="/img/6114493-aeb2f9d6fdf7cc80.webp" alt="Screenshot 2018-01-12_19-41-32.png"></li><li>è¿™ä¸ªrouteConfigéœ€è¦è‡ªå·±å®šä¹‰ï¼Œç±»å‹Routesï¼Œé‡Œé¢å°±æ˜¯angularè·¯ç”±é…ç½®</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">const routeConfig: Routes = [<br>&#123;path: <span class="hljs-string">&#x27;&#x27;</span> , component : HomeComponent&#125;,<br>]<br></code></pre></td></tr></table></figure><p>å½“ç„¶è·¯ç”±é…ç½®ä¹Ÿæ˜¯å¯ä»¥æŠ½å‡ºæ¥çš„</p><h4 id="è·¯ç”±é…ç½®ç®€å•ä»‹ç»"><a href="#è·¯ç”±é…ç½®ç®€å•ä»‹ç»" class="headerlink" title="è·¯ç”±é…ç½®ç®€å•ä»‹ç»"></a>è·¯ç”±é…ç½®ç®€å•ä»‹ç»</h4><ol><li>å¸¸ç”¨è·³è½¬</li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">const routeConfig: Routes = [<br>&#123;path: <span class="hljs-string">&#x27;&#x27;</span> , component : HomeComponent&#125;, <span class="hljs-regexp">//</span>pathä¸º<span class="hljs-string">&#x27;&#x27;</span>é¦–é¡µå³æ˜¯<br>&#123;path: <span class="hljs-string">&#x27;chat&#x27;</span>,component: ChatComponent,&#125;,<span class="hljs-regexp">//</span>è®¿é—®é¦–é¡µåœ°å€+/chat    å³èƒ½è®¿é—®åˆ°chatç»„ä»¶<br>&#123;path: <span class="hljs-string">&#x27;au/:id&#x27;</span>,component: AuComponent&#125;,<span class="hljs-regexp">//</span>è·¯ç”±paramä¼ å‚<br>&#123;path: <span class="hljs-string">&#x27;**&#x27;</span>,component: Code404Component&#125; <span class="hljs-regexp">//</span>ä¸èƒ½åŒ¹é…çš„è·¯ç”±ç”± ** åŒ¹é…<br>]<br></code></pre></td></tr></table></figure><p>å…¶ä¸­ç¬¬ä¸‰ä¸ªè·¯ç”±ä¼ å‚çš„æ¥æ”¶æ–¹ç»„ä»¶æƒ³è¦æ‹¿åˆ°å‚æ•°å°±éœ€è¦å¤šåŠ ç‚¹<br>a. é¦–å…ˆå¼•å…¥ </p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs clean"><span class="hljs-keyword">import</span> &#123;ActivatedRoute, Params&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/router&#x27;</span>;<br></code></pre></td></tr></table></figure><p>b. å¹¶åœ¨constructoré‡Œæ³¨å…¥è¿™ä¸ªè·¯ç”±æœåŠ¡</p><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs delphi"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(<span class="hljs-keyword">private</span> routeInfo: ActivatedRoute)</span> <span class="hljs-comment">&#123; &#125;</span></span><br></code></pre></td></tr></table></figure><p>c. è·å–paramå‚æ•°<br>å…¶ä¸­æœ‰2ç§æ–¹å¼è·å–param<br>ç¬¬ä¸€ç§æ˜¯snapshot å‚æ•°å¿«ç…§</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-comment">//constructoråˆ›å»ºæ—¶ä¼šåªåˆ›å»ºä¸€æ¬¡ngOnInitï¼Œæ‰€ä»¥this.routeInfo.snapshot.params[&#x27;id&#x27;]çš„å€¼ä¼šä¸å˜</span><br><span class="hljs-variable language_">this</span>.<span class="hljs-property">productId</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">routeInfo</span>.<span class="hljs-property">snapshot</span>.<span class="hljs-property">params</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æœ‰ä¸€ä¸ªé—®é¢˜<br>å¦‚æœå·²ç»è¯·æ±‚ localhost:4200&#x2F;au&#x2F;6  åï¼Œå†è¯·æ±‚ localhost:4200&#x2F;au&#x2F;8 ï¼Œç›¸å½“äºåŒè·¯ç”±è·³è½¬åªæ˜¯å‚æ•°ä¸åŒï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡æ‹¿åˆ°çš„paramæ•°å­—è¿˜æ˜¯ç¬¬ä¸€æ¬¡çš„6<br>åŸå› </p><blockquote><p>constructoråˆ›å»ºæ—¶ä¼šåªåˆ›å»ºä¸€æ¬¡ngOnInitï¼Œæ‰€ä»¥this.routeInfo.snapshot.params[â€˜idâ€™]çš„å€¼ä¼šä¸å˜</p></blockquote><p>æ‰€ä»¥æ›´å¤šçš„è·å–å‚æ•°æ›´æ¨èç¬¬äºŒç§å‚æ•°è®¢é˜…çš„æ–¹å¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">ngOnInit</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">routeInfo</span>.<span class="hljs-property">params</span>.<span class="hljs-title function_">subscribe</span>(<span class="hljs-function">(<span class="hljs-params">params: Params</span>) =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">productId</span> = params.<span class="hljs-property">id</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>æ€ä¹ˆè·³å‚æ•°éƒ½æ˜¯å¯¹çš„ç”¨ç¬¬äºŒç§</p><h4 id="å­è·¯ç”±"><a href="#å­è·¯ç”±" class="headerlink" title="å­è·¯ç”±"></a>å­è·¯ç”±</h4><p>åªæ˜¯ä¸€å±‚è·¯ç”±æ˜æ˜¾æ»¡è¶³ä¸äº†å¼€å‘éœ€æ±‚ï¼Œå¯ä»¥å†é…ç½®å­è·¯ç”±</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs yaml">&#123;<br><span class="hljs-attr">path:</span> <span class="hljs-string">&#x27;product&#x27;</span>,<br><span class="hljs-attr">component:</span> <span class="hljs-string">ProductComponent</span>,<br><span class="hljs-attr">children:</span> [<br>&#123;<br><span class="hljs-attr">path:</span> <span class="hljs-string">&#x27;childA&#x27;</span>, <span class="hljs-attr">component:</span> <span class="hljs-string">ChildAComponent</span><br>&#125;,<br>&#123;<br><span class="hljs-attr">path:</span> <span class="hljs-string">&#x27;childB&#x27;</span>, <span class="hljs-attr">component:</span> <span class="hljs-string">ChildBComponent</span><br>&#125;<br>]<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å­è·¯ç”±å…‰è¿™æ ·è¿˜æ˜¯ä¸è¡ŒÂ·<br>åœ¨çˆ¶ç»„ä»¶htmlé‡ŒåŠ è·³åˆ°å­è·¯ç”±çš„æŒ‰é’®æ—¶</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">&quot;[&#x27;./childA&#x27;]&quot;</span> &gt;</span>é”€å”®å‘˜A<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">&quot;[&#x27;./childB&#x27;]&quot;</span> &gt;</span>é”€å”®å‘˜B<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æ³¨æ„è¿™é‡Œä¸èƒ½åŠ &#x2F; å› ä¸ºæ–œæ æŒ‡å‘æ ¹è·¯å¾„ï¼Œ  .&#x2F;æ‰æŒ‡å‘ç›¸å¯¹è·¯å¾„</strong></p><h4 id="é‡å®šå‘è·¯ç”±"><a href="#é‡å®šå‘è·¯ç”±" class="headerlink" title="é‡å®šå‘è·¯ç”±"></a>é‡å®šå‘è·¯ç”±</h4><p>ä½¿ç”¨ redirectTo</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs css">const routes: Routes = [&#123;<br>path: <span class="hljs-string">&#x27;&#x27;</span>,<br>redirectTo: <span class="hljs-string">&#x27;home/6&#x27;</span>,<br>pathMatch: <span class="hljs-string">&#x27;full&#x27;</span> <br>&#125;]<br></code></pre></td></tr></table></figure><h4 id="è¾…åŠ©è·¯ç”±"><a href="#è¾…åŠ©è·¯ç”±" class="headerlink" title="è¾…åŠ©è·¯ç”±"></a>è¾…åŠ©è·¯ç”±</h4><p>å°±æ˜¯ä¸€ä¸ªæ’åº§,è¾…åŠ©è·¯ç”±é€šè¿‡ä¸åŒçš„outleté…ç½®ï¼Œè®©é¡µé¢çš„router-outletæ ‡ç­¾ï¼Œæ˜¾ç¤ºä¸åŒå†…å®¹<br>è·¯ç”±é…ç½®</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">const</span> routes: Routes = [&#123;<span class="hljs-comment">//è¾…åŠ©è·¯ç”±æŒ‡å‘ChatComponentç»„ä»¶ï¼Œæ’åº§åç§°aux</span><br>path: <span class="hljs-string">&#x27;chat&#x27;</span>,<br>component: ChatComponent,<br>outlet: <span class="hljs-string">&#x27;aux&#x27;</span><br>&#125;]<br></code></pre></td></tr></table></figure><p>å¼•ç”¨æ’åº§çš„htmlä»£ç </p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">&quot;[</span></span></span><span class="hljs-template-variable">&#123;outlets:&#123;primary:&#x27;home/2&#x27;,aux:&#x27;chat&#x27;&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&#125;]&quot;</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> [<span class="hljs-attr">routerLink</span>]=<span class="hljs-string">&quot;[</span></span></span><span class="hljs-template-variable">&#123;outlets:&#123;aux:null&#125;</span><span class="language-xml"><span class="hljs-tag"><span class="hljs-string">&#125;]&quot;</span> &gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-comment">&lt;!--ä¸å¼•ç”¨è¾…åŠ©è·¯ç”±--&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">router-outlet</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">router-outlet</span>&gt;</span> <span class="hljs-comment">&lt;!--æ’ä»¶å†…å®¹æ˜¾ç¤ºçš„åœ°æ–¹--&gt;</span></span><br></code></pre></td></tr></table></figure><p>åº”è¯¥ä¼šæœ‰äººé—®ç¬¬ä¸€è¡Œçš„primaryå¹²å˜›çš„<br><strong>è¾…åŠ©è·¯ç”±çš„æ”¹å˜åªä¼šæ”¹å˜æ’åº§çš„å†…å®¹ï¼Œä¸å½±å“ä¸»è·¯ç”±</strong><br>æ¯”å¦‚åŸæœ¬è·¯å¾„æ˜¯<br><a href="http://localhost:4200/home/0">http://localhost:4200/home/0</a><br>ç°åœ¨å¦‚æœ[routerLink]&#x3D;â€[{outlets:{aux:â€™chatâ€™}}]â€çš„aæ ‡ç­¾è¢«ç‚¹å‡»ï¼Œæ”¹å˜çš„åªæ˜¯è¾…åŠ©è·¯ç”±ï¼Œè·¯å¾„ä¼šå˜ä¸º<br><a href="http://localhost:4200/home/0(aux:chat)">http://localhost:4200/home/0(aux:chat)</a><br>åªæœ‰åŠ ä¸Šprimary:â€™home&#x2F;2â€™ï¼Œä¸»è·¯ç”±æ‰ä¼šä¸€èµ·å˜ï¼Œå˜æˆ<a href="http://localhost:4200/home/2(aux:chat)">http://localhost:4200/home/2(aux:chat)</a><br>åŒä¸»è·¯ç”±é—´è·³æ¥è·³å»æƒ³æŠŠè¾…åŠ©è·¯ç”±å¹²æ‰ï¼Œç”¨ç¬¬äºŒè¡Œå³å¯<br>####è·¯ç”±å®ˆå«<br>åªæœ‰ç”¨æˆ·å·²ç»ç™»é™†æˆ–è€…æ‹¥æœ‰æŸäº›æƒé™æ‰å¯è¿›å…¥çš„è·¯ç”±<br><strong>canActive</strong></p><ol><li>å†™ä¸€ä¸ªå®ˆå«ç±»ï¼Œç»§æ‰¿ CanActivate æ¥å£</li></ol><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123;<span class="hljs-title class_">CanActivate</span>&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/router&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LoginGuard</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">CanActivate</span> &#123;<br><span class="hljs-title function_">canActivate</span>(<span class="hljs-params"></span>) &#123;<br><span class="hljs-keyword">let</span> <span class="hljs-attr">loginedIn</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() &lt; <span class="hljs-number">0.5</span>;<br><span class="hljs-keyword">if</span> (!loginedIn) &#123;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;ç”¨æˆ·æœªç™»é™†&#x27;</span>);<br>&#125;<br><span class="hljs-keyword">return</span> loginedIn;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯CanDeactivate ä¸canActivateä¸åŒçš„æ˜¯å®ƒè¦ç¦»å¼€æŸä¸ªç»„ä»¶å°±éœ€è¦ä¿æŠ¤é‚£ä¸ªç»„ä»¶ï¼Œå»ºç«‹ä¹Ÿè¦æ³¨å…¥é‚£ä¸ªç»„ä»¶</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">export <span class="hljs-keyword">class</span> <span class="hljs-symbol">UnsaveGuard</span> <span class="hljs-symbol">implements</span> <span class="hljs-symbol">CanDeactivate</span>&lt;<span class="hljs-symbol">ProductComponent</span>&gt;&#123;<br>canDeactivate (component: ProductComponent) &#123;<br><span class="hljs-keyword">return</span> window.confirm(<span class="hljs-string">&#x27;æ˜¯å¦ç¦»å¼€&#x27;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ä¸¤ä¸ªè¿”å›éƒ½åº”è¯¥æ˜¯booleanå‹<br>2. åœ¨è·¯ç”±é…ç½®é‡ŒåŠ é…ç½®<br><strong>canActivate åœ¨è·¯ç”±é…ç½®æ—¶å¯ä»¥é…ç½®ä¸€ä¸ªæ•°ç»„ï¼Œangularä¼šä¸€æ¬¡è°ƒç”¨æ•°ç»„ä¸­çš„é¡¹ï¼Œä¸€æ—¦æŸä¸ªè¿”å›falseï¼Œåˆ™ä¼šç»ˆæ­¢ç™»é™†æ“ä½œ</strong></p><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ldif">&#123;<br><span class="hljs-attribute">path</span>: &#x27;product&#x27;,<br><span class="hljs-attribute">component</span>: ProductComponent,<br><span class="hljs-attribute">canActivate</span>: [loginGuard],<br><span class="hljs-attribute">canDeactivate</span>: [UnsaveGuard]<br>&#125;<br></code></pre></td></tr></table></figure><p>æœåŠ¡é‡ŒåŠ ä¸Šè¯¥æœåŠ¡</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@NgModule</span>(&#123;<br><span class="hljs-attribute">imports</span>: [RouterModule.<span class="hljs-built_in">forRoot</span>(routes)],<br><span class="hljs-attribute">providers</span>: [LoginGuard, UnsaveGuard],<br><span class="hljs-attribute">exports</span>: [RouterModule]<br>&#125;)<br></code></pre></td></tr></table></figure><p>è·¯ç”±å®ˆå« éå¸¸é‡è¦ ã€‚å†ç»™ä¸ªæˆ‘ç½‘ä¸Šæ‰¾çš„å‚è€ƒæ–‡ç« <br><a href="http://blog.csdn.net/qq451354/article/details/54017466">http://blog.csdn.net/qq451354/article/details/54017466</a></p>]]></content>
    
    
    <categories>
      
      <category>angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>router</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>angular4å­¦ä¹ ç¬”è®°æ•´ç†ï¼ˆå››ï¼‰ç»„ä»¶é—´é€šè®¯ã€ç®¡é“</title>
    <link href="/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E5%9B%9B%EF%BC%89%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E8%AE%AF%E3%80%81%E7%AE%A1%E9%81%93/"/>
    <url>/2018/01/12/angular4%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%EF%BC%88%E5%9B%9B%EF%BC%89%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E8%AE%AF%E3%80%81%E7%AE%A1%E9%81%93/</url>
    
    <content type="html"><![CDATA[<p>####ç»„ä»¶é—´é€šè®¯<br>1.ç»„ä»¶é—´é€šè®¯ ã€‚<br>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶è¾“å…¥å±æ€§ç”¨</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stata">&lt;<span class="hljs-keyword">app</span>-<span class="hljs-keyword">order</span> [stockCode]=<span class="hljs-string">&quot;stock&quot;</span> [amount]=<span class="hljs-string">&quot;100&quot;</span>&gt;&lt;/<span class="hljs-keyword">app</span>-<span class="hljs-keyword">order</span>&gt;<br></code></pre></td></tr></table></figure><p>å­ç»„ä»¶å£°æ˜æ¥æ”¶çˆ¶ç»„ä»¶çš„å±æ€§@input()æ³¨è§£</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Input</span>()<br><span class="hljs-attribute">amount</span>: number;<br></code></pre></td></tr></table></figure><p>2.ç»„ä»¶è¾“å‡ºå±æ€§</p><p>1.åœ¨å‘å°„çš„ç»„ä»¶å†…éƒ¨å®šä¹‰å‘å°„çš„EventEmitterå¯¹è±¡</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@Output</span>()<br><span class="hljs-attribute">lastPrice</span>: EventEmitter&lt;PriceQuote&gt; = new <span class="hljs-built_in">EventEmitter</span>();<br></code></pre></td></tr></table></figure><p>2.åœ¨å‘å°„ç»„ä»¶é‡Œ å°†è¦å‘å°„çš„å˜é‡å‘å°„å‡ºå» ï¼Œæ³¨æ„ç±»å‹å¿…é¡»å’Œå®šä¹‰é‡Œçš„æ³›å‹ä¸€è‡´</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">let</span> pq = <span class="hljs-keyword">new</span> <span class="hljs-constructor">PriceQuote(<span class="hljs-params">this</span>.<span class="hljs-params">stockCode</span>, Math.<span class="hljs-params">random</span>()</span><span class="hljs-operator"> * </span><span class="hljs-number">100</span>);<br>this.lastPrice.emit(pq);<br></code></pre></td></tr></table></figure><p>3.åœ¨å‘å°„ç»„ä»¶æ ‡ç­¾å£°æ˜çš„åœ°æ–¹åŠ ä¸Šç›‘å¬è¯¥emitEventå¯¹è±¡ä¼ è¿‡æ¥çš„äº‹ä»¶</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">&lt;app-price-<span class="hljs-literal">quote</span> (lastPrice)=<span class="hljs-string">&quot;priceQuoteHandler($event)&quot;</span>&gt;&lt;/app-price-<span class="hljs-literal">quote</span>&gt;<br></code></pre></td></tr></table></figure><p>ç„¶åçˆ¶ç»„ä»¶é‡Œå°±å¯ä»¥å†™ï¼Œäº‹ä»¶å°±æ˜¯å‘å°„è¿‡æ¥çš„å€¼</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-title function_">priceQuoteHandler</span>(<span class="hljs-params">priceQuote</span>) &#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">priceQuote</span> <span class="hljs-operator">=</span> <span class="hljs-variable">priceQuote</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„æƒ³ç›‘å¬äº‹ä»¶çš„åå­—å³ä¸æ˜¯lastPrice åªè¦åœ¨outputé‡Œæ”¹å³å¯</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-meta">@Output(<span class="hljs-string">&#x27;priceChange&#x27;</span>)</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·æœ‰æ„Ÿè§‰å¾ˆéº»çƒ¦ï¼Œèƒ½ä¸èƒ½ç”¨<strong>åŒå‘ç»‘å®š</strong></p><p>è¿˜æœ‰æ³¨æ„ å¦‚æœä¸€ä¸ªå±æ€§æƒ³ç”¨åŒå‘ç»‘å®š é‚£ä¹ˆå¦‚æœè¾“å…¥å±æ€§ä¸ºrating ï¼Œå¹¶ä¸”æƒ³åœ¨æ ‡ç­¾ä¸Š<code>[(rating)]</code>ï¼Œè·å–è¾“å‡ºå€¼é‚£ä¹ˆåœ¨ç»„ä»¶å†…çš„è¾“å‡ºå±æ€§ åç§°å¿…é¡»ä¸º<code>ratingChange</code>  ï¼ŒåŠ ä¸ªChange</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Output()</span><br><span class="hljs-keyword">private</span> ratingChange: EventEmitter&lt;number&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventEmitter</span>();<br></code></pre></td></tr></table></figure><p>####ç®¡é“<br>æ™®é€šåº”ç”¨ï¼Œè¿™ä¸ªä½¿ç”¨å¯ä»¥å»æŸ¥å®˜ç½‘</p><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">birthday</span> | date : <span class="hljs-string">&#x27;yyyy-MM-dd HH:mm:ss&#x27;</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span></span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">pi</span> | number: <span class="hljs-string">&#x27;2.2-4&#x27;</span>&#125;&#125;</span><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ç®¡é“éœ€å‘½ä»¤è¡Œç”Ÿæˆ <code>ng g pipe name</code><br>ç®¡é“å’Œç»„ä»¶ä¸€æ ·éœ€ç”³æ˜åœ¨NgModuleé‡Œ</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">declarations:</span> [<br>FilterPipe<br>],<br></code></pre></td></tr></table></figure><p>è‡ªå®šä¹‰ç®¡é“</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs typescript"><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">Pipe</span>, <span class="hljs-title class_">PipeTransform</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><span class="hljs-meta">@Pipe</span>(&#123;<br><span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;filter&#x27;</span><br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FilterPipe</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">PipeTransform</span> &#123;<br><span class="hljs-title function_">transform</span>(<span class="hljs-attr">list</span>: <span class="hljs-built_in">any</span>[], <span class="hljs-attr">filterField</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">keyword</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">any</span> &#123;<br><span class="hljs-keyword">if</span> (!filterField || !keyword) &#123;<br><span class="hljs-keyword">return</span> list;<br>&#125;<br><span class="hljs-keyword">return</span> list.<span class="hljs-title function_">filter</span>( <span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br><span class="hljs-keyword">let</span> fieldVaule = item[filterField];<br><span class="hljs-keyword">return</span> fieldVaule.<span class="hljs-title function_">indexOf</span>(keyword) &gt;= <span class="hljs-number">0</span>;<br>&#125;);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>####å¦‚ä½•åœ¨çˆ¶ç»„ä»¶ä¸­è°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•<br>å­ç»„ä»¶å°±ä¸€ä¸ªgrettingçš„æ–¹æ³•</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml">çˆ¶ç»„ä»¶htmlä»£ç <br><span class="hljs-tag">&lt;<span class="hljs-name">app-children</span> #<span class="hljs-attr">child1</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-children</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">app-children</span> #<span class="hljs-attr">child2</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-children</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">&quot;child2.gretting(&#x27;jsex&#x27;)&quot;</span>&gt;</span>hahah1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br></code></pre></td></tr></table></figure><p>çˆ¶ç»„ä»¶tsä»£ç </p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">import</span> &#123; Component, OnInit, ViewChild&#125; from <span class="hljs-string">&#x27;@angular/core&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123;ChildrenComponent&#125; from <span class="hljs-string">&#x27;./children/children.component&#x27;</span>;<br><br><span class="hljs-meta">@Component(&#123;</span><br><span class="hljs-meta">selector: <span class="hljs-string">&#x27;app-root&#x27;</span>,</span><br><span class="hljs-meta">templateUrl: <span class="hljs-string">&#x27;./app.component.html&#x27;</span>,</span><br><span class="hljs-meta">styleUrls: [<span class="hljs-string">&#x27;./app.component.css&#x27;</span>]</span><br><span class="hljs-meta">&#125;)</span><br>export <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppComponent</span> <span class="hljs-title">implements</span> <span class="hljs-title">OnInit</span>,<span class="hljs-type"></span>&#123;<br><span class="hljs-meta">@ViewChild(<span class="hljs-string">&#x27;child1&#x27;</span>)</span><br>child1: ChildrenComponent;<br>greeting: string = <span class="hljs-string">&#x27;heelo&#x27;</span>;<br>ngOnInit(): void &#123;<br><span class="hljs-keyword">this</span>.child1.gretting(<span class="hljs-keyword">this</span>.greeting);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>1.åœ¨tsä¸­è°ƒç”¨å­ç»„ä»¶æ–¹æ³•<br>htmlé‡Œ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;app-children #child1&gt;</span><span class="hljs-section">&lt;/app-children&gt;</span><br></code></pre></td></tr></table></figure><p>tsé‡Œ</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-variable">@ViewChild</span>(<span class="hljs-string">&#x27;child1&#x27;</span>)<br><span class="hljs-attribute">child1</span>: ChildrenComponent;<br></code></pre></td></tr></table></figure><p>çˆ¶ç»„ä»¶tsä»»æ„åœ°æ–¹å°±å¯ä»¥</p><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">this</span>.child1.gretting(<span class="hljs-keyword">this</span>.greeting);<br></code></pre></td></tr></table></figure><p>2.åœ¨htmlé‡Œè°ƒç”¨å­ç»„ä»¶api</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">app-children</span> #<span class="hljs-attr">child2</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">app-children</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">button</span> (<span class="hljs-attr">click</span>)=<span class="hljs-string">&quot;child2.gretting(&#x27;jsex&#x27;)&quot;</span>&gt;</span>hahah<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>angular</category>
      
    </categories>
    
    
    <tags>
      
      <tag>pipe</tag>
      
      <tag>emit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ‰ç”¨çš„cssçŸ¥è¯†æ”¶é›†</title>
    <link href="/2017/12/07/%E6%9C%89%E7%94%A8%E7%9A%84css%E7%9F%A5%E8%AF%86%E6%94%B6%E9%9B%86/"/>
    <url>/2017/12/07/%E6%9C%89%E7%94%A8%E7%9A%84css%E7%9F%A5%E8%AF%86%E6%94%B6%E9%9B%86/</url>
    
    <content type="html"><![CDATA[<p><strong>currentColor</strong><br>è¡¨ç¤ºâ€œå½“å‰çš„æ ‡ç­¾æ‰€ç»§æ‰¿çš„æ–‡å­—é¢œè‰²â€ã€‚</p><p><strong>å®æˆ˜1ï¼šèƒŒæ™¯è‰²é•‚ç©ºæŠ€æœ¯</strong>å»å¹´ä»‹ç»è¿‡â€œ<a href="http://www.zhangxinxu.com/wordpress/?p=3545">CSSèƒŒæ™¯è‰²é•‚ç©ºæŠ€æœ¯</a>â€ï¼Œå¯ä»¥æ–¹ä¾¿æ§åˆ¶å›¾æ ‡çš„é¢œè‰²ï¼Œå¾ˆèµçš„æƒ³æ³•ã€‚æ­¤æ–‡ç« å¯¹åº”demoå¯ä»¥<a href="http://www.zhangxinxu.com/study/201307/background-color-insert-background-image.html">è½»æˆ³è¿™é‡Œ</a>è®¿é—®ã€‚<br>è¿™ç§è®¾è®¡çš„ç›®çš„å°±æ˜¯é¼ æ ‡hoveræ—¶å€™ï¼Œå›¾æ ‡å¯ä»¥è·Ÿç€æ–‡å­—ä¸€èµ·å˜è‰²ã€‚å¦‚æœä¸è€ƒè™‘å…¼å®¹æ€§é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç¨ç¨æ”¹é€ ä¸‹ï¼Œä½¿å…¶å®ç°æ›´åŠ ç®€å•ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">.icon &#123; <br>display: inline-block; width: 16px;<br>height: 20px; <br>background-image: url(../201307/sprite_icons.png); <br>background-color: currentColor; /* è¯¥é¢œè‰²æ§åˆ¶å›¾æ ‡çš„é¢œè‰² */<br>&#125;<br></code></pre></td></tr></table></figure><p>äºæ˜¯ï¼Œæˆ‘ä»¬æƒ³è¦é¼ æ ‡hoveræ–‡å­—é“¾æ¥ï¼Œå…¶å›¾æ ‡é¢œè‰²è¦è·Ÿç€ä¸€èµ·å˜åŒ–ï¼Œåªè¦æ”¹å˜æ–‡å­—é¢œè‰²å°±å¯ä»¥äº†.</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">.<span class="hljs-built_in">link</span>:hover &#123; color: <span class="hljs-comment">#333; &#125;/* è™½ç„¶æ”¹å˜çš„æ˜¯æ–‡å­—é¢œè‰²ï¼Œä½†æ˜¯å›¾æ ‡é¢œè‰²ä¹Ÿä¸€èµ·å˜åŒ–äº† */</span><br></code></pre></td></tr></table></figure><p>HTMLç»“æ„å¦‚ä¸‹ï¼š<br><code>&lt;a href=&quot;##&quot; class=&quot;link&quot;&gt;&lt;i class=&quot;icon icon1&quot;&gt;&lt;/i&gt;è¿”å›&lt;/a&gt;</code><br>äºæ˜¯é¼ æ ‡hoverå°±æ˜¯<code>#333</code><br>å› ä¸º<code>currentColor</code>ç»§æ‰¿æ–‡æœ¬é¢œè‰²è¿™ä¸ªå±æ€§,<code>color</code>çš„æ”¹å˜ä¼šéšä¹‹æ”¹å˜<code>background-color</code></p><h2 id="meta"><a href="#meta" class="headerlink" title="meta"></a>meta</h2><hr><p><code> &lt;meta http-equiv=&quot;x-ua-comatible&quot; content=&quot;ie=edge&quot;&gt;</code></p><ol><li>å®ƒä»£è¡¨ieæ–‡æ¡£çš„å…¼å®¹æ€§ï¼Œå‘Šè¯‰æ–‡æ¡£åœ¨<strong>ie</strong>ä¸‹çš„å…¼å®¹æ¨¡å¼ï¼Œ</li><li>å®ƒæ˜¯ä¸ºäº†å…¼å®¹ä¸€äº›åœ¨ie8ä¸‹æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œä½†åœ¨è€ç‰ˆæœ¬æµè§ˆå™¨ä¸‹æ˜¾ç¤ºæ­£å¸¸çš„æ¨¡å¼</li><li>é€šè¿‡content  å¯ä»¥å‘Šè¯‰ ieæµè§ˆå™¨ ä½ å¯ä»¥æ¨¡æ‹Ÿ ie7çš„å½¢å¼æˆ–è€…ie8æˆ–è€…ie9ã€ie11çš„å½¢å¼æ˜¾ç¤ºç½‘é¡µ</li><li>æ¯”å¦‚<code>content=&quot;IE=EmulateIE8&quot;</code>ä»¥ie8çš„æ¨¡å¼æ¸²æŸ“é¡µé¢</li><li>ie&#x3D;edgeæ˜¯ä¸ºäº†å¼ºåˆ¶ieæµè§ˆå™¨ä»¥æœ€æ–°çš„æ¨¡å¼æ¸²æŸ“é¡µé¢ï¼Œèƒ½å¤šæ–°ï¼Œæœ‰å¤šæ–°ï¼Œ<strong>ï¼ˆä½†å¦‚æœæµè§ˆå™¨æœ€é«˜ie8ï¼Œé‚£ä¹Ÿåªèƒ½ç”¨ie8çš„æ¨¡å¼æ¸²æŸ“ï¼‰</strong>ã€‚</li></ol><h2 id="ç§»åŠ¨ç«¯metaå¿…å¤‡"><a href="#ç§»åŠ¨ç«¯metaå¿…å¤‡" class="headerlink" title="ç§»åŠ¨ç«¯metaå¿…å¤‡"></a>ç§»åŠ¨ç«¯metaå¿…å¤‡</h2><p><code>&lt;meta name=&quot;view-port&quot; content=&quot;width=device-width,initial-scale=1&quot;&gt;</code></p><h2 id="å¯¹äºieä½ç‰ˆæœ¬å…¼å®¹"><a href="#å¯¹äºieä½ç‰ˆæœ¬å…¼å®¹" class="headerlink" title="å¯¹äºieä½ç‰ˆæœ¬å…¼å®¹"></a>å¯¹äºieä½ç‰ˆæœ¬å…¼å®¹</h2><ul><li>cssé‡Œ \0  å¤§å®¶éƒ½æ‡‚</li><li>htmlé‡Œ<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">&lt;!--[<span class="hljs-keyword">if</span> lte IE8]&gt;<br>&lt;p&gt;å¦‚æœæµè§ˆå™¨å°äºç­‰äºie8ï¼Œé‚£ä¹ˆæˆ‘æç¤ºä½ è¯¥å‡çº§äº†&lt;/p&gt;<br>&lt;![endif]--&gt;<br></code></pre></td></tr></table></figure></li><li>æ ¼å¼ä¸å¤šè¯´  gt å¤§äºã€ltå°äºã€gteå¤§äºç­‰äºã€lteå°äºç­‰äº</li></ul><h2 id="px-em-rem"><a href="#px-em-rem" class="headerlink" title="px em rem"></a>px em rem</h2><ol><li>pxåƒç´ </li><li>em ç›¸å¯¹çˆ¶å…ƒç´  ï¼Œå¦‚æœæ²¡è®¾ä¼šä¸€ç›´å¾€ä¸Šæ‰¾ï¼Œå¾ˆå¼ºå¤§ä½†ä¼šå¯¼è‡´æ··ä¹±</li><li>rem ç›¸å¯¹htmlï¼Œä½†rem ie678ä¸æ”¯æŒ</li></ol><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">html &#123;<br>font-size: 62.5%;<br>color: <span class="hljs-comment">#222;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æ­¤ä¸€ä¸ªremä¼šæ˜¯10px </p><h2 id="å–æ¶ˆé€‰ä¸­"><a href="#å–æ¶ˆé€‰ä¸­" class="headerlink" title="å–æ¶ˆé€‰ä¸­"></a>å–æ¶ˆé€‰ä¸­</h2><p>css3å±æ€§  é¡ºåºä¸èƒ½ä¹±ï¼Œä¸ç„¶è°·æ­Œæ²¡æœ‰ï¼Œç«ç‹æœ‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sh">::-moz-selection&#123;<br>background-color: <span class="hljs-comment">#b3d4fc;</span><br>text-shadow: none;<br>&#125;<br>::selection&#123;<br>background-color: <span class="hljs-comment">#b3d4fc;</span><br>text-shadow: none;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="éšè—æ–‡å­—"><a href="#éšè—æ–‡å­—" class="headerlink" title="éšè—æ–‡å­—"></a>éšè—æ–‡å­—</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">.text-hide&#123;<br>font:0/0 a;<br>color: transparent;<br>text-shadow: none;<br>background-color: transparent;<br>border: 0;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ³¨æ„å…¶ä¸­çš„text-hide æ˜¯ä¸ºäº†éšè—æ–‡å­—ï¼Œæ–¹ä¾¿seoè¯†åˆ«å›¾ç‰‡</p><h2 id="æ¸…é™¤æµ®åŠ¨"><a href="#æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ¸…é™¤æµ®åŠ¨"></a>æ¸…é™¤æµ®åŠ¨</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">.clearfix:after,.clearfix:before&#123;<br>content:<span class="hljs-string">&#x27; &#x27;</span>;<br>display: table;<br>&#125;<br>.clearfix:after&#123;<br>clear:both;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•å¯ä»¥é˜²æ­¢marginçš„å åŠ </p><h2 id="before-åˆ©ç”¨"><a href="#before-åˆ©ç”¨" class="headerlink" title="before åˆ©ç”¨"></a>before åˆ©ç”¨</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh">.notice a:first-child:before&#123;<br>content: <span class="hljs-string">&#x27;æœ€æ–°å…¬å‘Šï¼š\00a0\00a0&#x27;</span>;<br>color: <span class="hljs-comment">#aaa;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶ä¸­<code>\00a0\00a0</code>æ˜¯ä¸æ¢è¡Œçš„ç©ºç™½å­—ç¬¦,å› ä¸ºcontentæ²¡æ³•ç”¨<code>&amp;nbsp</code>æ·»åŠ ç©ºæ ¼</p><h2 id="æ–‡å­—ä¸æ¢è¡Œ-å¤šå‡ºçœç•¥"><a href="#æ–‡å­—ä¸æ¢è¡Œ-å¤šå‡ºçœç•¥" class="headerlink" title="æ–‡å­—ä¸æ¢è¡Œ,å¤šå‡ºçœç•¥"></a>æ–‡å­—ä¸æ¢è¡Œ,å¤šå‡ºçœç•¥</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">.notice a:first-child&#123;<br>text-overflow: ellipsis;<br>overflow: hidden;<br>white-space: nowrap;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="è®¾å¤‡ä¿¡æ¯"><a href="#è®¾å¤‡ä¿¡æ¯" class="headerlink" title="è®¾å¤‡ä¿¡æ¯"></a>è®¾å¤‡ä¿¡æ¯</h2><p>ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²åœ¨æ§åˆ¶å°è¾“å…¥<code>navigator.userAgent</code>è·å¾—ç›¸å…³è®¾å¤‡ä¿¡æ¯</p><h2 id="æ–‡å­—è¶…å‡ºéšè—"><a href="#æ–‡å­—è¶…å‡ºéšè—" class="headerlink" title="æ–‡å­—è¶…å‡ºéšè—"></a>æ–‡å­—è¶…å‡ºéšè—</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">&#123;<br>overflow: hidden;<br>white-space: nowrap;<br>text-overflow: ellipsis;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å›¾æ ‡éšæ–‡å­—å˜è‰²è®¾è®¡"><a href="#å›¾æ ‡éšæ–‡å­—å˜è‰²è®¾è®¡" class="headerlink" title="å›¾æ ‡éšæ–‡å­—å˜è‰²è®¾è®¡"></a>å›¾æ ‡éšæ–‡å­—å˜è‰²è®¾è®¡</h2><p><strong>èƒŒæ™¯è‰²é•‚ç©ºæŠ€æœ¯</strong> åˆ©ç”¨<br><strong>currentColor</strong>è¡¨ç¤ºâ€œå½“å‰çš„æ ‡ç­¾æ‰€ç»§æ‰¿çš„æ–‡å­—é¢œè‰²â€ã€‚<br>è¿™ç§è®¾è®¡çš„ç›®çš„å°±æ˜¯é¼ æ ‡hoveræ—¶å€™ï¼Œå›¾æ ‡å¯ä»¥è·Ÿç€æ–‡å­—ä¸€èµ·å˜è‰²ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sh">.icon &#123;<br>display: inline-block;<br>width: 16px; height: 20px;<br>background-image: url(../201307/sprite_icons.png);<br>background-color: currentColor; /* è¯¥é¢œè‰²æ§åˆ¶å›¾æ ‡çš„é¢œè‰² */<br>&#125;<br></code></pre></td></tr></table></figure><p>äºæ˜¯ï¼Œæˆ‘ä»¬æƒ³è¦é¼ æ ‡hoveræ–‡å­—é“¾æ¥ï¼Œå…¶å›¾æ ‡é¢œè‰²è¦è·Ÿç€ä¸€èµ·å˜åŒ–ï¼Œåªè¦æ”¹å˜æ–‡å­—é¢œè‰²å°±å¯ä»¥äº†ï¼š</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sh">.<span class="hljs-built_in">link</span>:hover &#123; <br>color: <span class="hljs-comment">#333; </span><br>&#125;<br></code></pre></td></tr></table></figure><p>å› ä¸º<code>currentColor</code>ç»§æ‰¿æ–‡æœ¬é¢œè‰²è¿™ä¸ªå±æ€§,<code>color</code>çš„æ”¹å˜ä¼šéšä¹‹æ”¹å˜<code>background-color</code></p><h2 id="margin-topæº¢å‡ºé—®é¢˜ï¼š"><a href="#margin-topæº¢å‡ºé—®é¢˜ï¼š" class="headerlink" title="margin-topæº¢å‡ºé—®é¢˜ï¼š"></a>margin-topæº¢å‡ºé—®é¢˜ï¼š</h2><p>ç»™å…ƒç´ ç›’å­ä¸€ä¸ªå‚ç›´å¤–è¾¹è·margin-topï¼Œçˆ¶å…ƒç´ ç›’å­ä¹Ÿä¼šå¾€ä¸‹èµ°margin-topçš„å€¼ã€‚<br>æœ‰ä»¥ä¸‹å‡ ç‚¹è§£å†³æ–¹æ¡ˆ<br>1.ä¿®æ”¹çˆ¶å…ƒç´ é«˜åº¦ï¼Œå¢åŠ padding-top                     å¥½ç”¨ï¼Œä½†é—´è·å˜æˆmargin+padding<br>2.ä¸ºçˆ¶å…ƒç´ æ·»åŠ overflowï¼šhidden                            ç‰¹åˆ«å¥½ç”¨ï¼Œç›¸å½“äºå­å…ƒç´ å‘ä¸‹ç§»ï¼Œä½†èŒƒå›´å’Œå­å…ƒç´ å¤§å°è¦æ³¨æ„<br>3.ä¸ºçˆ¶å…ƒç´ æˆ–è€…å­å…ƒç´ ç”³æ˜æµ®åŠ¨ï¼ˆfloatï¼šleftï¼‰            å¯ä»¥ç”¨ï¼Œä½†ä¼šæ”¹å˜çˆ¶å­çš„å®šä½ï¼Œä¼šæµ®èµ·æ¥<br>4.ä¸ºçˆ¶å…ƒç´ æ·»åŠ border                                            å¥½ç”¨ï¼Œä½†ä¼šæ”¹å˜è¾¹æ¡†</p><h2 id="æ¯›ç»ç’ƒç‰¹æ•ˆ"><a href="#æ¯›ç»ç’ƒç‰¹æ•ˆ" class="headerlink" title="æ¯›ç»ç’ƒç‰¹æ•ˆ"></a>æ¯›ç»ç’ƒç‰¹æ•ˆ</h2><p>cssä»£ç </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs sh">.blur &#123;    <br>-webkit-filter: blur(20px); /* Chrome, Opera */<br>-moz-filter: blur(20px);<br>-ms-filter: blur(20px);    <br>filter: blur(20px);    <br>&#125;<br>/**--å›¾ç‰‡ä¸Šçš„div--**/<br>.top-bg&#123;<br>position: absolute;<br>top: 0;<br>left: 0;<br>width: 100%;<br>height: 100%;<br>z-index: -1;<br>overflow: hidden;<br>&#125;<br>.top-bg img&#123;<br>transform: scale(4.0);<br>&#125;<br></code></pre></td></tr></table></figure><p>htmlä»£ç </p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">&lt;div&gt;  &lt;!--çˆ¶å±‚--&gt;<br>&lt;div class=<span class="hljs-string">&quot;top-bg blur&quot;</span>&gt; &lt;!--èƒŒæ™¯å±‚--&gt;<br>![](./img/37403260_p0.png)  &lt;!-- å›¾ç‰‡å±‚--&gt;<br>&lt;/div&gt;<br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>css</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
